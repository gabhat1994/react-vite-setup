import{f as G,Y as I,aR as z,c as D,F as P,j as t,b7 as q,ev as V,R as v,v as Y,n as J,eq as Q,eu as X}from"./index-cd84bcc9.js";import{ar as Z,a9 as $,b2 as O,C as W,aa as ee,bo as R,bz as B}from"./vendor-51460554.js";import{D as te,R as ae,a as ne}from"./DocumentSignaturePreview-a0af4fc2.js";import{u as oe,S as ie}from"./useStatementOfWorkPreviewScreen-5a4349a4.js";import{S as H}from"./StickyFormHeader-043ef98d.js";import{a as re}from"./styles-548b0144.js";import{u as F}from"./statementOfWorkPermissions-68d8aac2.js";import{S as s}from"./statementOfWork-e03c986f.js";import{D as se}from"./DeleteDocumentConfirmationModal-44709272.js";import{R as ce,E as de,d as le,a as me,D as y,K as ue,e as T,f as Se}from"./Section-2a57cf43.js";import{u as fe}from"./statementOfWorkPdf-95417ec8.js";import{C as pe}from"./contract-47e31a61.js";import{u as De}from"./useScrollIntoElement-809d6327.js";import{S as E,R as ge,F as he}from"./index-38931f83.js";import{u as we}from"./navigation-419d637e.js";import"./payloadParser-f4cc4e4f.js";import"./getTimeStampForDisplaying-22d5ca9d.js";import"./Infobox-cf6af02b.js";import"./RouterLink-30e622d4.js";import"./styles-58edde60.js";import"./contactDetails-4902172b.js";import"./countries-4aa86a38.js";import"./statementOfWork-f09edc55.js";import"./TickCheckbox-c4d9d4b6.js";import"./index-35efb18f.js";import"./styles-5db1c009.js";import"./ChamberLeftSideBar-2a7f8e7f.js";import"./index-2d186805.js";import"./useResizeObserver-0deb9469.js";import"./sideNavItems-22800105.js";import"./styles-b4894a1f.js";import"./index-4963229a.js";import"./Modal-5a254f40.js";const Pe=({statementOfWork:e,onConfirmDelete:c,onConfirmDecline:d,onConfirmResend:l,onDuplicate:m,onGoBackToList:r})=>{const{t:o}=Z(),n=$(),{user:g}=G(),{logError:u}=I(),{modalType:S,openModal:f,closeModal:i}=z(),C=fe(),a=F(),{formState:{isValid:h,isDirty:w}}=re(),N=()=>{r()},_=()=>{f("delete")},U=async()=>{await m()},L=()=>{e!=null&&e._id&&n(O(v.STATEMENT_OF_WORK_EDIT,{id:e._id}),{replace:!0})},x=()=>{f("decline")},j=()=>{f("resend")},k=async()=>{try{await c(),i(),r()}catch(p){i(),u(p,"sow-delete-draft")}},A=async()=>{try{await d()}catch(p){u(p,"sow-decline")}finally{i()}},M=()=>{e!=null&&e._id&&C(e._id,s.formatPdfFileName(e))},K=async()=>{try{await l()}catch(p){u(p,"contract-resend")}finally{i()}},b=!(h&&w)||pe.isDraft(e==null?void 0:e.linkedContract);return D(P,{children:[t(H,{showBackButton:!q.isUnauthenticated(g),title:o("noumena.statement_of_work_preview.title"),buttons:a.isOwner(e)?D(P,{children:[a.canResend(e)&&t(ce,{onClick:j}),a.canEdit(e)&&t(de,{onClick:L}),a.canDuplicate(e)&&t(le,{onClick:U}),a.canDelete(e)&&t(me,{onClick:_,isDraft:s.isDraft(e)}),a.canDownloadPdf(e)&&!s.isDraft(e)&&t(y,{onClick:M}),a.canSaveDraft(e)&&t(ue,{onClick:N}),a.canSign(e)&&t(T,{softDisabled:b})]}):D(P,{children:[a.canDownloadPdf(e)&&!s.isDraft(e)&&t(y,{onClick:M}),a.canDecline(e)&&t(Se,{onClick:x}),a.canSign(e)&&t(T,{softDisabled:b})]}),"data-test":"StatementOfWorkPreviewHeader-StickyFormHeader"}),t(se,{isOpen:S==="delete",isDraft:s.isDraft(e),documentName:(e==null?void 0:e.title)??"",documentType:V.Sow,onCancel:i,onDelete:k,"data-test":"StatementOfWorkPreviewHeader-DeleteDocumentConfirmationModal"}),t(te,{isOpen:S==="decline",documentName:(e==null?void 0:e.title)??"",onCancel:i,onDelete:A,"data-test":"StatementOfWorkPreviewHeader-DeclineDocumentConfirmationModal"}),t(ae,{isOpen:S==="resend",onCancel:i,onConfirm:K,"data-test":"StatementOfWorkPreviewHeader-ResendDocumentConfirmationModal"})]})},Ce=({statementOfWork:e,title:c,onGoBack:d,onDownloadPdf:l})=>{const m=F();return t(P,{children:t(H,{onGoBack:d,title:c,buttons:e&&m.canDownloadPdf(e)&&t(y,{onClick:l}),"data-test":"StatementOfWorkSigningHeader-StickyFormHeader"})})},ve=W.form`
  display: flex;
  justify-content: stretch;
  align-items: stretch;
  flex-grow: 1;
`,ye={SignatureModalForm:ve};function nt(){const{id:e}=ee(),{goBackToOrigin:c}=we(),{addErrorToast:d}=Y(),{scrollIntoElement:l}=De(),m=F(),{summary:r,signature:o,statementOfWork:n,previewStep:g,changeStep:u,deleteStatementOfWork:S,declineStatementOfWork:f,duplicateStatementOfWork:i,resendStatementOfWork:C}=oe({id:e}),a=()=>{c({fallbackUrl:X.contractManager()})},h=()=>{u("Summary")},w=()=>{d("Please check all the agreements in the last section to continue."),l("agreements")};return!e||!n&&!r.isLoading||n&&!m.canSeeSummary(n)?t(R,{to:v.NOT_FOUND,replace:!0,"data-test":"Navigate"}):g==="Summary"?t(E,{"data-test":"SinglePageLayout",children:t("form",{onSubmit:r.form.handleSubmit(r.onSubmit,w),children:D(B,{...r.form,"data-test":"FormProvider",children:[t(Pe,{statementOfWork:n,onConfirmDelete:S,onConfirmDecline:f,onConfirmResend:C,onDuplicate:i,onGoBackToList:a,"data-test":"StatementOfWorkPreviewHeader"}),t(ge,{"data-test":"ResponsiveMain",children:r.isLoading?t(J,{"data-test":"Spinner"}):n?t(ie,{statementOfWork:n,"data-test":"StatementOfWorkPreview"}):null})]})})}):g==="ConfirmSignature"?t(E,{"data-test":"SinglePageLayout",children:D(he,{"data-test":"FullHeightMain",children:[t(Ce,{title:"Check your SOW before signing",onGoBack:h,statementOfWork:n,onDownloadPdf:()=>{!n||!o.pdfWithSignature||Q(o.pdfWithSignature,"application/json",s.formatPdfFileName(n))},"data-test":"StatementOfWorkSigningHeader"}),t(ye.SignatureModalForm,{onSubmit:o.form.handleSubmit(o.onSubmit,w),children:t(B,{...o.form,"data-test":"FormProvider",children:t(ne,{pdfData:o.pdfWithSignature,isLoading:o.isLoading,onGoBack:h,"data-test":"DocumentSignaturePreview"})})})]})}):t(R,{to:v.NOT_FOUND,replace:!0,"data-test":"Navigate"})}export{nt as default};
//# sourceMappingURL=StatementOfWorkPreview-4235e572.js.map
