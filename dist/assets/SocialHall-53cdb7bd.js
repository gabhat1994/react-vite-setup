var wo=Object.defineProperty;var yo=(t,a,n)=>a in t?wo(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n;var ke=(t,a,n)=>(yo(t,typeof a!="symbol"?a+"":a,n),n);import{kP as te,kQ as Ho,c as h,M as Le,t as Ze,j as e,h as Te,i as Oe,T as re,S as de,k as et,B as x,f as fe,a5 as xe,kR as Ia,kS as J,kT as X,aL as Io,kU as To,o as Ue,kV as De,kW as Po,kX as No,kY as Lo,kZ as Oo,I,k_ as la,F as ee,k$ as zo,am as Re,l0 as ia,l1 as Ta,l2 as Pa,l3 as Wo,l4 as xo,l5 as Uo,l6 as wt,l7 as yt,au as Ce,l8 as Ro,l9 as Ao,la as Ko,lb as $o,lc as Go,n as tt,ld as Vo,le as Fo,lf as Do,gu as Gt,lg as qo,lh as Jo,li as jo,lj as Xo,y as Na,lk as He,ll as La,lm as Oa,ln as za,c4 as Wa,lo as xa,lp as Be,lq as Ht,lr as It,ls as Ua,lt as Yo,u as ue,e as le,lu as Tt,v as Ra,lv as Qo,lw as Zo,Y as st,w as Ee,R as Se,lx as ve,h2 as D,ly as Vt,lz as Aa,lA as en,lB as tn,lC as lt,lD as Ka,lE as Pt,iX as an,lF as on,lG as nn,iY as sn,lH as ln,lI as rn,lJ as dn,lK as ra,lL as cn,lM as un,lN as pn,lO as hn,lP as mn,lQ as fn,lR as gn,lS as Sn,lT as Cn,lU as St,lV as _n,lW as Mn,lX as bn,lY as $e,b7 as ye,lZ as ut,l_ as pt,l$ as ht,m0 as Ge,m1 as mt,m2 as qe,m3 as kn,m4 as da,m5 as vn,m6 as Bn,m7 as En,m8 as wn,m9 as ca,aO as yn,ma as Hn,mb as In,mc as Ft,md as Tn,me as Pn,mf as Nn,mg as Ln,h3 as ua,mh as On,mi as zn,mj as Wn,mk as xn,x as ft,ml as Un,mm as Rn,mn as An,mo as Kn,mp as $n,mq as Gn,mr as Vn,aC as Ut,ms as Fn,mt as Dn,mu as pa,mv as qn,mw as Jn,mx as jn,my as Xn,mz as Yn,mA as Qn,h6 as Dt,mB as qt,mC as Ie,mD as Zn,mE as es,mF as ts,mG as as,mH as os,mI as ns,mJ as ss,mK as ls,mL as it,mM as Jt,ag as $a,mN as Ga,mO as rt,mP as is,mQ as rs,mR as ha,mS as Je,mT as je,mU as nt,mV as Ct,mW as _t,mX as Mt,mY as jt,mZ as ds,m_ as cs,m$ as Va,n0 as Fa,n1 as Da,n2 as qa,n3 as Ja,n4 as us,n5 as ps,n6 as hs,X as ms,n7 as fs,n8 as gs,n9 as Ss,na as Cs,nb as _s,nc as Ms,nd as bs,ne as Ve,nf as ks,ng as vs,nh as Bs,ni as Es,nj as ws,nk as ys,nl as Hs,nm as Is,nn as Ts,no as Ps,np as Ns,nq as Ls,nr as Os,ns as zs,nt as Ws,nu as xs,nv as Us,nw as Rs,nx as As,ny as ma,nz as Ks,nA as $s,nB as Gs,nC as Vs,nD as Fs,nE as Ds,nF as qs,nG as Js,nH as js,nI as Xs,nJ as fa,nK as Ys,nL as Qs,nM as Zs,nN as el,nO as tl,nP as al,nQ as ol,nR as nl,nS as sl,nT as ll,nU as Nt,nV as il,nW as rl,nX as dl,nY as cl,nZ as ul,n_ as pl,n$ as hl,o0 as ml,a1 as Xt,d7 as Yt,o1 as fl,o2 as gl,o3 as Sl,o4 as Cl,o5 as _l,o6 as Ml,o7 as bl,o8 as kl,o9 as ga,oa as vl,ob as Bl,oc as El,od as be,oe as ja,of as Xa,og as Rt,oh as At,oi as Kt,oj as wl,ok as yl,ol as Ya,om as bt,on as Hl,oo as Il,op as Tl,oq as Pl,or as Nl,os as Ll,ot as Ol,ou as zl,ov as Wl,ow as xl,ox as Ul,oy as Rl,oz as Al,oA as Kl,oB as $l,oC as Gl,oD as Vl,oE as Fl,oF as Dl,oG as ql,oH as Sa,oI as Ca,oJ as _a,oK as Jl,oL as jl,oM as Xl,oN as Yl,oO as Ql,oP as Zl,d as ei,oQ as ti,oR as ai,oS as Ma,oT as ba,oU as oi,oV as ni,oW as si,oX as li,oY as ka,oZ as ii,aa as ri,ab as di,o_ as ci,o$ as ui,p0 as pi,p1 as hi,p2 as mi,p3 as fi,p4 as gi,p5 as Si,p6 as Ci,p7 as _i,p8 as Mi,p9 as bi,pa as ki,pb as vi,pc as Bi,pd as Ei,pe as Lt,pf as wi,pg as yi,ph as Hi,pi as Ot,pj as va,pk as Ii,hP as Ba,s as $t,b2 as Xe,d9 as Ea,m as Ti,pl as Pi,pm as Ni,pn as Li,po as Oi,pp as zi,pq as Wi,pr as xi}from"./index-cd84bcc9.js";import{be as Ui,r as o,B as O,bd as Ri,ar as pe,a9 as Pe,N as Ai,ay as Qa,l as Qt,ac as Ki,cH as $i,cI as Gi,aa as Vi,f as Fi,C as _e,at as Zt,au as ea}from"./vendor-51460554.js";import{u as Di}from"./useElementDimensions-84b2a778.js";import{R as Za}from"./Radiobox-c1e62033.js";import{A as wa}from"./index-4963229a.js";import{M as qi}from"./MessageInput-4cf1b973.js";import{u as Ji}from"./useBlocker-0dcaf13c.js";import"./useResizeObserver-0deb9469.js";import"./Modal-5a254f40.js";const ji=()=>{const t=Ui(),{eventDetails:a}=te();return[l=>{const s={query:Ho,variables:{id:a==null?void 0:a._id}},{getEventById:i}=t.readQuery(s);t.writeQuery({...s,data:{getEventById:{...i,...l}}})}]},Xi=()=>{const[t]=ji();return{updateEventStatus:o.useCallback(n=>{t({status:n,eventStatusUpdatedAt:new Date})},[t])}},ce=({isOpen:t,onClose:a,onConfirm:n,title:l,description:s,confirmButton:i,cancelButton:r,countDown:c,remainTime:d,isConfirmButtonPrimary:m,onCloseModal:p})=>{const[_,S]=o.useState(3);return o.useEffect(()=>{c&&(S(Math.floor(d/1e3)),Math.ceil(d/1e3)===1&&a())},[a,c,d]),h(Le,{open:t,size:Ze.S,onClose:p,testId:"default-event-modal",disableBackdropClick:!0,"data-test":"EventModal-Modal",children:[e(Te,{"data-test":"EventModal-ModalHeader",children:l}),c&&e(Te,{"data-test":"EventModal-ModalHeader",children:` ${_}...`}),e(Oe,{style:{alignItems:"center"},"data-test":"EventModal-ModalBody",children:e(re,{font:"body-l",textAlign:"center",colorToken:"--text-modal-neutral-default","data-testid":"event-confirmation-modal-description","data-test":"EventModal-TSpan",children:s})}),e(de,{height:16,"data-test":"EventModal-Spacer"}),h(et,{isFullScreen:!1,gap:16,flexDirection:"column",marginTop:12,"data-test":"EventModal-ModalFooter",children:[i&&e(x,{primary:m,intent:m?void 0:"negative",size:"full",onClick:n,"data-testid":"confirm-button","data-test":"EventModal-Button",children:i}),r&&e(x,{tertiary:!0,intent:"negative",size:"full",onClick:a,"data-testid":"cancel-button","data-test":"EventModal-Button",children:r})]})]})},zt=({_id:t,isMuted:a,isInvited:n,profile:l,chamber:s,firstName:i,middleName:r,lastName:c,isAudience:d,userStatus:m})=>{const{user:p}=fe(),[_,S]=xe(),{onBlockUser:v,onViewAttendeeProfile:u,onInviteAttendeeToStage:M,onCancelInvitationToStage:f,onRemoveSpeakerFromStage:g,onMuteSpeakerOnStage:H}=Ia(),{userActiveGroupData:k}=J(),{rtcEngine:B,raisedHandUsers:b,networkErrorUsers:w,agoraChannelUsers:E}=X(),{eventDetails:y,eventOwner:z,isEventHost:L,isMainEvent:K}=te(),[$,P]=o.useState(!1),U=o.useMemo(()=>w.includes(t),[w,t]),T=o.useMemo(()=>m===Io.Unregistered?To:(l==null?void 0:l.profilePicture)||"",[m,l==null?void 0:l.profilePicture]),N=o.useMemo(()=>(E==null?void 0:E.includes(t))||d,[E,t,d]),G=o.useMemo(()=>Ue(i,r,c),[i,c,r]);o.useEffect(()=>{B==null||B.on(De.VOLUME_INDICATOR,R=>{R.forEach(ae=>{const Z=ae.level>5&&ae.uid===t;P(Z)})})},[B]);const C=o.useMemo(()=>{var R;return(R=k==null?void 0:k.data)==null?void 0:R.userActiveSocialHallGroup},[k==null?void 0:k.data]),F=o.useCallback(R=>a?R.map(Z=>Z.key==="mute_user"?{key:"unmute_user",label:"unmute_user",value:"unmute_user",iconName:"mic_on_m",labelColor:"--text-tablecell-header-neutral-highlighted",type:"value"}:Z):R,[a]),Y=o.useMemo(()=>{var Z,oe;let R;return y!=null&&y.isInstantEvent?R=F(Po):(z==null?void 0:z._id)===t?R=F(No):(Z=C==null?void 0:C.hosts)!=null&&Z.includes(t)?R=F(Lo):(oe=C==null?void 0:C.speakers)!=null&&oe.includes(t)?R=F(Oo):n?R=Wo:R=xo,R.map(Q=>({...Q,label:O(`noumena.social_hall.${Q.label}`,{firstName:i}),description:Q.label==="cancel_invite_to_stage"?O("noumena.social_hall.cancel_invite_description",{firstName:i}):"",icon:e(I,{name:Q.iconName,color:Q.labelColor,size:24,"data-test":"AttendeeInCall-selectableOptions-updatedOptions-Icon"})}))},[z==null?void 0:z._id,t,y==null?void 0:y.isInstantEvent,C==null?void 0:C.hosts,C==null?void 0:C.speakers,n,F,i]),W=o.useCallback(R=>{R.value==="remove_from_event"&&S(),R.value==="see_home_noum"&&u((s==null?void 0:s._id)??""),R.value==="invite_to_stage"&&M(t),R.value==="move_to_audience"&&g(t),R.value==="cancel_invite_to_stage"&&f(t),R.value==="mute_user"&&H(C==null?void 0:C._id,t,la.Mute),R.value==="unmute_user"&&H(C==null?void 0:C._id,t,la.Unmute)},[S,u,s==null?void 0:s._id,M,t,g,f,H,C==null?void 0:C._id]),V=o.useCallback(()=>{v(t,y==null?void 0:y._id,G??"",!0),S()},[t,y==null?void 0:y._id,G,v,S]),A=()=>{var R;return h(ee,{children:[h(Uo,{"data-test":"AttendeeInCall-AttendeeContent-AvatarWrapper",children:[b.includes(t)&&h(ee,{children:[e(wt,{"data-testid":"raise_hand","data-test":"AttendeeInCall-AttendeeContent-CenterIconContainer",children:e(I,{imageIconName:"raise_hand_m",size:24,"data-test":"AttendeeInCall-AttendeeContent-Icon"})}),e(yt,{"data-test":"AttendeeInCall-AttendeeContent-AvatarMask"})]}),e(Ce,{url:T,size:"XL",disabled:U,"data-test":"AttendeeInCall-AttendeeContent-Avatar"}),U&&h(ee,{children:[e(wt,{"data-testid":"low_connection","data-test":"AttendeeInCall-AttendeeContent-CenterIconContainer",children:e(I,{name:"low_connection_xs",color:"--icon-call-ui-neutral-default",size:24,"data-test":"AttendeeInCall-AttendeeContent-Icon"})}),e(yt,{isOffline:!0,"data-test":"AttendeeInCall-AttendeeContent-AvatarMask"})]}),n&&e(ee,{children:e(Ro,{font:"footnote-bold",colorToken:"--text-call-ui-brand-primary-default","data-testid":"invited_user","data-test":"AttendeeInCall-AttendeeContent-InvitedContainer",children:O("noumena.social_hall.invite_status.invited")})}),a&&e(Ao,{"data-testid":"muted_user","data-test":"AttendeeInCall-AttendeeContent-Microphone",children:e(I,{name:"mic_off_m",color:"--icon-call-ui-neutral-default",size:16,"data-test":"AttendeeInCall-AttendeeContent-Icon"})}),$&&!a&&!U&&!d&&h(ee,{children:[e(Ko,{"data-testid":"active_speaker","data-test":"AttendeeInCall-AttendeeContent-EqualizerContainer",children:e(Ri,{animationData:$o,loop:!0,style:{height:"16px"},"data-test":"AttendeeInCall-AttendeeContent-Lottie"})}),e(Go,{"data-test":"AttendeeInCall-AttendeeContent-BorderContainer"})]}),!N&&h(ee,{children:[e(wt,{"data-testid":"inactive_speaker","data-test":"AttendeeInCall-AttendeeContent-CenterIconContainer",children:e(tt,{"data-test":"AttendeeInCall-AttendeeContent-Spinner"})}),e(yt,{"data-test":"AttendeeInCall-AttendeeContent-AvatarMask"})]})]}),h(Vo,{colorToken:"--text-call-ui-neutral-default","data-test":"AttendeeInCall-AttendeeContent-NameSpan",children:[((R=C==null?void 0:C.hosts)==null?void 0:R.includes(t))&&e(I,{name:"star_s",color:"--icon-call-ui-neutral-default",size:12,"data-test":"AttendeeInCall-AttendeeContent-Icon"}),i]})]})};return h(ee,{children:[e(zo,{"data-testid":"dropdown_wrapper","data-test":"AttendeeInCall-OptionMenuWrapper",children:t!==(p==null?void 0:p._id)&&L&&K?e(Re,{hideIcons:!1,closeOnSelect:!0,placement:"auto",onSelectOption:W,options:Y,containerWidth:"280px",usePortal:!1,calRefTop:!1,isAnimation:!1,usePopStyle:!0,minHeight:`${50*Y.length}px`,containerStyle:{inset:"-60px auto auto 60px",minWidth:"max-content"},"data-test":"AttendeeInCall-Dropdown",children:({targetRef:R,targetProps:ae,toggle:Z})=>e(ia,{"data-testid":"avatar_wrapper",ref:R,onClick:Z,...ae,"data-test":"AttendeeInCall-AttendeeWrapper",children:e(A,{"data-test":"AttendeeInCall-AttendeeContent"})})}):e(ia,{"data-testid":"avatar_wrapper","data-test":"AttendeeInCall-AttendeeWrapper",children:e(A,{"data-test":"AttendeeInCall-AttendeeContent"})})}),e(Ta,{isOpen:_,onClose:S,onConfirm:V,...Pa(G),"data-test":"AttendeeInCall-EventCancelAttendeeModal"})]})},eo=t=>{const{urls:a,onClickShowAll:n}=t,{t:l}=pe();return h(Fo,{children:[h(Do,{children:[e(Gt,{urls:a.length?a.slice(0,3):[],size:"XL","data-test":"BottomBar-InlineAvatar"}),!!a&&e(qo,{colorToken:"--text-card-neutral-default",children:l("noumena.social_hall.total_users",{userCount:a.length})})]}),e(x,{secondary:!0,size:"small",onClick:n,"data-test":"BottomBar-Button",children:l("noumena.social_hall.show_all")})]})},to=()=>{const{setShowBrowserSupportBanner:t,showBrowserSupportBanner:a}=J();return h(Jo,{isVisible:!!a,"data-test":"BrowserSupport-Container",children:[h(jo,{"data-test":"BrowserSupport-Content",children:[e(Xo,{"data-test":"BrowserSupport-IconContainer",children:e(I,{name:"alert_xs",size:10,color:"--icon-button-neutral-alt-default","data-test":"BrowserSupport-Icon"})}),e(de,{width:8,"data-test":"BrowserSupport-Spacer"}),e(re,{font:"body-m",colorToken:"--text-infobox-neutral-default","data-test":"BrowserSupport-TSpan",children:O("noumena.social_hall.browser_not_support")})]}),e(I,{name:"close_m",size:16,onClick:()=>t(!1),color:"--icon-infobox-brand-primary-default","data-test":"BrowserSupport-Icon"})]})},ta=({isOpen:t,onClose:a})=>{const[n,l]=o.useState(""),{groupName:s}=te(),{groupId:i}=J(),{handleChangeGroupName:r,isChangingGroupName:c}=ad(),d=o.useCallback(()=>{l(""),a()},[a]),m=o.useCallback(async()=>{await r(i,n)&&d()},[i,n,r,d]),p=o.useCallback(_=>{_.target.value.replace(/\s/g,"")?l(_.target.value):l("")},[]);return o.useEffect(()=>{t&&s&&l(s)},[t,s]),h(Le,{"data-testid":"change-group-name-modal",open:t,onClose:d,size:Ze.M,enableCloseButton:!0,disableBackdropClick:!0,"data-test":"ChangeGroupNameModal-Modal",children:[e(Te,{"data-test":"ChangeGroupNameModal-ModalHeader",children:O("noumena.social_hall.change_group_name.title")}),h(Oe,{overflowY:"initial","data-test":"ChangeGroupNameModal-ModalBody",children:[e(re,{font:"body-l",textAlign:"center",colorToken:"--text-body-neutral-default","data-test":"ChangeGroupNameModal-TSpan",children:O("noumena.social_hall.change_group_name.description")}),e(de,{height:16,"data-test":"ChangeGroupNameModal-Spacer"}),e(Na,{label:O("noumena.social_hall.change_group_name.label"),value:n,onChange:p,maxLength:50,fullWidth:!0,hideLengthHelperText:!0,"data-test":"ChangeGroupNameModal-TextField"})]}),h(et,{gap:16,"data-test":"ChangeGroupNameModal-ModalFooter",children:[e(x,{tertiary:!0,intent:"negative",size:"full",onClick:d,"data-testid":"cancel-button","data-test":"ChangeGroupNameModal-Button",children:O("noumena.social_hall.change_group_name.cancel_btn")}),e(x,{primary:!0,size:"full",onClick:m,"data-testid":"confirm-button",disabled:!n,loading:c,"data-test":"ChangeGroupNameModal-Button",children:O("noumena.social_hall.change_group_name.confirm_btn")})]})]})},Yi=({onToggleChat:t,isNewMessage:a,showChatPanel:n})=>h(He,{cursorAllowed:!0,onClick:t,"data-title":O("noumena.social_hall.Control_panel.Chat"),"data-test":"ChatControl-ControlPanelIcon",children:[!n&&a&&e(La,{"data-test":"ChatControl-BadgeContainer",children:e(Oa,{"data-test":"ChatControl-BadgeNotification"})}),e(I,{size:24,name:"message_outline_m",color:"--icon-button-neutral-default","data-test":"ChatControl-Icon"})]}),Qi=({label:t,onCheck:a,selected:n,...l})=>{const s=()=>{a(n?null:l)};return h(za,{"data-test":"MediaVirtualBackgroundOption-SelectBoxContainer",children:[e(Wa,{isChecked:n,icon:n?e(I,{name:"tick_m",size:24,color:"--icon-checkbox-neutral-alt-default","data-test":"MediaVirtualBackgroundOption-Icon"}):void 0,onChange:()=>s(),"data-test":"MediaVirtualBackgroundOption-Checkbox"}),e(xa,{font:"body-l","data-test":"MediaVirtualBackgroundOption-SelectBoxText",children:Be.formatDeviceLabel(t)})]})},ya=({device:{deviceId:t,label:a},onCheck:n,selected:l})=>h(za,{"data-test":"MediaSettingOption-SelectBoxContainer",children:[e(Za,{isChecked:l,icon:l?e(I,{name:"radio_btn_m",size:12,color:"--icon-radiobutton-brand-primary-default","data-test":"MediaSettingOption-Icon"}):void 0,onChange:()=>n(t),"data-test":"MediaSettingOption-Radiobox"}),e(xa,{font:"body-l","data-test":"MediaSettingOption-SelectBoxText",children:Be.formatDeviceLabel(a)})]}),ao=({isOpen:t,handleClose:a})=>{const{t:n}=pe(),{deviceId:l,setVirtualBackground:s,virtualBackground:i,videoPermissionState:r,audioPermissionState:c}=J(),{onChangeDevice:d}=X(),[m,p]=o.useState(""),[_,S]=o.useState(i),[v,u]=o.useState(""),[M,f]=o.useState([]),[g,H]=o.useState([]),k=o.useCallback(()=>{s(_),d({camera:m??"",microphone:v??"",speaker:(l==null?void 0:l.speaker)??""}),a()},[a,m,d,l==null?void 0:l.speaker,v,s,_]),B=o.useCallback(async()=>{const w=await Be.getAllConnectedMedia();w!=null&&w.audioDevices&&f(w.audioDevices),w!=null&&w.cameraDevices&&H(w.cameraDevices)},[]),b=o.useMemo(()=>Be.getAllVirtualBackground(),[]);return o.useEffect(()=>{t&&(r||c)&&B()},[t,B,r,c]),o.useEffect(()=>{(l==null?void 0:l.camera)!==m&&p((l==null?void 0:l.camera)??""),(l==null?void 0:l.microphone)!==v&&u((l==null?void 0:l.microphone)??"")},[l]),So(B),h(Le,{testId:"media-setting-modal",open:t,onClose:a,enableCloseButton:!0,size:Ze.M,disableBackdropClick:!0,"data-test":"MediaSettingModal-Modal",children:[e(Te,{"data-test":"MediaSettingModal-ModalHeader",children:n("noumena.settings")}),h(Oe,{"data-test":"MediaSettingModal-ModalBody",children:[h(Ht,{"data-test":"MediaSettingModal-MiniContainer",children:[e(It,{"data-test":"MediaSettingModal-ModalSubHeading",children:e(re,{font:"body-m-bold","data-test":"MediaSettingModal-TSpan",children:n("noumena.social_hall.media_settings.select(microphone)")})}),M.map(w=>e(ya,{device:w,onCheck:u,selected:w.deviceId===v,"data-test":"MediaSettingModal-MediaSettingOption"},w.deviceId))]}),e(de,{height:18,"data-test":"MediaSettingModal-Spacer"}),h(Ht,{"data-test":"MediaSettingModal-MiniContainer",children:[e(It,{"data-test":"MediaSettingModal-ModalSubHeading",children:e(re,{font:"body-m-bold","data-test":"MediaSettingModal-TSpan",children:n("noumena.social_hall.media_settings.select(camera)")})}),g.map(w=>e(ya,{device:w,onCheck:p,selected:w.deviceId===m,"data-test":"MediaSettingModal-MediaSettingOption"},w.deviceId))]}),e(de,{height:18,"data-test":"MediaSettingModal-Spacer"}),h(Ht,{"data-test":"MediaSettingModal-MiniContainer",children:[e(It,{"data-test":"MediaSettingModal-ModalSubHeading",children:e(re,{font:"body-m-bold","data-test":"MediaSettingModal-TSpan",children:n("noumena.social_hall.media_settings.select(camera_background)")})}),b.map(w=>e(Qi,{onCheck:E=>S(E),selected:(_==null?void 0:_.id)===w.id,...w,"data-test":"MediaSettingModal-MediaVirtualBackgroundOption"},w.id))]})]}),e(et,{"data-test":"MediaSettingModal-ModalFooter",children:e(x,{"data-testid":"cancel_button",tertiary:!0,size:"full",onClick:k,"data-test":"MediaSettingModal-Button",children:n("noumena.socialhall.media_control_btn_ok")})})]})},Zi=()=>{const[t,a]=o.useState(!1),n=o.useCallback(()=>{a(l=>!l)},[]);return h(ee,{children:[e(He,{cursorAllowed:!0,onClick:n,"data-title":O("noumena.social_hall.Control_panel.settings"),"data-test":"MediaSettingControl-ControlPanelIcon",children:e(I,{size:24,name:"settings_m",color:"--icon-button-neutral-default","data-test":"MediaSettingControl-Icon"})}),e(ao,{isOpen:t,onAccept:n,handleClose:n,"data-test":"MediaSettingControl-MediaSettingModal"})]})},er=({onToggleMemberPanel:t,showMembersPanel:a})=>{const{isEventHost:n,eventDetails:l}=te(),{raisedHandUsers:s}=X(),[i,r]=o.useState(!1),[c,d]=o.useState(!1),m=()=>{t(),a&&d(!1)};return o.useEffect(()=>{const p=!!s.length&&n;r((p||!n)&&!(l!=null&&l.isInstantEvent)&&!a&&c)},[c,s,n,l==null?void 0:l.isInstantEvent,a]),h(He,{cursorAllowed:!0,onClick:m,"data-title":O("noumena.social_hall.Control_panel.Members"),"data-test":"MemberControl-ControlPanelIcon",children:[i&&e(La,{"data-test":"MemberControl-BadgeContainer",children:e(Oa,{"data-test":"MemberControl-BadgeNotification"})}),e(I,{size:24,name:"groups_m",color:"--icon-button-neutral-default","data-test":"MemberControl-Icon"})]})},oo=({onToggle:t,isCameraEnable:a,isError:n=!1,isLoading:l=!1})=>{const s=o.useMemo(()=>n?{bgColor:"var(--bg-button-neutral-disabled)",iconColor:"--icon-button-neutral-disabled",hoverColor:"var(--bg-button-neutral-disabled)"}:!a&&!l?{bgColor:"var(--bg-button-danger-secondary-default)",iconColor:"--icon-button-danger-secondary-default",hoverColor:"var(--bg-button-danger-secondary-hover)"}:{bgColor:void 0,iconColor:"--icon-button-neutral-default",hoverColor:void 0},[n,a,l]),i=o.useMemo(()=>n?O("noumena.social_hall.media_permission_more_info"):a?O("noumena.social_hall.Control_panel.Camera_on"):O("noumena.social_hall.Control_panel.Camera_off"),[a,n]),r=()=>{l||t()};return h(He,{cursorAllowed:!0,onClick:()=>r(),"data-title":i,bgColor:s.bgColor,hoverColor:s.hoverColor,"data-test":"VideoControl-ControlPanelIcon",children:[n&&e(Ua,{"data-test":"VideoControl-ErrorWrapper",children:e(I,{size:11,name:"alert_xs",color:"--icon-badge-neutral-alt-default","data-test":"VideoControl-Icon"})}),l&&e(tt,{"data-test":"VideoControl-Spinner"}),!n&&!l&&e(I,{size:24,name:a?"webcam_on_m":"webcam_off_m",color:s.iconColor,"data-test":"VideoControl-Icon"}),n&&e(I,{size:24,name:"webcam_off_m",color:s.iconColor,"data-test":"VideoControl-Icon"})]})},no=({isMuted:t,onToggle:a,isError:n,isLoading:l=!1})=>{const s=o.useMemo(()=>n?{bgColor:"var(--bg-button-neutral-disabled)",iconColor:"--icon-button-neutral-disabled",hoverColor:"var(--bg-button-neutral-disabled)"}:t?{bgColor:"var(--bg-button-danger-secondary-default)",iconColor:"--icon-button-danger-secondary-default",hoverColor:"var(--bg-button-danger-secondary-hover)"}:{bgColor:void 0,iconColor:"--icon-button-neutral-default",hoverColor:void 0},[n,t]),i=o.useMemo(()=>n?O("noumena.social_hall.media_permission_more_info"):t?O("noumena.social_hall.Control_panel.Mic_off"):O("noumena.social_hall.Control_panel.Mic_on"),[t,n]);return h(He,{cursorAllowed:!0,onClick:()=>a(),"data-title":i,bgColor:s.bgColor,hoverColor:s.hoverColor,"data-test":"MuteControl-ControlPanelIcon",children:[n&&e(Ua,{"data-test":"MuteControl-ErrorWrapper",children:e(I,{size:11,name:"alert_xs",color:"--icon-badge-neutral-alt-default","data-test":"MuteControl-Icon"})}),l&&e(tt,{"data-test":"MuteControl-Spinner"}),!n&&!l&&e(I,{size:24,name:t?"mic_off_m":"mic_on_m",color:s.iconColor,"data-test":"MuteControl-Icon"}),n&&e(I,{size:24,name:"mic_off_m",color:s.iconColor,"data-test":"MuteControl-Icon"})]})},so=({isOpen:t,onClose:a,onConfirm:n})=>h(Le,{open:t,testId:"hands-up-modal",size:Ze.S,disableBackdropClick:!0,"data-test":"HandsUpModal-Modal",children:[e(Yo,{"data-test":"HandsUpModal-HandIconWrapper",children:e(I,{imageIconName:"raise_hand_m",size:48,"data-test":"HandsUpModal-Icon"})}),e(Te,{flexDirection:"column","data-test":"HandsUpModal-ModalHeader",children:O("noumena.social_hall.hands_up.modal.title")}),e(Oe,{"data-test":"HandsUpModal-ModalBody",children:e(re,{font:"body-l",textAlign:"center",colorToken:"--text-modal-neutral-default","data-testid":"event-confirmation-modal-description","data-test":"HandsUpModal-TSpan",children:O("noumena.social_hall.hands_up.modal.description")})}),e(de,{height:16,"data-test":"HandsUpModal-Spacer"}),h(et,{gap:16,flexDirection:"column",marginTop:12,"data-test":"HandsUpModal-ModalFooter",children:[e(x,{primary:!0,size:"full",onClick:n,"data-testid":"confirm-button","data-test":"HandsUpModal-Button",children:O("noumena.social_hall.hands_up.modal.btn_confirm")}),e(x,{tertiary:!0,intent:"negative",size:"full",onClick:a,"data-testid":"cancel-button","data-test":"HandsUpModal-Button",children:O("noumena.social_hall.hands_up.modal.btn_cancel")})]})]}),tr=()=>{const{width:t}=ue(),[a,n]=xe(!1),l=o.useMemo(()=>t<le.MOBILE_MAX,[t]),{showRaiseHand:s,onToggleRaiseHand:i}=X();return h(ee,{children:[e(He,{cursorAllowed:!0,onClick:i,bgColor:s?l?"var(--bg-button-brand-secondary-default)":"var(--bg-button-brand-primary-default)":void 0,"data-title":s?O("noumena.social_hall.Control_panel.hand_rasied"):O("noumena.social_hall.Control_panel.raise_hand"),hoverColor:s?"var(--bg-button-brand-primary-hover)":void 0,"data-test":"RaiseHandControl-ControlPanelIcon",children:e(I,{size:24,imageIconName:"raise_hand_m","data-test":"RaiseHandControl-Icon"})}),e(so,{isOpen:a,onClose:n,onConfirm:i,"data-test":"RaiseHandControl-HandsUpModal"})]})},ar=()=>{const{isShareScreen:t,onToggleScreenSharing:a,isRemoteScreenSharing:n,screenSharingLocalUserFeed:l}=X(),s=o.useMemo(()=>!l&&t,[l,t]),i=o.useMemo(()=>!t&&n,[t,n]),r=o.useCallback(()=>{i||a()},[a,i]);return e(He,{cursorAllowed:!i,onClick:r,"data-title":i?O("noumena.social_hall.Control_panel.sharing_not_possible"):t?O("noumena.social_hall.Control_panel.stop_sharing"):O("noumena.social_hall.Control_panel.share_screen"),hoverColor:i?"var(--bg-button-neutral-disabled)":void 0,"data-test":"ScreenSharingControl-ControlPanelIcon",children:s?e(tt,{"data-test":"ScreenSharingControl-Spinner"}):e(I,{size:24,name:t?"share_content_off_m":"share_content_m",color:"--icon-button-neutral-default","data-test":"ScreenSharingControl-Icon"})})},lo=({showAudioModal:t,showVideoModal:a,onTogglePopup:n})=>{const[l,s]=o.useState(!1),i=o.useMemo(()=>t!==null&&t,[t]),r=o.useMemo(()=>a!==null&&a,[a]);o.useEffect(()=>{s(i||r)},[i,r]);const{heading:c,body:d}=o.useMemo(()=>i&&r?Tt.cameraMicNotFound:i?Tt.micNotFound:r?Tt.cameraNotFound:{heading:"",body:""},[i,r]),m=()=>{s(!1),t&&n("audio"),a&&n("video")};return h(Le,{isFullScreen:!1,testId:"testElementDelete",open:l,onClose:m,size:Ze.S,disableBackdropClick:!0,"data-test":"MediaPermissionNotification-Modal",children:[e(Te,{"data-test":"MediaPermissionNotification-ModalHeader",children:c}),e(Oe,{align:"center","data-test":"MediaPermissionNotification-ModalBody",children:e(re,{"data-testid":"bodyElementDelete",font:"body-l",colorToken:"--text-modal-neutral-default",textAlign:"center","data-test":"MediaPermissionNotification-TSpan",children:d})}),e(et,{flexDirection:"column",marginTop:12,gap:16,"data-test":"MediaPermissionNotification-ModalFooter",children:e(x,{"data-testid":"cancelElementDelete",tertiary:!0,size:"full",onClick:()=>m(),"data-test":"MediaPermissionNotification-Button",children:O("noumena.social_hall.hardware_testing_modal_close")})})]})},or=()=>{const{addToast:t}=Ra(),a=()=>{const n=window.location.href;navigator.clipboard.writeText(n),t("primary","none",`${O("noumena.event.link.copied")}`)};return e(He,{cursorAllowed:!0,onClick:()=>a(),"data-title":O("noumena.social_hall.copy_link"),"data-test":"CopyLinkControl-ControlPanelIcon",children:e(I,{name:"link_m",size:20,color:"--icon-button-neutral-default","data-test":"CopyLinkControl-Icon"})})},nr=({onToggleChat:t,onToggleMember:a,isNewMessage:n,showChatPanel:l,isReconnecting:s,showMembersPanel:i})=>{const[r]=Qo(),[c]=Zo(),{onTogglePopup:d,showPermissionPopup:m}=Co(),p=Pe(),{logError:_}=st(),{flags:S}=Ee(),{isUnregistered:v}=fe(),{width:u}=ue(),[,M]=o.useState(!1),{isMuted:f,onLeaveCall:g,toggleCamera:H,toggleMuteCall:k,isCameraEnable:B,localVideoTrack:b,onSendSubscriptionMessage:w}=X(),{isMainEvent:E,onUpdateEventStatus:y,isEventHost:z,isEventSpeaker:L,isPreEvent:K,isPostEvent:$,eventDetails:P}=te(),U=o.useMemo(()=>u<le.MOBILE_MAX,[u]),{socialHallAttendeesAndGroups:T,activeSocialHallGroup:N,setShowBuzzRoom:G}=J(),[C,F]=o.useState(!1),[Y,W]=o.useState(!1),V=o.useCallback(()=>{try{if(!(P!=null&&P._id))return;z?(G(!1),g()):W(!0)}catch(se){_(se,"",!1)}},[z,_,g,G,P==null?void 0:P._id]),A=o.useCallback(async se=>{try{M(!0),await y(se)}catch(q){_(q,"")}finally{M(!1)}},[_,y]),R=o.useCallback(async()=>{await g(),W(!1),p(v?Se.GUEST_HOME:Se.HOME_NOUM)},[p,v,g]),ae=o.useCallback(async()=>{F(!1),w({type:ve.UPDATE_EVENT_STATUS,data:D.Cancelled});const se=P!=null&&P.recurring?D.Expired:D.Cancelled;await A(se),await g()},[A,w,P==null?void 0:P.recurring,g]),Z=o.useMemo(()=>$||K,[$,K]),oe=o.useMemo(()=>E&&(z||L),[E,z,L]),Q=o.useMemo(()=>E&&!z&&!L,[E,z,L]),Me=o.useMemo(()=>oe||Z,[oe,Z]),j=o.useMemo(()=>S.socialHallMessaging,[S]),he=o.useMemo(()=>Q||Z,[Q,Z]),ne=o.useMemo(()=>!E&&!z&&!U,[E,z,U]),ie=o.useMemo(()=>(E||(P==null?void 0:P.isInstantEvent))&&z&&(P==null?void 0:P.isInstantEvent)&&!U,[E,z,P==null?void 0:P.isInstantEvent,U]),ge=o.useMemo(()=>E||(P==null?void 0:P.isInstantEvent),[E,P==null?void 0:P.isInstantEvent]),we=Et(T,N),ze=o.useMemo(()=>E?O("noumena.socialhall.end_the_main_event"):O("noumena.socialhall.end_the_event"),[E]),Ae=o.useMemo(()=>E?Vt:Aa,[E]);return h(ee,{children:[h(en,{"data-testid":"control_panel_wrapper","aria-disabled":s,disabled:s,"data-test":"ControlPanel-ControlPanelWrapper",children:[!U&&e(Zi,{"data-test":"ControlPanel-MediaSettingControl"}),h(tn,{"data-test":"ControlPanel-ControlPanelMainContainer",children:[Me&&h(ee,{children:[e(no,{isMuted:f,onToggle:()=>{c?k():d("audio")},isError:!c,"data-test":"ControlPanel-MuteControl"}),e(oo,{onToggle:()=>{r?H():d("video")},isError:!r,isCameraEnable:B,isLoading:B&&(b==null?void 0:b.isPlaying)===void 0&&!!r,"data-test":"ControlPanel-VideoControl"}),!U&&e(ar,{"data-test":"ControlPanel-ScreenSharingControl"})]}),he&&e(tr,{"data-test":"ControlPanel-RaiseHandControl"}),j&&!we&&e(Yi,{onToggleChat:t,isNewMessage:n,showChatPanel:l,"data-test":"ControlPanel-ChatControl"}),ge&&e(er,{onToggleMemberPanel:a,showMembersPanel:i,"data-test":"ControlPanel-MemberControl"}),e(or,{"data-test":"ControlPanel-CopyLinkControl"})]}),ne&&e(He,{onClick:V,cursorAllowed:!0,bgColor:"var(--bg-button-danger-primary-default)",hoverColor:"var(--bg-button-danger-primary-hover)","data-title":O("noumena.social_hall.Control_panel.leave"),"data-test":"ControlPanel-ControlPanelIcon",children:e(I,{size:24,name:P!=null&&P._id?"logout_m":"spinner_m",color:"--icon-button-neutral-alt-default","data-test":"ControlPanel-Icon"})}),ie&&e(He,{onClick:()=>F(!0),cursorAllowed:!0,bgColor:"var(--bg-button-danger-primary-default)",hoverColor:"var(--bg-button-danger-primary-hover)","data-test":"ControlPanel-ControlPanelIcon",children:e(re,{colorToken:"--text-button-neutral-alt-default","data-test":"ControlPanel-TSpan",children:ze})})]}),e(ce,{isOpen:C,onClose:()=>F(!1),onConfirm:ae,...Ae,"data-test":"ControlPanel-EventModal"}),e(ce,{isOpen:Y,onClose:()=>W(!1),onConfirm:R,isConfirmButtonPrimary:!0,...lt,"data-test":"ControlPanel-EventModal"}),e(lo,{onTogglePopup:d,showAudioModal:m.audio,showVideoModal:m.video,"data-test":"ControlPanel-MediaPermissionNotification"})]})},sr=t=>t.replace(/,:\)/gi,"ðŸ˜…").replace(/,:\(/gi,"ðŸ˜“").replace(/:\)/gi,"ðŸ™‚").replace(/:\|/gi,"ðŸ˜").replace(/;\(/gi,"ðŸ˜­").replace(/:,\(|:'\(/gi,"ðŸ˜¢").replace(/>:\(/gi,"ðŸ˜ ").replace(/:P/g,"ðŸ˜›").replace(/:\$/gi,"ðŸ˜’").replace(/:@/gi,"ðŸ˜¡").replace(/<3/gi,"â¤ï¸").replace(/<\\3|<\/3/gi,"ðŸ’”").replace(/;\)/gi,"ðŸ˜‰").replace(/:,\)|:'\)/gi,"ðŸ˜‚").replace(/:O/gi,"ðŸ˜®").replace(/:D/gi,"ðŸ˜„").replace(/:\(/gi,"ðŸ˜¦").replace(/B-\)/gi,"ðŸ˜Ž").replace(/\(Y\)|\+1/gi,"ðŸ‘").replace(/-1/gi,"ðŸ‘Ž").replace(/\(N\)|-1/gi,"ðŸ‘Ž"),lr=({message:{message:t,profileUrl:a,messageType:n,align:l,...s}})=>{const i=sr(n===Pt.TEXT?t:""),r=o.useMemo(()=>({message:t,showAvatar:!0,userAvatar:a,maxWidth:"100%",...s}),[t,a,s]);if(n===Pt.IMAGE)return e(an,{...r,showStatus:!1,"data-test":"MessageItem-ImageMessageBubble"});if(n===Pt.NOTIFICATION)return h(ee,{children:[e(on,{dangerouslySetInnerHTML:{__html:t.toString()},"data-test":"MessageItem-NotificationMessage"}),e(nn,{"data-test":"MessageItem-NotificationTime",children:Ai(new Date,"hh:mm a")})]});const c={...r,message:i??t};return e(sn,{...c,showStatus:!1,"data-test":"MessageItem-TextMessageBubble"})},ir=({messages:t})=>e(Ka,{"data-test":"MessageList-MessageListWrapper",children:t.map(a=>e(lr,{message:a,"data-test":"MessageList-MessageItem"},a._id))}),io=({onClose:t,show:a,disabled:n})=>{const{t:l}=pe(),{width:s}=ue(),{messages:i,onSendMessage:r}=X(),c=s<le.LAPTOP,d=o.useRef(null),{flags:{socialHallVideoCall:m}}=Ee();o.useEffect(()=>{setTimeout(()=>{d.current&&a&&d.current.scrollTo({top:d.current.scrollHeight,behavior:"smooth"})},200)},[i,a]);const p=(_,S)=>{const v=S.length>0;v&&_?S.forEach((u,M)=>r(M===0?_:"",u)):v?S.forEach(u=>r("",u)):r(_)};return h(ln,{show:a,"data-test":"SocialHallChat-ChatWrapper",children:[h(rn,{"data-test":"SocialHallChat-ChatHeader",children:[e(dn,{colorToken:"--text-appbar-neutral-default","data-test":"SocialHallChat-TitleSpan",children:l("noumena.social_hall.chat")}),c&&!m&&e(ra,{onClick:t,"data-test":"SocialHallChat-CloseButton",children:e(I,{color:"--icon-card-neutral-highlighted",name:"close_m",size:24,"data-test":"SocialHallChat-Icon"})}),m&&e(ra,{onClick:t,socialHallVideoCall:m,"data-test":"SocialHallChat-CloseButton",children:e(I,{color:"--icon-card-neutral-highlighted",name:"close_m",size:24,"data-test":"SocialHallChat-Icon"})})]}),e(Ka,{ref:d,"data-test":"SocialHallChat-MessageListWrapper",children:i&&i.length?e(ir,{messages:i,"data-test":"SocialHallChat-MessageList"}):h(cn,{"data-test":"SocialHallChat-NoMessageWrapper",children:[e(I,{color:"--icon-card-placeholder-neutral-default",name:"message_outline_m",size:144,"data-test":"SocialHallChat-Icon"}),e(re,{colorToken:"--text-placeholder-neutral-default",font:"body-xl","data-test":"SocialHallChat-TSpan",children:l("noumena.social_hall.chat.no_message")})]})}),e(un,{disabled:n,"data-test":"SocialHallChat-MessageInputWrapper",children:e(qi,{withLeftPadding:!0,onSendMessage:p,disabled:n,"data-test":"SocialHallChat-MessageInput"})})]})},Fe=({isOpen:t,onDecline:a,onConfirm:n,description:l,icon:s,showButtons:i,showUserJoined:r,showUserLeave:c})=>t?h(pn,{"data-testid":"main-event-notification",showUserJoined:r,showUserLeave:c,"data-test":"MainEventNotification-Wrapper",children:[h(hn,{"data-test":"MainEventNotification-Section",children:[s&&e(mn,{"data-test":"MainEventNotification-IconWrapper",children:e(fn,{"data-test":"MainEventNotification-IconChild",children:s})}),e("div",{children:e(Qa,{i18nKey:l,components:{span:e(re,{font:"body-m-bold",colorToken:"--text-card-neutral-alt-default","data-test":"MainEventNotification-TSpan"})},"data-test":"MainEventNotification-Trans"})})]}),i&&h(gn,{"data-test":"MainEventNotification-ButtonWrapper",children:[e(Sn,{size:"small",primary:!0,onClick:a,"data-testid":"decline-button","data-test":"MainEventNotification-DeclineButton",children:O("noumena.chamber.decline_button")}),e(x,{secondary:!0,size:"small",onClick:n,"data-testid":"confirm-button","data-test":"MainEventNotification-Button",children:O("noumena.social_hall.join_as_speaker")})]})]}):null,ro=()=>{var N,G;const{user:t}=fe(),{onAcceptSpeakerInvitation:a,onDeclineSpeakerInvitation:n}=Cn(),{toggleRaisedHand:l}=St(),{speakerInvitation:s,stageAttendees:i}=J(),{joinLeaveMember:r,showUserJoined:c,showUserLeave:d,setShowUserJoined:m,setShowUserLeave:p,joinedUsers:_,isRaiseHandRejected:S,resetMembersNotification:v,showRaiseHand:u}=X(),{eventOwner:M}=te(),{speakerSubscription:f}=X(),[g,H]=o.useState(!1),[k,B]=o.useState(!1),[b,w]=o.useState(!1),[E,y]=o.useState(!1),z=o.useCallback(C=>{y(!1),H(C===void 0?g:C),B(C===void 0?k:C),w(C===void 0?b:C)},[b,k,g]),L=o.useCallback(C=>{v(),m(C===void 0?c:C),p(C===void 0?d:C)},[v,m,p,c,d]),K=o.useCallback(()=>{y(!!u)},[u]),$=o.useMemo(()=>i==null?void 0:i.find(C=>C._id===(f==null?void 0:f.inviterId)),[i,f]),P=o.useCallback(()=>{a(),u&&l(!1,t==null?void 0:t._id)},[u,a,l,t==null?void 0:t._id]),U=()=>{n(),u&&l(!u,t==null?void 0:t._id)},T=o.useMemo(()=>{var C;return!!s&&((C=s==null?void 0:s.invitee)==null?void 0:C._id)===(t==null?void 0:t._id)},[s,t==null?void 0:t._id]);return o.useEffect(()=>{z(),K();const C=setTimeout(()=>{z(!1),L(!1)},_n);return()=>{clearTimeout(C)}},[z,L,K]),o.useEffect(()=>{(f==null?void 0:f.actionType)===Mn.SpeakerRemoved&&(f==null?void 0:f.inviteeId)===(t==null?void 0:t._id)&&H(!0)},[f,t==null?void 0:t._id]),o.useEffect(()=>{var C;s&&((C=s.inviter)==null?void 0:C._id)===(t==null?void 0:t._id)?B(!0):B(!1)},[s,t==null?void 0:t._id]),o.useEffect(()=>{S&&w(!0)},[S]),o.useEffect(()=>{u&&w(!1)},[u]),h(bn,{"data-test":"ControlGroupMainEventNotification-ControlGroupNotificationWrapper",children:[E&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,description:O("noumena.social_hall.main_event_raised_hand"),icon:e(I,{imageIconName:"raise_hand_m",size:22,"data-test":"ControlGroupMainEventNotification-Icon"}),"data-test":"ControlGroupMainEventNotification-MainEventNotification"})}),T&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,onDecline:U,onConfirm:P,showButtons:!0,description:O("noumena.social_hall.main_event_speaker_request",{firstName:(N=s==null?void 0:s.inviter)==null?void 0:N.firstName}),icon:e(I,{name:"mic_on_m",size:22,color:"--icon-card-placeholder-neutral-default","data-test":"ControlGroupMainEventNotification-Icon"}),"data-test":"ControlGroupMainEventNotification-MainEventNotification"})}),k&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,description:O("noumena.social_hall.main_event_speaker_request_host",{firstName:(G=s==null?void 0:s.invitee)==null?void 0:G.firstName}),icon:e(Ce,{url:ye.getProfilePicture(s==null?void 0:s.invitee)??"","data-test":"ControlGroupMainEventNotification-Avatar"}),"data-test":"ControlGroupMainEventNotification-MainEventNotification"})}),c&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,description:_.length>1?O("noumena.socialhall.message.More_people_left_socialhall",{numberOfUser:_.length}):O("noumena.socialhall.message.userJoined_socialhall",{firstName:r==null?void 0:r.firstName,lastName:r==null?void 0:r.lastName}),showUserJoined:c,"data-test":"ControlGroupMainEventNotification-MainEventNotification"})}),d&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,description:O("noumena.socialhall.message.userLeft_socialhall",{firstName:r==null?void 0:r.firstName,lastName:r==null?void 0:r.lastName}),showUserLeave:d,"data-test":"ControlGroupMainEventNotification-MainEventNotification"})}),g||b&&e($e,{"data-test":"ControlGroupMainEventNotification-Wrapper",children:e(Fe,{isOpen:!0,description:g?O("noumena.social_hall.main_event_speaker_remove",{firstName:$==null?void 0:$.firstName}):O("noumena.social_hall.main_event_speaker_decline",{firstName:M==null?void 0:M.firstName}),icon:e(I,{name:"mic_off_m",size:24,color:"--icon-card-placeholder-neutral-default","data-test":"ControlGroupMainEventNotification-Icon"}),"data-test":"ControlGroupMainEventNotification-MainEventNotification"})})]})},Ye=({isSingle:t,notification:a,timer:n=Bn,isHostJoined:l})=>{var k,B,b,w,E,y,z,L,K;const{t:s}=pe(),{socialHallAttendee:i,showBuzzRoom:r}=J(),{eventOwner:c}=te(),{setMessages:d}=X(),[m,p]=o.useState(n),{declineKnock:_,acceptKnock:S,acceptLoading:v,declineLoading:u,cancelKnock:M}=ct(),f=o.useMemo(()=>{var $,P;return(P=($=a==null?void 0:a.groupInfo)==null?void 0:$.users)==null?void 0:P.map(U=>{var T;return((T=U==null?void 0:U.profile)==null?void 0:T.profilePictureThumbnail)||""})},[a]),g=()=>{S(a==null?void 0:a._id),r||d([])};o.useEffect(()=>{const $=setInterval(()=>{m>0&&p(m-1e3),m===0&&(clearInterval($),M(a==null?void 0:a._id),_(a==null?void 0:a._id))},1e3);return()=>{clearInterval($)}},[m]);let H=null;return l&&(H=e(ut,{isBordered:!t,"data-testid":"outgoing_notification_wrapper","data-test":"KnockNotification-NotificationWrapper",children:h(pt,{"data-test":"KnockNotification-MainWrapper",children:[e(Ce,{url:ye.getProfilePicture(c)||"","data-test":"KnockNotification-Avatar"}),e(ht,{"data-test":"KnockNotification-TextWrapper",children:h(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:[e(mt,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-NameSpan",children:`${c==null?void 0:c.firstName}(${s("noumena.social_hall.host")}) `}),s("noumena.social_hall.has_joined")]})})]})},a==null?void 0:a._id)),a!=null&&a.receiverUser||(a==null?void 0:a.knockerUserId)===((k=i==null?void 0:i.attendeeId)==null?void 0:k._id)?((a==null?void 0:a.knockStatus)===qe.Pending&&m&&(H=h(ut,{isBordered:!t,"data-testid":"outgoing_notification_wrapper","data-test":"KnockNotification-NotificationWrapper",children:[h(pt,{"data-test":"KnockNotification-MainWrapper",children:[e(Ce,{url:ye.getProfilePicture(a==null?void 0:a.knockerUser)??"","data-test":"KnockNotification-Avatar"}),h(ht,{"data-test":"KnockNotification-TextWrapper",children:[h(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:[e(mt,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-NameSpan",children:s("noumena.you")}),s("noumena.social_hall.are_knocking")]}),e(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:kn(m)})]}),a!=null&&a.receiverUser?e(Ce,{url:ye.getProfilePicture(a==null?void 0:a.receiverUser)??"",size:"M","data-test":"KnockNotification-Avatar"}):e(Gt,{urls:f||[],borderedImage:!0,size:"L","data-test":"KnockNotification-InlineAvatar"})]}),a.knockMessage&&e(da,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-MessageSpan",children:a.knockMessage})]},a==null?void 0:a._id)),(a==null?void 0:a.knockStatus)===qe.Declined&&(H=e(ut,{isBordered:!t,errorBorder:!0,"data-testid":"outgoing_notification_declined_wrapper","data-test":"KnockNotification-NotificationWrapper",children:h(pt,{"data-test":"KnockNotification-MainWrapper",children:[e(Ce,{url:((b=(B=a.receiverUser)==null?void 0:B.profile)==null?void 0:b.profilePicture)||"","data-test":"KnockNotification-Avatar"}),e(ht,{"data-test":"KnockNotification-TextWrapper",children:h(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:[e(mt,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-NameSpan",children:(w=a.receiverUser)==null?void 0:w.firstName}),s("noumena.social_hall.declined_knock")]})}),e(I,{name:"info_m",size:24,color:"--icon-card-danger-primary-default","data-test":"KnockNotification-Icon"})]})},a==null?void 0:a._id))):(E=a==null?void 0:a.knockerUser)!=null&&E._id&&(H=h(ut,{isBordered:!t,"data-testid":"incoming_notification_wrapper","data-test":"KnockNotification-NotificationWrapper",children:[h(pt,{"data-test":"KnockNotification-MainWrapper",children:[e(Ce,{url:((z=(y=a==null?void 0:a.knockerUser)==null?void 0:y.profile)==null?void 0:z.profilePicture)||"","data-test":"KnockNotification-Avatar"}),h(ht,{"data-test":"KnockNotification-TextWrapper",children:[h(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:[e(mt,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-NameSpan",children:(L=a==null?void 0:a.knockerUser)==null?void 0:L.firstName}),s("noumena.social_hall.is_knocking")]}),e(Ge,{colorToken:"--text-card-neutral-default","data-test":"KnockNotification-KnockingSpan",children:(K=a==null?void 0:a.knockerUser)==null?void 0:K.title})]}),h(vn,{"data-test":"KnockNotification-ButtonWrapper",children:[e(x,{size:"small","data-testid":"close_button",onClick:()=>_(a==null?void 0:a._id),icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"KnockNotification-Icon"}),loading:u,"data-test":"KnockNotification-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:()=>g(),icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"KnockNotification-Icon"}),loading:v,"data-test":"KnockNotification-Button"})]})]}),(a==null?void 0:a.knockMessage)&&e(da,{colorToken:"--text-card-neutral-highlighted","data-test":"KnockNotification-MessageSpan",children:a==null?void 0:a.knockMessage})]},a==null?void 0:a._id)),H},rr=({userFeeds:t,speakerFeed:a,maxVideoPerPage:n,isMinimalView:l,isFullScreen:s})=>{const{width:i}=ue(),{isShareScreen:r,isRemoteScreenSharing:c}=X(),d=o.useMemo(()=>r||c,[r,c]),m=o.useMemo(()=>i<le.LAPTOP_L&&i>le.MOBILE_MAX,[i]),p=o.useMemo(()=>i<le.MOBILE_MAX,[i]),{onPrev:_,onNext:S,currentPage:v,isDisablePrev:u,isDisableNext:M,updateCurrentSlide:f,CarouselItems:g}=En({maxVideoPerPage:n,videoCount:t==null?void 0:t.length,SpeakerItems:t});return h(wn,{gap:16,align:"center",isFullScreen:s,children:[g.length<2?null:e(ca,{onClick:_,"data-testid":"previous",disabled:u,size:"small",icon:e(I,{name:"chevron_small_left_m",size:24,"data-test":"SpeakerViewCarousel-Icon"})}),e(yn.Carousel,{emulateTouch:!0,selectedItem:v,onChange:f,showIndicators:!1,showThumbs:!1,showStatus:!1,showArrows:!1,width:p?190:m?570:930,"data-test":"SpeakerViewCarousel-Carousel",children:g.map(H=>e(Hn,{children:H.map(k=>k._id===(a==null?void 0:a._id)&&!d?null:e(In,{children:e(Ft,{isFullScreen:!!s,isMinimalView:l,speakerCarouselPortal:!s,...k,"data-test":"SpeakerViewCarousel-MediaPreview"},k._id)},k._id))},H[0]._id))}),g.length<2?null:e(ca,{onClick:S,"data-testid":"next",size:"small",disabled:M,icon:e(I,{name:"chevron_small_right_m",size:24,"data-test":"SpeakerViewCarousel-Icon"})})]})},dr=t=>{const{speakerFeed:a,isMinimalView:n,clientHeight:l,clientWidth:s,showChatPanel:i,showMembersPanel:r,isFullScreen:c,userFeeds:d}=t,{width:m}=ue(),p=o.useMemo(()=>m<le.LAPTOP_L&&m>le.MOBILE_MAX,[m]),_=o.useMemo(()=>m<le.MOBILE_MAX,[m]),{isShareScreen:S,isRemoteScreenSharing:v}=X(),u=o.useMemo(()=>S||v,[S,v]),{elemRef:M,maxHeight:f,dimension:g}=go({clientHeight:l,clientWidth:s,showChatPanel:i,showMembersPanel:r}),H=o.useMemo(()=>d&&(d==null?void 0:d.length)===1,[d]),k=o.useMemo(()=>H?g.width:g.width-115,[g.width,H]),B=o.useMemo(()=>H?g.height:g.height-115,[g.height,H]);return h(Tn,{isFullScreen:c,"data-test":"SpeakerView-SpeakerWarpper",children:[(a==null?void 0:a._id)&&!u&&e(Pn,{ref:M,style:{maxHeight:f,minWidth:s-368},"data-test":"SpeakerView-SpeakerWarpperChlid",children:e(Nn,{style:{maxWidth:k,maxHeight:B,minWidth:k,minHeight:B},"data-test":"SpeakerView-PinedFrameWarpper",children:(a==null?void 0:a._id)&&e(Ft,{isFullScreen:!!c,isMinimalView:n,speakerCarouselPortal:!1,...a,"data-test":"SpeakerView-MediaPreview"},a==null?void 0:a._id)})}),(!H||u)&&e(rr,{...t,maxVideoPerPage:_?1:p?3:5,"data-test":"SpeakerView-SpeakerViewCarousel"})]})};var We=(t=>(t[t.ON_STAGE=0]="ON_STAGE",t[t.AUDIENCE=1]="AUDIENCE",t[t.RAISED_HAND=2]="RAISED_HAND",t))(We||{});const aa=({header:t,type:a,data:n})=>({header:O(t),type:a,data:n}),cr=t=>aa({header:"noumena.social_hall.audience",type:We.AUDIENCE,data:t}),ur=t=>aa({header:"noumena.social_hall.stage",type:We.ON_STAGE,data:t}),pr=t=>aa({header:"noumena.social_hall.raised_hands",type:We.RAISED_HAND,data:t}),hr={backgroundColor:"var(--bg-button-neutral-default)",marginBottom:"16px"},mr=({user:t,isInvited:a,isOffline:n,sideBarType:l,refetchAudience:s})=>{var P,U,T;const{onDeclineRaiseHand:i,onAcceptRaiseHand:r}=St(),[c,d]=o.useState(!1),[m,p]=o.useState(!1),[_,S]=xe(),{onBlockUser:v}=Ia(),{eventDetails:u}=te(),{mutedUsers:M}=X(),{isHost:f,speakerInvitation:g}=J(),{width:H}=ue(),k=o.useMemo(()=>H<=le.MOBILE_MAX,[H]),B=o.useMemo(()=>Ue(t==null?void 0:t.firstName,t==null?void 0:t.middleName,t==null?void 0:t.lastName),[t]),{handleSelectOptions:b,selectableOptions:w}=Ln({isInvited:a==null?void 0:a(t._id),isMuted:M.includes(t._id),invitationStatus:t.invitationStatus,refetchAudience:s,toggleBlockUserPopup:S,...t}),E=o.useCallback(()=>{v(t._id,u==null?void 0:u._id,B,!0),S()},[t._id,u==null?void 0:u._id,B,v,S]),y=o.useMemo(()=>({onStage:l===We.ON_STAGE,isRaisedHand:l===We.RAISED_HAND,isAudience:l===We.AUDIENCE}),[l]),z=o.useMemo(()=>{var N;return((N=g==null?void 0:g.invitee)==null?void 0:N._id)===t._id},[(P=g==null?void 0:g.invitee)==null?void 0:P._id,t._id]),L=o.useCallback(async()=>{p(!0),await r(t._id),p(!1)},[r,t._id]),K=o.useCallback(async()=>{d(!0),await i(t._id),d(!1)},[i,t._id]),$=o.useMemo(()=>{var N;return y.onStage&&((N=t.getEventUserRole)==null?void 0:N.userRole)===(ua.Host||ua.Cohost)},[(U=t.getEventUserRole)==null?void 0:U.userRole,y.onStage]);return h(On,{"data-test":"SideBarUserItem-ItemWrapper",children:[h(zn,{"data-testid":"avatar_wrapper","data-test":"SideBarUserItem-AvatarWrapper",children:[n&&e(Wn,{"data-test":"SideBarUserItem-OfflineWrapper",children:e(I,{imageIconName:"low_connection_xs",size:24,"data-test":"SideBarUserItem-Icon"})}),e(Ce,{url:((T=t==null?void 0:t.profile)==null?void 0:T.profilePicture)||"","data-test":"SideBarUserItem-Avatar"})]}),h(xn,{"data-test":"SideBarUserItem-NameWrapper",children:[h(ft,{gap:5,align:"center","data-test":"SideBarUserItem-Stack",children:[$&&e(I,{color:"--icon-call-ui-neutral-default",name:"star_s",size:12,"data-test":"SideBarUserItem-Icon"}),e(Un,{colorToken:"--text-tablecell-header-neutral-highlighted",font:"body-m-bold","data-test":"SideBarUserItem-NameSpan",children:B})]}),e(Rn,{font:"footnote",colorToken:"--text-tablecell-body-neutral-default","data-test":"SideBarUserItem-TitleSpan",children:t.title})]}),n&&e(An,{"data-test":"SideBarUserItem-OfflineBadge",children:e(re,{font:"body-s-bold",colorToken:"--text-badge-danger-secondary-default","data-test":"SideBarUserItem-TSpan",children:O("noumena.social_hall.network.offline")})}),h(Kn,{"data-test":"SideBarUserItem-ButtonWrapper",children:[y.isAudience&&f&&z&&!n&&e($n,{"data-test":"SideBarUserItem-StatusTag",children:e(re,{font:"footnote-bold",colorToken:"--text-call-ui-brand-primary-default","data-test":"SideBarUserItem-TSpan",children:O("noumena.social_hall.invite_status.invited")})}),y.onStage&&!n&&h(ee,{children:[e(I,{name:t.isMuted?"mic_off_m":"mic_on_m",size:24,color:"--icon-card-neutral-default","data-test":"SideBarUserItem-Icon"}),e(I,{color:"--icon-card-neutral-default",name:t.isCameraEnable?"webcam_on_m":"webcam_off_m",size:24,"data-test":"SideBarUserItem-Icon"})]}),y.isRaisedHand&&!n&&h(ee,{children:[e(x,{"data-testid":"close_button",size:"small",onClick:K,icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"SideBarUserItem-Icon"}),loading:c,"data-test":"SideBarUserItem-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:L,icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"SideBarUserItem-Icon"}),loading:m,"data-test":"SideBarUserItem-Button"})]}),(y.onStage||y.isAudience)&&f&&e(Re,{containerWidth:"280px",containerHeight:"fit-content",hideIcons:!1,closeOnSelect:!0,onSelectOption:b,options:w,usePortal:!0,isAnimation:!1,observerMinHeight:"0",renderContainerFromBottom:k,dropdownItemStyle:k?hr:{},"data-test":"SideBarUserItem-Dropdown",children:({targetRef:N,targetProps:G,toggle:C})=>e(Gn,{ref:N,onClick:C,...G,"data-test":"SideBarUserItem-ThreeDotsIconWrapper",children:e(I,{color:"--icon-card-neutral-default",name:"more_m",size:24,"data-test":"SideBarUserItem-Icon"})})})]}),e(Ta,{isOpen:_,onClose:S,onConfirm:E,...Pa(B),"data-test":"SideBarUserItem-EventCancelAttendeeModal"})]})},fr=({onClose:t,show:a,isInvited:n,onlineAttendees:l})=>{const{width:s}=ue(),i=o.useMemo(()=>s<=le.MOBILE_MAX,[s]),[r,c]=o.useState(!1),d=o.useRef(null),{isHost:m,socialHallAttendeesAndGroups:p,stageAttendees:_,audienceAttendees:S}=J(),{isEventHost:v,eventDetails:u}=te(),M=()=>c(T=>!T),f=o.useCallback(()=>{var T;(T=d.current)==null||T.open((u==null?void 0:u._id)??"",!!v)},[v,u]),{pendingAttendees:g,refetchAudience:H}=Vn({eventId:(u==null?void 0:u._id)||"",isHost:!!m,shouldFetch:!!(u!=null&&u._id)&&m!==void 0}),{raisedHandUsers:k,mutedUsers:B,camUsers:b,networkErrorUsers:w}=X(),E=o.useMemo(()=>{var T,N,G,C;return(C=(G=Qt.first((N=(T=p==null?void 0:p.data)==null?void 0:T.socialHallGroups)==null?void 0:N.data))==null?void 0:G.users)==null?void 0:C.filter(F=>k==null?void 0:k.includes(F==null?void 0:F._id))},[k,p]),y=o.useMemo(()=>{const T=u!=null&&u.isInstantEvent?l:_;return T==null?void 0:T.map(N=>({...N,isMuted:B.includes(N._id),isCameraEnable:b.includes(N._id)}))},[b,B,_,l,u==null?void 0:u.isInstantEvent]),z=o.useMemo(()=>Ut(g).map(T=>({...T.userId,invitationStatus:"PENDING"})),[g]),L=o.useMemo(()=>[...S||[],...z||[]],[z,S]),K=o.useMemo(()=>m&&E?L.filter(T=>!(k!=null&&k.includes(T==null?void 0:T._id))):L,[L,E,m,k]),$=o.useMemo(()=>u!=null&&u.isInstantEvent?(y==null?void 0:y.length)||0:((E==null?void 0:E.length)||0)+((y==null?void 0:y.length)||0)+((L==null?void 0:L.length)||0),[E==null?void 0:E.length,y==null?void 0:y.length,L==null?void 0:L.length,u==null?void 0:u.isInstantEvent]),P=o.useMemo(()=>{const T=cr(K||[]),N=ur(y||[]),G=m?pr(E):void 0;if(u!=null&&u.isInstantEvent)return[N];const C=[T,N];return G?[G,...C]:C},[K,E,m,y,u==null?void 0:u.isInstantEvent]),U=o.useCallback(T=>{T.value==="see_event_attendees"?f():T.value==="invite_users"&&M()},[f]);return h(Fn,{"data-testid":"side_bar_wrapper",show:a,"data-test":"SocialHallMembers-SideBarWrapper",children:[h(Dn,{"data-test":"SocialHallMembers-SideBarActionHeader",children:[e(pa,{"data-test":"SocialHallMembers-IconButton",children:e(I,{onClick:t,color:"--icon-button-brand-primary-default",name:"close_m",size:24,"data-test":"SocialHallMembers-Icon"})}),h(re,{font:"body-l",colorToken:"--text-appbar-neutral-default","data-test":"SocialHallMembers-TSpan",children:[" ",`${O("noumena.social_hall.users")} (${$})`]}),e(Re,{closeOnSelect:!0,placement:"bottom-end",isShowEmptyText:!1,onSelectOption:T=>U(T),options:v?qn:Jn,containerWidth:"197",padding:"0",observerMinHeight:"0",usePortal:!0,renderContainerFromBottom:i,dropdownItemStyle:i?jn:{},"data-test":"SocialHallMembers-Dropdown",children:({targetRef:T,targetProps:N,toggle:G})=>e(pa,{ref:T,onClick:G,...N,"data-testid":"three_dot_button","data-test":"SocialHallMembers-IconButton",children:e(I,{color:"--icon-button-neutral-default",name:"more_m",size:24,"data-test":"SocialHallMembers-Icon"})})})]}),P.map(({data:T,header:N,type:G})=>T!=null&&T.length?h(Ki.Fragment,{children:[e(Xn,{"data-test":"SocialHallMembers-SideBarHeaderWrapper",children:e(Yn,{colorToken:"--text-tablecell-body-neutral-default",font:"footnote","data-test":"SocialHallMembers-SideBarHeader",children:O(N)})}),e(Qn,{"data-testid":"list_wrapper",isScrollable:T.length===1,"data-test":"SocialHallMembers-ListWrapper",children:T.map(C=>e(mr,{user:C,isInvited:n,refetchAudience:H,sideBarType:G,isOffline:w.includes(C._id),"data-test":"SocialHallMembers-SideBarUserItem"},C==null?void 0:C._id))})]},N):null),e(Dt,{ref:d,"data-test":"SocialHallMembers-EventAttendeesModal"}),e(qt,{isOpen:r,handleClose:M,refetchAudience:H,"data-test":"SocialHallMembers-InviteAttendeeModal"})]})},gr=({isFullScreen:t,fullScreenElemId:a,screenShareElemId:n,clientHeight:l,clientWidth:s,showChatPanel:i,showMembersPanel:r})=>{const{activeSocialHallGroup:c,onCloseFullScreen:d}=J(),{isShareScreen:m,onToggleScreenSharing:p,screenSharingLocalUserFeed:_,screenSharingRemoteUserFeed:S}=X(),v=o.useCallback(()=>{const B=document.getElementById(a);if(_)return;const b=(B==null?void 0:B.requestFullscreen)||(B==null?void 0:B.webkitRequestFullScreen)||(B==null?void 0:B.mozRequestFullScreen)||(B==null?void 0:B.msRequestFullscreen);b==null||b.call(B)},[_,a]),u=o.useCallback(()=>{const B=document.getElementById(a);B!=null&&B.requestFullscreen&&(B==null||B.requestFullscreen())},[a]),{elemRef:M,maxHeight:f,dimension:g}=go({clientHeight:l,clientWidth:s,showChatPanel:i,showMembersPanel:r}),H=o.useMemo(()=>{var B,b;if(S!=null&&S.uid){const w=Ie.cleanScreenSharingUid(S==null?void 0:S.uid);return(b=(B=c==null?void 0:c.users)==null?void 0:B.find(E=>(E==null?void 0:E._id)===w))==null?void 0:b.firstName}return""},[c==null?void 0:c.users,S==null?void 0:S.uid]),k=o.useMemo(()=>m?"noumena.social_hall.screen_sharing_current_user":"noumena.social_hall.screen_sharing_remote_user",[m]);return h(ft,{vertical:!0,fullWidth:!0,align:"center","data-test":"ScreenShare-Stack",children:[e(Zn,{"data-test":"ScreenShare-ScreenSharingLabel",children:e(Qa,{i18nKey:k,values:{firstName:H},components:{b:e("b",{"data-test":"ScreenShare-b"})},"data-test":"ScreenShare-Trans"})}),h(es,{ref:M,style:{maxHeight:`${t?"none":f}`,minWidth:`${!t&&s-368}`},"data-test":"ScreenShare-ScreenShareWarpper",children:[t&&e(ts,{onClick:d,"data-test":"ScreenShare-CloseFullScreenButton",children:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"ScreenShare-Icon"})}),h(as,{isFullScreen:t,isShareUserFeed:!!_,id:"screenShareWrapper","data-test":"ScreenShare-PinnedFrameWrapper",children:[e(os,{style:{maxWidth:`${t?"none":g.width-115}px`,maxHeight:`${t?"none":g.height-115}px`,minWidth:`${t?"none":g.width-115}px`,minHeight:`${t?"none":g.height-115}px`},"data-test":"ScreenShare-StopSharing",children:h(ft,{vertical:!0,gap:8,align:"center","data-test":"ScreenShare-Stack",children:[e(ns,{cursorAllowed:!0,onClick:()=>p(),"data-test":"ScreenShare-ControlIconWrapper",children:e(I,{name:"share_content_off_m",size:24,color:"--icon-button-neutral-default","data-test":"ScreenShare-Icon"})}),e(re,{font:"body-m-bold",colorToken:"--color-base-gray-100","data-test":"ScreenShare-TSpan",children:O("noumena.social_hall.stop_sharing_screen")})]})}),e(ss,{isShareUserFeed:!_&&!t,onClick:u,"data-test":"ScreenShare-FullScreenButton",children:e(I,{name:"fullscreen_xs",size:24,color:"--icon-call-ui-neutral-alt-default","data-test":"ScreenShare-Icon"})}),e(ls,{isFullScreen:t,id:n,onClick:v,style:{maxWidth:`${t?"none":`${g.width-115}px`}`,maxHeight:`${t?"none":`${g.height-115}px`}`,minWidth:`${t?"none":`${g.width-115}px`}`,minHeight:`${t?"none":`${g.height-115}px`}`},"data-test":"ScreenShare-PinedFrame"})]})]})]})},co=({isScreenSharing:t})=>{const{width:a}=ue(),{showBuzzRoom:n,onSwitchLayout:l,isGridLayout:s}=J(),i=a<le.TABLET,r=o.useCallback(c=>{i||l(c)},[i,l]);return h(it,{isBuzzRoom:n,"data-test":"LayoutToggle-RightWrapper",children:[e(x,{onClick:()=>r(!0),size:"small",disabled:t,icon:e(I,{color:!t&&s?"--icon-tab-basic-brand-primary-default":"--icon-tab-basic-neutral-default",name:"video_grid_gallery_m",size:16,"data-test":"LayoutToggle-Icon"}),"data-test":"LayoutToggle-Button"}),!i&&e(x,{onClick:()=>r(!1),size:"small",disabled:t,icon:e(I,{color:!t&&!s?"--icon-tab-basic-brand-primary-default":"--icon-tab-basic-neutral-default",name:"video_grid_speaker_m",size:16,"data-test":"LayoutToggle-Icon"}),"data-test":"LayoutToggle-Button"})]})},uo=()=>{const{remainTime:t}=Bt(),[a,n]=o.useState(!1),{eventDetails:l}=te();return o.useEffect(()=>{(l==null?void 0:l.status)===D.PreLive&&t/1e3<4&&t/1e3>3&&n(!0)},[l==null?void 0:l.status,t]),e(ce,{isOpen:a,onClose:()=>n(!1),countDown:!0,remainTime:t,...Jt,"data-test":"HeaderCountDownModal-EventModal"})},Sr=({isOpen:t,onClose:a,onSettingsClick:n,onChangeRoomNameClick:l})=>{const{isMainEvent:s}=te(),{t:i}=pe();return e($a,{enableCloseButton:!0,open:t,onClose:a,position:"fixed","data-test":"MoreOptionsBottomSheet-BottomSheet",children:h(Ga,{"data-test":"MoreOptionsBottomSheet-SocialHallBottomSheetBody",children:[!s&&e(x,{icon:e(I,{color:"--text-button-neutral-default",name:"edit_s",size:24,"data-test":"MoreOptionsBottomSheet-Icon"}),size:"full",onClick:l,"data-test":"MoreOptionsBottomSheet-Button",children:i("noumena.social_hall.change_group_name")}),e(x,{icon:e(I,{color:"--text-button-neutral-default",name:"settings_m",size:24,"data-test":"MoreOptionsBottomSheet-Icon"}),size:"full",onClick:n,"data-test":"MoreOptionsBottomSheet-Button",children:i("noumena.social_hall.settings")})]})})},Cr=({isOpen:t,onClose:a,onLayoutChange:n})=>{const{t:l}=pe(),s=i=>{n(i),a()};return e($a,{enableCloseButton:!0,open:t,onClose:a,position:"fixed","data-test":"LayoutSwitchBottomSheet-BottomSheet",children:h(Ga,{"data-test":"LayoutSwitchBottomSheet-SocialHallBottomSheetBody",children:[e(x,{icon:e(I,{color:"--icon-tab-basic-neutral-default",name:"video_grid_gallery_m",size:16,"data-test":"LayoutSwitchBottomSheet-Icon"}),size:"full",onClick:()=>s(!0),"data-test":"LayoutSwitchBottomSheet-Button",children:l("noumena.social_hall.gallery_view")}),e(x,{icon:e(I,{color:"--icon-tab-basic-neutral-default",name:"video_grid_speaker_m",size:16,"data-test":"LayoutSwitchBottomSheet-Icon"}),size:"full",onClick:()=>s(!1),"data-test":"LayoutSwitchBottomSheet-Button",children:l("noumena.social_hall.speaker_view")})]})})},po=({onChangeGroupName:t,isScreenSharing:a})=>{const{width:n}=ue(),{onSwitchLayout:l,isGridLayout:s,selectDefaultMediaInput:i}=J(),r=n<le.TABLET,[c,d]=o.useState(!1),[m,p]=o.useState(!1),[_,S]=o.useState(!1),v=()=>{p(!1)},u=g=>{p(!1),l(g)},M=o.useCallback(()=>{i(),S(g=>!g),d(!1)},[i]),f=o.useCallback(()=>{t==null||t(),d(!1)},[t]);return r?h(ee,{children:[e(x,{onClick:()=>p(!0),size:"small",disabled:a,icon:e(I,{color:a?"--icon-tab-basic-neutral-default":"--icon-tab-basic-brand-primary-default",name:s?"video_grid_gallery_m":"video_grid_speaker_m",size:16,"data-test":"HeaderBottomSheet-Icon"}),"data-test":"HeaderBottomSheet-Button"}),e(rt,{onClick:()=>d(!0),"data-test":"HeaderBottomSheet-IconButton",children:e(I,{color:"--icon-tab-basic-brand-neutral-default",name:"more_m",size:24,"data-test":"HeaderBottomSheet-Icon"})}),e(Sr,{isOpen:c,onClose:()=>d(!1),onSettingsClick:M,onChangeRoomNameClick:f,"data-test":"HeaderBottomSheet-MoreOptionsBottomSheet"}),e(Cr,{onClose:v,isOpen:m,onLayoutChange:u,"data-test":"HeaderBottomSheet-LayoutSwitchBottomSheet"}),e(ao,{isOpen:_,onAccept:M,handleClose:M,"data-test":"HeaderBottomSheet-MediaSettingModal"})]}):null},kt=()=>{const{showBuzzRoom:t,setShowBuzzRoom:a}=J(),{isMainEvent:n,eventDetails:l}=te();return o.useMemo(()=>t&&!n&&!(l!=null&&l.isInstantEvent),[t,n,l==null?void 0:l.isInstantEvent])?e(is,{"data-testid":"toggle_buzzroom_btn","data-test":"ToggleBuzzRoomBtn-LeftWrapper",children:e(rt,{onClick:()=>a(!1),"data-test":"ToggleBuzzRoomBtn-IconButton",children:e(I,{color:"--icon-button-neutral-default",name:"chevron_small_down_m",size:24,"data-test":"ToggleBuzzRoomBtn-Icon"})})}):null},_r=({isInstantEvent:t,status:a})=>{let n="";return t||([D.PreEvent,D.PreLive].includes(a)&&(n=O("noumena.social_hall.main_event")),a===D.Live&&(n=O("noumena.social_hall.main_event")),a===D.PostEvent&&(n=O("noumena.social_hall.post_event"))),n},Qe=()=>{const{eventDetails:t}=te(),a=o.useMemo(()=>_r(t),[t]);return a?e(rs,{font:"body-s-bold",colorToken:"--text-tab-chips-brand-primary-selected","data-test":"EventTag-TagSpan",children:a}):null},ho=({onChangeGroupName:t,showMobileView:a})=>{const{showBuzzRoom:n}=J(),{groupName:l,isMainEvent:s,eventDetails:i,isEventHost:r}=te(),c=o.useMemo(()=>!((!n||s||i!=null&&i.isInstantEvent)&&r),[i==null?void 0:i.isInstantEvent,s,n,r]);return a?h(ha,{"data-test":"GroupName-TagTitleContainer",children:[e(Qe,{"data-test":"GroupName-EventTag"}),e(Je,{"data-test":"GroupName-TitleWrapper",children:e(je,{font:"body-xl-bold",isGray:n&&!l,"data-test":"GroupName-TitleSpan",children:l||O("noumena.social_hall.add_group_name")})})]}):h(ha,{"data-test":"GroupName-TagTitleContainer",children:[e(Qe,{"data-test":"GroupName-EventTag"}),h(Je,{"data-test":"GroupName-TitleWrapper",children:[e(je,{font:"body-xl-bold",isGray:n&&!l&&!s,"data-test":"GroupName-TitleSpan",children:l||O("noumena.social_hall.add_group_name")}),!c&&e(I,{onClick:t,color:"--icon-card-neutral-default",name:"edit_m",size:24,"data-test":"GroupName-Icon"})]})]})},mo=()=>{const{formattedTime:t}=Bt(),{isPostEvent:a,isEndedEvent:n,eventDetails:l}=te();return!a&&!n?e(nt,{font:"systemInfo-m",isCountDown:(l==null?void 0:l.status)===D.PreLive||(l==null?void 0:l.status)===D.PostEventEnded,"data-testid":"counter_clock","data-test":"HeaderTimer-CounterClockSpan",children:t}):null},fo=()=>{const{width:t}=ue(),a=t<le.TABLET,n=t<le.TABLET_L,{deviceId:l}=J(),{onChangeDevice:s,isCameraEnable:i}=X(),r=o.useRef([]),c=()=>{var m;const d=(m=r.current)==null?void 0:m.find(p=>p.deviceId!==(l==null?void 0:l.camera));s({...l,camera:(d==null?void 0:d.deviceId)??""})};return o.useEffect(()=>{(async()=>{const m=(await Be.getAllConnectedMedia()).cameraDevices;m&&(r.current=m)})()},[]),a||n?e(x,{size:"small",onClick:()=>c(),disabled:!i,icon:e(I,{name:"flip_camera_m",size:18,"data-test":"SwitchCamera-Icon"}),"data-test":"SwitchCamera-Button"}):null},Mr=({children:t,isBuzzRoom:a,showMobileView:n})=>n?e(_t,{"data-test":"GroupNameWrapper-MobileBuzzRoomMiddleWrapper",children:t}):e(Mt,{isBuzzRoom:a,"data-test":"GroupNameWrapper-MiddleWrapper",children:t}),br=({onChangeGroupName:t})=>{const a=Pe(),{t:n}=pe(),{onLeaveCall:l,isShareScreen:s,isRemoteScreenSharing:i,onExitSocialHallCall:r}=X(),[c,d]=o.useState(!1),{showBuzzRoom:m,setShowBuzzRoom:p,setIsBlockNavigate:_}=J(),{isMainEvent:S,eventDetails:v}=te(),{width:u}=ue(),{isUnregistered:M}=fe(),[f,g]=o.useState(!1),H=u<le.TABLET,k=async()=>{S||v!=null&&v.isInstantEvent?g(!0):(d(!0),l(),d(!1),p(!1))},B=o.useMemo(()=>s||i,[s,i]),b=o.useCallback(async()=>{g(!1),_(!1),await r(),a(M?Se.GUEST_HOME:Se.HOME_NOUM)},[M,a,_,r]),w=o.useMemo(()=>H&&m,[H,m]);return h(Ct,{isRow:m||S,"data-testid":"attendee_header","data-test":"AttendeeHeader-Wrapper",children:[e(kt,{"data-test":"AttendeeHeader-ToggleBuzzRoomBtn"}),h(Mr,{showMobileView:w,isBuzzRoom:m,"data-test":"AttendeeHeader-GroupNameWrapper",children:[e(ho,{onChangeGroupName:t,showMobileView:w,"data-test":"AttendeeHeader-GroupName"}),e(mo,{"data-test":"AttendeeHeader-HeaderTimer"})]}),h(it,{isBuzzRoom:m,"data-test":"AttendeeHeader-RightWrapper",children:[m&&H&&e(ee,{children:e(x,{size:"small",intent:"negative",loading:c,onClick:()=>k(),"data-testid":"leave_quietly_button","data-test":"AttendeeHeader-Button",children:n("noumena.social_hall.leave")})}),e(fo,{"data-test":"AttendeeHeader-SwitchCamera"}),m&&h(ee,{children:[!H&&e(co,{isScreenSharing:B,"data-test":"AttendeeHeader-LayoutToggle"}),e(po,{onChangeGroupName:t,isScreenSharing:B,"data-test":"AttendeeHeader-HeaderBottomSheet"})]}),!m&&e(x,{size:H?"full_small":"small",intent:"negative",onClick:()=>g(!0),"data-testid":"leave_event_button","data-test":"AttendeeHeader-Button",children:n("noumena.social_hall.leave_the_event")})]}),e(uo,{"data-test":"AttendeeHeader-HeaderCountDownModal"}),e(ce,{isOpen:f,onClose:()=>g(!1),onConfirm:b,isConfirmButtonPrimary:!0,...lt,"data-test":"AttendeeHeader-EventModal"})]})},kr=({onViewAttendees:t,onChangeGroupName:a})=>{const n=Pe(),{t:l}=pe(),{onLeaveCall:s,onExitSocialHallCall:i}=X(),[r,c]=o.useState(!1),{showBuzzRoom:d,setShowBuzzRoom:m,setIsBlockNavigate:p}=J(),{isMainEvent:_,isPostEvent:S,isEndedEvent:v,eventDetails:u,groupName:M}=te(),{formattedTime:f,remainTime:g}=Bt(),{width:H}=ue(),{isUnregistered:k}=fe(),[B,b]=o.useState(!1),[w,E]=o.useState(!1),y=H<le.TABLET,z=o.useMemo(()=>(d&&!_?ds:cs).map(T=>({...T,icon:e(I,{name:T.iconName,color:T.labelColor,size:24,"data-test":"AttendeeHeaderOld-selectableOptions-updatedOptions-Icon"})})),[d,_]),L=async()=>{_?b(!0):(c(!0),s(),c(!1),m(!1))},K=o.useCallback(P=>{P.value==="change_room_name"?a==null||a():P.value==="see_event_attendees"&&(t==null||t())},[a,t]),$=o.useCallback(async()=>{b(!1),p(!1),await i(),n(k?Se.GUEST_HOME:Se.HOME_NOUM)},[i,k,n,p]);return o.useEffect(()=>{(u==null?void 0:u.status)===D.PreLive&&g/1e3<4&&g/1e3>3&&E(!0)},[u==null?void 0:u.status,g]),h(Ct,{isRow:d||_,"data-testid":"attendee_header","data-test":"AttendeeHeaderOld-Wrapper",children:[e(kt,{"data-test":"AttendeeHeaderOld-ToggleBuzzRoomBtn"}),y&&d?h(_t,{"data-test":"AttendeeHeaderOld-MobileBuzzRoomMiddleWrapper",children:[e(Qe,{"data-test":"AttendeeHeaderOld-EventTag"}),e(Je,{"data-test":"AttendeeHeaderOld-TitleWrapper",children:e(je,{font:"body-xl-bold",colorToken:d&&!M?"--text-card-neutral-default":"--text-appbar-neutral-default","data-test":"AttendeeHeaderOld-TitleSpan",children:M||l("noumena.social_hall.add_group_name")})}),!S&&!v&&e(nt,{font:"systemInfo-m",colorToken:(u==null?void 0:u.status)===D.PreLive||(u==null?void 0:u.status)===D.PostEventEnded?"--text-timestamp-danger-primary-default":"--text-timestamp-neutral-default","data-test":"AttendeeHeaderOld-CounterClockSpan",children:f})]}):h(Mt,{isBuzzRoom:d,"data-test":"AttendeeHeaderOld-MiddleWrapper",children:[h(Je,{"data-test":"AttendeeHeaderOld-TitleWrapper",children:[e(Qe,{"data-test":"AttendeeHeaderOld-EventTag"}),e(je,{font:"body-xl-bold",colorToken:d&&!M?"--text-card-neutral-default":"--text-appbar-neutral-default","data-test":"AttendeeHeaderOld-TitleSpan",children:d&&!_?M||l("noumena.social_hall.add_group_name"):u==null?void 0:u.title})]}),!S&&!v&&e(nt,{font:"systemInfo-m",colorToken:(u==null?void 0:u.status)===D.PreLive||(u==null?void 0:u.status)===D.PostEventEnded?"--text-timestamp-danger-primary-default":"--text-timestamp-neutral-default","data-testid":"counter_clock","data-test":"AttendeeHeaderOld-CounterClockSpan",children:f})]}),h(it,{isBuzzRoom:d,"data-test":"AttendeeHeaderOld-RightWrapper",children:[d?e(x,{size:"small",secondary:!0,loading:r,onClick:()=>L(),leftIcon:e(I,{imageIconName:"leave_quietly",size:24,"data-test":"AttendeeHeaderOld-Icon"}),"data-testid":"leave_quietly_button","data-test":"AttendeeHeaderOld-Button",children:l("noumena.social_hall.leave_quietly")}):e(x,{size:y?"full_small":"small",secondary:!0,onClick:()=>b(!0),"data-testid":"leave_event_button","data-test":"AttendeeHeaderOld-Button",children:l("noumena.social_hall.leave_the_event")}),e(jt,{"data-testid":"dropdown_wrapper","data-test":"AttendeeHeaderOld-DropdownWrapper",children:e(Re,{hideIcons:!1,closeOnSelect:!0,placement:"bottom-end",onSelectOption:P=>K(P),options:z,containerWidth:"280px",usePortal:!1,calRefTop:!1,isAnimation:!1,usePopStyle:!0,"data-test":"AttendeeHeaderOld-Dropdown",children:({targetRef:P,targetProps:U,toggle:T})=>e(rt,{ref:P,onClick:T,...U,"data-testid":"three_dot_button","data-test":"AttendeeHeaderOld-IconButton",children:e(I,{color:"--icon-button-neutral-default",name:"more_m",size:24,"data-test":"AttendeeHeaderOld-Icon"})})})})]}),e(ce,{isOpen:w,onClose:()=>E(!1),countDown:!0,remainTime:g,...Jt,"data-test":"AttendeeHeaderOld-EventModal"}),e(ce,{isOpen:B,onClose:()=>b(!1),onConfirm:$,isConfirmButtonPrimary:!0,...lt,"data-test":"AttendeeHeaderOld-EventModal"})]})},vr=({options:t,onSelectOption:a})=>e(jt,{"data-testid":"dropdown_wrapper","data-test":"HeaderDropDownMenu-DropdownWrapper",children:e(Re,{hideIcons:!1,closeOnSelect:!0,placement:"bottom-end",onSelectOption:n=>a(n),options:t,containerWidth:"280px",usePortal:!1,calRefTop:!1,isAnimation:!1,usePopStyle:!0,"data-test":"HeaderDropDownMenu-Dropdown",children:({targetRef:n,targetProps:l,toggle:s})=>e(rt,{ref:n,onClick:s,...l,"data-testid":"three_dot_button","data-test":"HeaderDropDownMenu-IconButton",children:e(I,{color:"--icon-button-neutral-default",name:"more_m",size:24,"data-test":"HeaderDropDownMenu-Icon"})})})}),Br=({children:t,isBuzzRoom:a,showMobileView:n})=>n?e(_t,{"data-test":"GroupNameWrapper-MobileBuzzRoomMiddleWrapper",children:t}):e(Mt,{isBuzzRoom:a,"data-test":"GroupNameWrapper-MiddleWrapper",children:t}),Er=({onViewAttendees:t,onInviteAttendees:a,onChangeGroupName:n})=>{const{isUnregistered:l}=fe(),{t:s}=pe(),i=Pe(),{width:r}=ue(),{showRaiseHand:c,isShareScreen:d,onExitSocialHallCall:m,isRemoteScreenSharing:p,onSendSubscriptionMessage:_}=X(),{showBuzzRoom:S,setIsBlockNavigate:v}=J(),{hostJoined:u,eventDetails:M,isMainEvent:f,isPostEvent:g,isEventOwner:H,isEventHost:k,onUpdateEventStatus:B}=te(),{logError:b}=st(),{userOwnKnocks:w,userActiveKnocks:E}=Ne(),[y,z]=o.useState(!1),[L,K]=o.useState(!1),[$,P]=o.useState(!1),[U,T]=o.useState(!1),[N,G]=o.useState(!1),C=r<le.TABLET,F=o.useMemo(()=>d||p,[d,p]),Y=o.useMemo(()=>S&&C&&(f||(M==null?void 0:M.isInstantEvent)),[S,f,C,M==null?void 0:M.isInstantEvent]),W=o.useMemo(()=>D.PostEvent===(M==null?void 0:M.status)||D.PostEventEnded===(M==null?void 0:M.status),[M==null?void 0:M.status]),V=o.useMemo(()=>[...(w==null?void 0:w.data)??[],...(E==null?void 0:E.data)??[]],[w==null?void 0:w.data,E==null?void 0:E.data]),A=o.useMemo(()=>{let ne=Da;return H||(ne=qa),W&&(ne=Ja),ne==null?void 0:ne.map(ge=>({...ge,icon:e(I,{name:ge.iconName,color:ge.labelColor,size:24,"data-test":"HostHeader-selectableOptions-updatedOptions-Icon"})}))},[W,H]),R=o.useCallback(async ne=>{try{z(!0),await B(ne)}catch(ie){b(ie,"")}finally{z(!1)}},[b,B]),ae=o.useCallback(async()=>{await R(D.PreLive)},[R]),Z=o.useCallback(async()=>{T(!1),K(!1),v(!1);let ne=M!=null&&M.recurring?D.Expired:D.Cancelled;g&&(ne=D.PostEventEnded),await(B==null?void 0:B(ne))},[v,g,B,M==null?void 0:M.recurring]),oe=o.useCallback(async()=>{G(!1),await m(),i(l?Se.GUEST_HOME:Se.HOME_NOUM)},[m,i,l]),Q=o.useCallback(async()=>{_({type:ve.UPDATE_EVENT_STATUS,data:D.Cancelled}),P(!1),await R(D.Cancelled)},[R,_]),Me=o.useCallback(ne=>{switch(ne.value){case"start_main_event":ae();break;case"invite_users":a==null||a();break;case"leave_and_cancel_event":K(!0);break;case"see_event_attendees":t==null||t();break;case"leave_event":G(!0);break;case"copy_the_event_link":navigator.clipboard.writeText(`${window.location}`??"");break}},[ae,a,t]),j=o.useMemo(()=>f?Vt:Aa,[f]),he=o.useMemo(()=>C&&S&&!(V.length>0||u)&&!(f&&k&&c),[C,S,V.length,u,f,k,c]);return h(Ct,{isRow:S||f,"data-testid":"host_header","data-test":"HostHeader-Wrapper",children:[e(kt,{"data-test":"HostHeader-ToggleBuzzRoomBtn"}),h(Br,{showMobileView:he,isBuzzRoom:S,"data-test":"HostHeader-GroupNameWrapper",children:[e(ho,{onChangeGroupName:n,showMobileView:he,"data-test":"HostHeader-GroupName"}),e(mo,{"data-test":"HostHeader-HeaderTimer"})]}),h(it,{isBuzzRoom:S,"data-test":"HostHeader-RightWrapper",children:[(M==null?void 0:M.status)===D.PreEvent&&!S&&e(x,{size:C?"full_small":"small",primary:!0,loading:y,onClick:()=>ae(),leftIcon:e(I,{color:"--icon-button-neutral-alt-default",name:"wave_left_m",size:24,"data-test":"HostHeader-Icon"}),rightIcon:e(I,{color:"--icon-button-neutral-alt-default",name:"wave_right_m",size:24,"data-test":"HostHeader-Icon"}),"data-testid":"start_event_button","data-test":"HostHeader-Button",children:s("noumena.social_hall.start_main_event")}),e(fo,{"data-test":"HostHeader-SwitchCamera"}),S&&h(ee,{children:[!C&&e(co,{isScreenSharing:F,"data-test":"HostHeader-LayoutToggle"}),e(po,{onChangeGroupName:n,isScreenSharing:F,"data-test":"HostHeader-HeaderBottomSheet"})]}),Y&&e(x,{size:"small",intent:"negative",loading:y,onClick:()=>P(!0),"data-testid":"finish_main_event","data-test":"HostHeader-Button",children:s(C?"noumena.socialhall.end_the_event":"noumena.social_hall.finish_main_event")}),W&&!S&&e(x,{size:"full_small",secondary:!0,intent:"negative",loading:y,onClick:()=>T(!0),"data-testid":"end_event","data-test":"HostHeader-Button",children:s("noumena.social_hall.end_event")}),!S&&e(vr,{options:A,onSelectOption:Me,"data-test":"HostHeader-HeaderDropDownMenu"})]}),!(M!=null&&M.isInstantEvent)&&e(uo,{"data-test":"HostHeader-HeaderCountDownModal"}),e(ce,{isOpen:L,onClose:()=>K(!1),onConfirm:Z,...Va,"data-test":"HostHeader-EventModal"}),e(ce,{isOpen:$,onClose:()=>P(!1),onConfirm:Q,...j,"data-test":"HostHeader-EventModal"}),e(ce,{isOpen:U,onClose:()=>T(!1),onConfirm:Z,...Fa,"data-test":"HostHeader-EventModal"}),e(ce,{isOpen:N,onClose:()=>G(!1),onConfirm:oe,isConfirmButtonPrimary:!0,...lt,"data-test":"HostHeader-EventModal"})]})},wr=({onViewAttendees:t,onInviteAttendees:a,onChangeGroupName:n})=>{const{isUnregistered:l}=fe(),{t:s}=pe(),i=Pe(),{width:r}=ue(),{onLeaveCall:c,showRaiseHand:d,onExitSocialHallCall:m}=X(),{showBuzzRoom:p,setShowBuzzRoom:_,setIsBlockNavigate:S}=J(),{groupName:v,hostJoined:u,onUpdateEventStatus:M,eventDetails:f,isMainEvent:g,isPostEvent:H,isEndedEvent:k,isEventOwner:B,isEventHost:b,isPreEvent:w}=te(),{logError:E}=st(),{formattedTime:y,remainTime:z}=Bt(),{userOwnKnocks:L,userActiveKnocks:K}=Ne(),[$,P]=o.useState(!1),[U,T]=o.useState(!1),[N,G]=o.useState(!1),[C,F]=o.useState(!1),[Y,W]=o.useState(!1),[V,A]=o.useState(!1),[R,ae]=o.useState(!1),Z=r>=le.LAPTOP_L,oe=r<le.TABLET,Q=o.useCallback(async()=>{try{T(!0),_(!1),await c(),T(!1)}catch(se){E(se,"",!1)}},[E,c,_]),Me=o.useMemo(()=>p&&g,[p,g]),j=o.useMemo(()=>D.PostEvent===(f==null?void 0:f.status)||D.PostEventEnded===(f==null?void 0:f.status),[f==null?void 0:f.status]),he=o.useMemo(()=>[...(L==null?void 0:L.data)??[],...(K==null?void 0:K.data)??[]],[L==null?void 0:L.data,K==null?void 0:K.data]),ne=o.useMemo(()=>{let se=Da;return B||(se=qa),j?se=Ja:p&&!g&&(se=oe?us:ps),se==null?void 0:se.map(me=>({...me,icon:e(I,{name:me.iconName,color:me.labelColor,size:24,"data-test":"HostHeaderOld-selectableOptions-updatedOptions-Icon"})}))},[p,oe,g,j,B]),ie=o.useCallback(async se=>{try{P(!0),await M(se)}catch(q){E(q,"")}finally{P(!1)}},[E,M]),ge=o.useCallback(async()=>{await ie(D.PreLive)},[ie]),we=o.useCallback(async()=>{await ie(D.PostEvent),Q()},[ie,Q]),ze=o.useCallback(async()=>{W(!1),G(!1),S(!1);let se=D.Cancelled;H&&(se=D.PostEventEnded),await(M==null?void 0:M(se))},[S,H,M]),Ae=o.useCallback(async()=>{A(!1),await m(),i(l?Se.GUEST_HOME:Se.HOME_NOUM)},[m,i,l]),at=o.useCallback(async()=>{F(!1),await we()},[we]),ot=o.useCallback(se=>{switch(se.value){case"start_main_event":ge();break;case"change_room_name":n==null||n();break;case"invite_users":a==null||a();break;case"leave_and_cancel_event":G(!0);break;case"see_event_attendees":t==null||t();break;case"leave_event":A(!0);break;case"copy_the_event_link":navigator.clipboard.writeText(`${window.location}`??"");break}},[ge,n,a,t]);return o.useEffect(()=>{(f==null?void 0:f.status)===D.PreLive&&z/1e3<4&&z/1e3>3&&ae(!0)},[f==null?void 0:f.status,z]),h(Ct,{isRow:p||g,"data-testid":"host_header","data-test":"HostHeaderOld-Wrapper",children:[e(kt,{"data-test":"HostHeaderOld-ToggleBuzzRoomBtn"}),oe&&p&&!(he.length>0||u)&&!(g&&b&&d)?h(_t,{"data-test":"HostHeaderOld-MobileBuzzRoomMiddleWrapper",children:[e(Qe,{"data-test":"HostHeaderOld-EventTag"}),e(Je,{"data-test":"HostHeaderOld-TitleWrapper",children:e(je,{font:"body-xl-bold",isGray:p&&!v&&!g,"data-test":"HostHeaderOld-TitleSpan",children:p&&!g?v||s("noumena.social_hall.add_group_name"):f==null?void 0:f.title})}),!H&&!k&&e(nt,{font:"systemInfo-m",isCountDown:(f==null?void 0:f.status)===D.PreLive||(f==null?void 0:f.status)===D.PostEventEnded,"data-testid":"counter_clock","data-test":"HostHeaderOld-CounterClockSpan",children:y})]}):h(Mt,{isBuzzRoom:p,"data-test":"HostHeaderOld-MiddleWrapper",children:[h(Je,{"data-test":"HostHeaderOld-TitleWrapper",children:[e(Qe,{"data-test":"HostHeaderOld-EventTag"}),e(je,{font:"body-xl-bold",isGray:p&&!v&&!g,"data-test":"HostHeaderOld-TitleSpan",children:p&&!g?v||s("noumena.social_hall.add_group_name"):f==null?void 0:f.title})]}),!H&&!k&&e(nt,{font:"systemInfo-m",isCountDown:(f==null?void 0:f.status)===D.PreLive||(f==null?void 0:f.status)===D.PostEventEnded,"data-testid":"counter_clock","data-test":"HostHeaderOld-CounterClockSpan",children:y})]}),h(it,{isBuzzRoom:p,"data-test":"HostHeaderOld-RightWrapper",children:[(f==null?void 0:f.status)===D.PreEvent&&(!p||p&&Z)&&e(x,{size:oe?"full_small":"small",primary:!0,loading:$,onClick:()=>ge(),leftIcon:e(I,{color:"--icon-button-neutral-alt-default",name:"wave_left_m",size:24,"data-test":"HostHeaderOld-Icon"}),rightIcon:e(I,{color:"--icon-button-neutral-alt-default",name:"wave_right_m",size:24,"data-test":"HostHeaderOld-Icon"}),"data-testid":"start_event_button","data-test":"HostHeaderOld-Button",children:s("noumena.social_hall.start_main_event")}),(w||H)&&p&&e(x,{size:"small",secondary:!0,loading:U,onClick:()=>Q(),leftIcon:e(I,{imageIconName:"leave_quietly",size:24,"data-test":"HostHeaderOld-Icon"}),"data-testid":"leave_quietly_button","data-test":"HostHeaderOld-Button",children:s("noumena.social_hall.leave_quietly")}),Me&&e(x,{size:"small",secondary:!0,loading:$,onClick:()=>F(!0),"data-testid":"finish_main_event","data-test":"HostHeaderOld-Button",children:s("noumena.social_hall.finish_main_event")}),j&&e(x,{size:"full_small",secondary:!0,intent:"negative",loading:$,onClick:()=>W(!0),"data-testid":"end_event","data-test":"HostHeaderOld-Button",children:s("noumena.social_hall.end_event")}),e(jt,{"data-testid":"dropdown_wrapper","data-test":"HostHeaderOld-DropdownWrapper",children:e(Re,{hideIcons:!1,closeOnSelect:!0,placement:"bottom-end",onSelectOption:se=>ot(se),options:ne,containerWidth:"280px",usePortal:!1,calRefTop:!1,isAnimation:!1,usePopStyle:!0,"data-test":"HostHeaderOld-Dropdown",children:({targetRef:se,targetProps:q,toggle:me})=>e(rt,{ref:se,onClick:me,...q,"data-testid":"three_dot_button","data-test":"HostHeaderOld-IconButton",children:e(I,{color:"--icon-button-neutral-default",name:"more_m",size:24,"data-test":"HostHeaderOld-Icon"})})})})]}),e(ce,{isOpen:R,onClose:()=>ae(!1),countDown:!0,remainTime:z,...Jt,"data-test":"HostHeaderOld-EventModal"}),e(ce,{isOpen:N,onClose:()=>G(!1),onConfirm:ze,...Va,"data-test":"HostHeaderOld-EventModal"}),e(ce,{isOpen:C,onClose:()=>F(!1),onConfirm:at,...Vt,"data-test":"HostHeaderOld-EventModal"}),e(ce,{isOpen:Y,onClose:()=>W(!1),onConfirm:ze,...Fa,"data-test":"HostHeaderOld-EventModal"}),e(ce,{isOpen:V,onClose:()=>A(!1),onConfirm:Ae,isConfirmButtonPrimary:!0,...lt,"data-test":"HostHeaderOld-EventModal"})]})},oa=t=>{const{flags:{socialHallVideoCall:a}}=Ee();return a?e(Er,{...t,"data-test":"HostHeader-HostHeaderNew"}):e(wr,{...t,"data-test":"HostHeader-HostHeaderOld"})},na=t=>{const{flags:{socialHallVideoCall:a}}=Ee();return a?e(br,{...t,"data-test":"AttendeeHeader-AttendeeHeaderNew"}):e(kr,{...t,"data-test":"AttendeeHeader-AttendeeHeaderOld"})},yr=({initialNotifications:t})=>{var we,ze,Ae,at,ot,se;const{flags:a}=Ee(),{activeSocialHallGroup:n,socialHallAttendeesAndGroups:l,isGridLayout:s,showBuzzRoom:i,showBrowserSupportBanner:r}=J(),{messages:c,showRaiseHand:d,isCameraEnable:m,localVideoTrack:p,remoteUserVideoFeeds:_,agoraConnectionState:S,screenSharingLocalUserFeed:v,screenSharingRemoteUserFeed:u}=X(),[M]=td(),{user:f}=fe(),[g,H]=o.useState(!1),{activeSpeaker:k}=hs(),B=o.useRef(null),[b,w]=o.useState(!1),[E,y]=o.useState(!1),{hostJoined:z,isMainEvent:L,isEventHost:K,eventDetails:$}=te(),[P,U]=xe(!1),[T,N]=o.useState(),[G,C]=o.useState(9),{isTablet:F,isLaptop:Y,isDesktop:W}=ms(),V=o.useCallback(()=>{C(Y||W?12:F?6:3)},[Y,F,W]),A=o.useMemo(()=>S==="RECONNECTING",[S]),R=o.useCallback(q=>(f==null?void 0:f._id)===q?m?p:null:_==null?void 0:_[q],[p,_,f==null?void 0:f._id,m]),ae=o.useMemo(()=>`screen-sharing-feed_${f==null?void 0:f._id}_${f==null?void 0:f._id}`,[f==null?void 0:f._id]),Z=o.useCallback(q=>{var me;return((me=n==null?void 0:n.invitedAsSpeakers)==null?void 0:me.findIndex(Ke=>{var sa;return((sa=Ke==null?void 0:Ke.invitee)==null?void 0:sa._id)===q}))!==-1},[n]),oe=!!document.fullscreenElement||!!document.webkitFullscreenElement,Q=o.useMemo(()=>{const q=((n==null?void 0:n.users)||[]).filter(me=>!M.includes(me._id));return L?q==null?void 0:q.filter(me=>{var Ke;return(Ke=n==null?void 0:n.speakers)==null?void 0:Ke.includes(me==null?void 0:me._id)}):q},[L,M,n==null?void 0:n.users,n==null?void 0:n.speakers]),Me=Et(l,n),j=o.useCallback(q=>{w(q),H(!1),y(!1)},[]),he=o.useCallback(q=>{y(q),w(!1)},[]),ne=o.useMemo(()=>b&&!Me,[b,Me]),ie=o.useMemo(()=>!!v||!!(u!=null&&u.hasVideo),[v,u]);o.useEffect(()=>{var q;c!=null&&c.length&&((q=c[((c==null?void 0:c.length)??0)-1])==null?void 0:q.uid)!==(f==null?void 0:f._id)&&H(!0)},[c,f==null?void 0:f._id]),o.useEffect(()=>{var q;v&&v.play(ae),u!=null&&u.hasVideo&&((q=u.videoTrack)==null||q.play(ae))},[v,u,ae]);const ge=o.useMemo(()=>{const q=[];return Q==null||Q.forEach(me=>{q.push({id:me._id,element:e(Ft,{isFullScreen:oe,isReconnecting:A,isMinimalView:ne,speakerCarouselPortal:!1,...me,"data-test":"EventRoom-attendeeVideos-MediaPreview"},me._id)})}),q},[Q,ne,A,oe]);return o.useEffect(()=>{L&&P&&U()},[L,U,P]),o.useEffect(()=>{const q=setTimeout(()=>{N(k)},100);return()=>clearTimeout(q)},[k]),o.useEffect(()=>{V()},[V]),h(ee,{children:[e(to,{"data-test":"EventRoom-BrowserSupport"}),h(fs,{isBannerVisible:!!r,"data-testid":"buzzroom_wrapper",showRaiseHand:d,"data-test":"EventRoom-Wrapper",children:[h(gs,{"data-testid":"main_wrapper",isMainEvent:L,"data-test":"EventRoom-MainViewWrapper",children:[K&&($==null?void 0:$._id)&&i&&e(oa,{onChangeGroupName:U,"data-test":"EventRoom-HostHeader"}),!K&&($==null?void 0:$._id)&&i&&e(na,{onChangeGroupName:U,"data-test":"EventRoom-AttendeeHeader"}),e(Ss,{id:"fullScreenElement",isFullScreen:oe,"data-test":"EventRoom-ScrollViewWrapper",children:h(Cs,{isSpeakerView:oe||!s||ie,ref:B,isFullScreen:oe,"data-test":"EventRoom-MainEventUserWrapper",children:[ie&&e(gr,{userFeeds:Q,isFullScreen:oe,fullScreenElemId:"fullScreenElement",screenShareElemId:ae,clientWidth:((we=B.current)==null?void 0:we.clientWidth)??0,clientHeight:((ze=B.current)==null?void 0:ze.clientHeight)??0,showChatPanel:b,showMembersPanel:E,"data-test":"EventRoom-ScreenShare"}),s&&!ie&&e(_s,{gutterSpace:8,videos:ge,maxVideoPerPage:G,clientWidth:((Ae=B.current)==null?void 0:Ae.clientWidth)??0,clientHeight:((at=B.current)==null?void 0:at.clientHeight)??0,showChatPanel:b,showMembersPanel:E,"data-test":"EventRoom-VideoMasonryCarousel"}),(!s||ie)&&e(dr,{speakerFeed:Q==null?void 0:Q.find(q=>T?q._id===T:q._id===Q[0]._id),activeSpeaker:k,userFeeds:Q,isMinimalView:ne,isInvited:Z,videoFeed:R,clientWidth:((ot=B.current)==null?void 0:ot.clientWidth)??0,clientHeight:((se=B.current)==null?void 0:se.clientHeight)??0,showChatPanel:b,showMembersPanel:E,isFullScreen:oe,"data-test":"EventRoom-SpeakerView"})]})}),i&&e(nr,{isReconnecting:A,showMembersPanel:E,isNewMessage:g,showChatPanel:b,onToggleChat:()=>{j(!b),H(!1)},onToggleMember:()=>{he(!E)},"data-test":"EventRoom-ControlPanel"}),h(Ms,{"data-test":"EventRoom-KnockNotificationWrapper",children:[t.map(q=>e(Ye,{notification:q,isSingle:t.length===1,"data-test":"EventRoom-KnockNotification"},q==null?void 0:q._id)),z&&e(Ye,{isSingle:t.length===1,isHostJoined:!0,"data-test":"EventRoom-KnockNotification"})]})]}),a.socialHallMessaging&&e(io,{show:ne,disabled:A,onClose:()=>j(!b),"data-test":"EventRoom-SocialHallChat"}),e(fr,{isInvited:Z,show:E,onlineAttendees:Q,onClose:()=>he(!E),"data-test":"EventRoom-SocialHallMembers"})]}),e(ta,{isOpen:P&&!L,onClose:U,"data-test":"EventRoom-ChangeGroupNameModal"}),L&&e(ro,{"data-test":"EventRoom-ControlGroupMainEventNotification"})]})},Ha=({onShowChat:t,isNewMessage:a,onShowRaiseHands:n})=>{const{flags:l}=Ee(),{isMuted:s,toggleMuteCall:i}=X(),{askHandsUpOnce:r,setAskHandsUpOnce:c,activeSocialHallGroup:d,socialHallAttendeesAndGroups:m}=J(),{showRaiseHand:p,isShareScreen:_,raisedHandUsers:S,onToggleScreenSharing:v,screenSharingRemoteUserFeed:u}=X(),M=Et(m,d),{isPreEvent:f,isPostEvent:g,isMainEvent:H,isEventHost:k,isEventSpeaker:B}=te(),{toggleRaisedHand:b}=St(),{user:w}=fe(),[E,y]=xe(!1),{width:z}=ue(),L=z<le.LAPTOP,K=o.useCallback(()=>{r||c(!0),y(),b(!p,w==null?void 0:w._id)},[r,p,c,y,b,w==null?void 0:w._id]);return e(bs,{"data-testid":"control_wrapper","data-test":"ControllerGroup-ControlWrapper",children:H&&!k&&!B?h(ee,{children:[L&&e(Ve,{cursorAllowed:!0,onClick:t,"data-test":"ControllerGroup-ControlIconWrapper",children:e(I,{name:"message_m",size:24,color:"--icon-button-neutral-default","data-test":"ControllerGroup-Icon"})}),h(ks,{onClick:()=>b(!p,w==null?void 0:w._id),isRaiseHand:p,font:"button-m",colorToken:"--text-button-neutral-default","data-test":"ControllerGroup-RaiseHandWrapper",children:[e(I,{imageIconName:"raise_hand_m",size:24,"data-test":"ControllerGroup-Icon"}),O(p?"noumena.social_hall.hands_up.hand_raised":"noumena.social_hall.hands_up.raise_hand")]})]}):h(ee,{children:[L&&l.socialHallMessaging&&!M&&h(Ve,{cursorAllowed:!0,onClick:t,"data-test":"ControllerGroup-ControlIconWrapper",children:[a&&e(vs,{"data-test":"ControllerGroup-ChatNotificationContainer",children:e(Bs,{"data-test":"ControllerGroup-ChatNotification"})}),e(I,{name:"message_m",size:24,color:"--icon-button-neutral-default","data-test":"ControllerGroup-Icon"})]}),e(Ve,{cursorAllowed:!0,onClick:()=>i(),"data-test":"ControllerGroup-ControlIconWrapper",children:e(I,{name:s?"mic_off_m":"mic_on_m",size:24,color:s?"--icon-button-danger-secondary-default":"--icon-button-neutral-default","data-test":"ControllerGroup-Icon"})}),(H&&(k||B)||f||g)&&e(Ve,{cursorAllowed:!0,onClick:()=>v(),"data-test":"ControllerGroup-ControlIconWrapper",children:e(I,{name:_||u!=null&&u.uid?"share_content_off_m":"share_content_m",size:24,color:"--icon-button-neutral-default","data-test":"ControllerGroup-Icon"})}),!H&&e(Ve,{cursorAllowed:!0,onClick:r?()=>b(!p,w==null?void 0:w._id):y,backgroundColor:p?"var(--bg-button-brand-primary-default)":"var(--bg-button-neutral-alt-default)","data-test":"ControllerGroup-ControlIconWrapper",children:e(I,{imageIconName:"raise_hand_m",size:24,"data-test":"ControllerGroup-Icon"})}),L&&k&&H&&h(Ve,{cursorAllowed:!0,onClick:n,"data-test":"ControllerGroup-ControlIconWrapper",children:[e(I,{name:"raise_hand_2_outline_m",size:24,color:"--icon-button-neutral-default","data-test":"ControllerGroup-Icon"}),S.length>0&&e(Es,{"data-test":"ControllerGroup-BadgeContainer",children:e(ws,{text:`${S.length}`,"data-test":"ControllerGroup-RaiseHandsBadge"})})]}),e(so,{isOpen:E,onClose:y,onConfirm:K,"data-test":"ControllerGroup-HandsUpModal"})]})})},Hr=({userInfo:t})=>{var m;const{onDeclineRaiseHand:a,onAcceptRaiseHand:n}=St(),[l,s]=o.useState(!1),[i,r]=o.useState(!1),c=o.useCallback(async()=>{r(!0),await n(t._id),r(!1)},[n,t._id]),d=o.useCallback(async()=>{s(!0),await a(t._id),s(!1)},[a,t._id]);return h(ys,{"data-test":"SideBarUserItem-ItemWrapper",children:[e(Hs,{"data-testid":"avatar_wrapper","data-test":"SideBarUserItem-AvatarWrapper",children:e(Ce,{url:((m=t==null?void 0:t.profile)==null?void 0:m.profilePicture)||"","data-test":"SideBarUserItem-Avatar"})}),h(Is,{"data-test":"SideBarUserItem-NameWrapper",children:[e(Ts,{colorToken:"--text-tablecell-header-neutral-highlighted",font:"body-l-bold","data-test":"SideBarUserItem-NameSpan",children:Ue(t==null?void 0:t.firstName,t==null?void 0:t.middleName,t==null?void 0:t.lastName)}),e(Ps,{font:"body-m",colorToken:"--text-tablecell-body-neutral-default","data-test":"SideBarUserItem-TitleSpan",children:t.title})]}),h(Ns,{"data-test":"SideBarUserItem-ButtonWrapper",children:[e(x,{"data-testid":"close_button",size:"small",onClick:d,icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"SideBarUserItem-Icon"}),loading:l,"data-test":"SideBarUserItem-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:c,icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"SideBarUserItem-Icon"}),loading:i,"data-test":"SideBarUserItem-Button"})]})]})},Ir=({onClose:t})=>{const{t:a}=pe(),{socialHallAttendeesAndGroups:n}=J(),{raisedHandUsers:l,setRaisedHandUsers:s}=X();o.useEffect(()=>{s([])},[s]);const i=o.useMemo(()=>{var r,c,d,m;return(m=(d=Qt.first((c=(r=n==null?void 0:n.data)==null?void 0:r.socialHallGroups)==null?void 0:c.data))==null?void 0:d.users)==null?void 0:m.filter(p=>l==null?void 0:l.includes(p==null?void 0:p._id))},[l,n]);return h(Ls,{"data-testid":"side_bar_wrapper","data-test":"RaiseHandsSideBar-SideBarWrapper",children:[h(Os,{"data-test":"RaiseHandsSideBar-SideBarHeaderWrapper",children:[e(zs,{colorToken:"--text-appbar-neutral-default",font:"body-l-bold","data-test":"RaiseHandsSideBar-SideBarHeader",children:a("noumena.social_hall.raised_hands")}),e(Ws,{onClick:t,"data-test":"RaiseHandsSideBar-CloseButton",children:e(I,{color:"--icon-card-neutral-highlighted",name:"close_m",size:24,"data-test":"RaiseHandsSideBar-Icon"})})]}),i!=null&&i.length?e(xs,{"data-testid":"list_wrapper","data-test":"RaiseHandsSideBar-ListWrapper",children:i.map(r=>e(Hr,{userInfo:r,"data-test":"RaiseHandsSideBar-SideBarUserItem"},r==null?void 0:r._id))}):h(Us,{"data-test":"RaiseHandsSideBar-EmptyScreenWrapper",children:[e(I,{name:"raise_hand_2_outline_m",size:144,color:"--icon-card-placeholder-neutral-default","data-test":"RaiseHandsSideBar-Icon"}),e(Rs,{colorToken:"--text-placeholder-neutral-default",font:"body-xl","data-test":"RaiseHandsSideBar-EmptyMessageSpan",children:a("noumena.social_hall.no_raise_hand")})]})]})},Tr=({initialNotifications:t})=>{const{flags:a}=Ee(),{t:n}=pe(),{stageAttendees:l,audienceAttendees:s,activeSocialHallGroup:i,socialHallAttendeesAndGroups:r}=J(),{messages:c,mutedUsers:d,showRaiseHand:m,agoraConnectionState:p,screenSharingLocalUserFeed:_,screenSharingRemoteUserFeed:S}=X(),v=o.useMemo(()=>p==="RECONNECTING",[p]),{hostJoined:u,isMainEvent:M,isEventHost:f}=te(),{user:g}=fe(),{width:H}=ue(),k=H<le.LAPTOP,[B,b]=o.useState(!1),[w,E]=o.useState(!1),[y,z]=o.useState(),L=o.useMemo(()=>`screen-sharing-feed_${g==null?void 0:g._id}`,[g==null?void 0:g._id]),K=o.useCallback(C=>{var F;return((F=i==null?void 0:i.invitedAsSpeakers)==null?void 0:F.findIndex(Y=>{var W;return((W=Y==null?void 0:Y.invitee)==null?void 0:W._id)===C}))!==-1},[i]),$=o.useCallback(()=>{const C=document.getElementById("screenShareWrapper");_||(C!=null&&C.requestFullscreen?C.requestFullscreen():C!=null&&C.webkitRequestFullScreen&&C.webkitRequestFullScreen())},[_]),P=o.useCallback(()=>{var C;document.exitFullscreen?document.exitFullscreen():document!=null&&document.webkitExitFullscreen&&((C=document==null?void 0:document.webkitExitFullscreen)==null||C.call(document))},[]),U=!!document.fullscreenElement||!!document.webkitFullscreenElement,T=o.useMemo(()=>i==null?void 0:i.users,[i==null?void 0:i.users]),N=Et(r,i),G=o.useCallback(C=>{E(C),b(!1)},[]);return o.useEffect(()=>{var C;c!=null&&c.length&&((C=c[((c==null?void 0:c.length)??0)-1])==null?void 0:C.uid)!==(g==null?void 0:g._id)&&b(!0)},[c,g==null?void 0:g._id]),o.useEffect(()=>{var C,F,Y;_&&(_.play(L),z(g==null?void 0:g.firstName)),S!=null&&S.hasVideo&&((C=S.videoTrack)==null||C.play(L),z(((Y=(F=i==null?void 0:i.users)==null?void 0:F.filter(W=>(W==null?void 0:W._id)===S.uid)[0])==null?void 0:Y.firstName)||""))},[g==null?void 0:g.firstName,i,_,S,L]),h(ee,{children:[h(As,{"data-testid":"buzzroom_wrapper",showRaiseHand:m,"data-test":"EventRoomOld-Wrapper",children:[M&&f&&(!k||k&&m)?e(Ir,{onClose:()=>{},"data-test":"EventRoomOld-RaiseHandsSideBar"}):k?null:e(ma,{"data-test":"EventRoomOld-TempChatContainer"}),h(Ks,{"data-testid":"main_wrapper",isMainEvent:M,"data-test":"EventRoomOld-MainViewWrapper",children:[h($s,{"data-test":"EventRoomOld-ScrollViewWrapper",children:[h(Gs,{visible:!!(S!=null&&S.hasVideo)||!!_,id:"screenShareWrapper","data-test":"EventRoomOld-ScreenShareWrapper",children:[U?h(Vs,{"data-test":"EventRoomOld-FullScreenWrapper",children:[e(Fs,{onClick:P,"data-test":"EventRoomOld-CloseIconButton",children:e(I,{color:"--icon-button-neutral-default",name:"close_m",size:24,"data-test":"EventRoomOld-Icon"})}),e(Ha,{isNewMessage:B,onShowChat:()=>{b(!1)},onShowRaiseHands:()=>{},"data-test":"EventRoomOld-ControllerGroup"})]}):h(Ds,{font:"body-m",colorToken:"--text-tablecell-body-neutral-default","data-test":"EventRoomOld-ScreenShareTitleSpan",children:[e(qs,{font:"body-m-bold",colorToken:"--text-tablecell-body-neutral-default","data-test":"EventRoomOld-ScreenShareNameSpan",children:y}),n("noumena.social_hall.is_sharing_screen")]}),e(Js,{isFullScreen:U,id:L,onClick:$,"data-test":"EventRoomOld-ScreenSharingElement"})]}),M?h(js,{"data-test":"EventRoomOld-MainEventUserWrapper",children:[e(Xs,{font:"body-m",colorToken:"--text-tablecell-body-neutral-default",screenSharing:!!(S!=null&&S.hasVideo),"data-test":"EventRoomOld-StageHeader",children:n("noumena.social_hall.stage")}),e(fa,{"data-test":"EventRoomOld-StageUserWrapper",children:l==null?void 0:l.map(C=>C!=null&&C._id?e(zt,{isMuted:d.includes(C==null?void 0:C._id),...C,"data-test":"EventRoomOld-AttendeeInCall"},C==null?void 0:C._id):null)}),e(Ys,{font:"body-m-bold",colorToken:"--text-tablecell-body-neutral-default","data-test":"EventRoomOld-AttendeeHeader",children:n("noumena.social_hall.audience")}),e(fa,{"data-test":"EventRoomOld-StageUserWrapper",children:s==null?void 0:s.map(C=>C!=null&&C._id?e(zt,{isAudience:!0,isInvited:K(C==null?void 0:C._id),isMuted:!1,...C,"data-test":"EventRoomOld-AttendeeInCall"},C==null?void 0:C._id):null)})]}):e(Qs,{"data-test":"EventRoomOld-BuzzRoomUsersContainer",children:e(Zs,{"data-test":"EventRoomOld-BuzzRoomUsersWrapper",children:T==null?void 0:T.map(C=>C!=null&&C._id?e(zt,{isMuted:d.includes(C==null?void 0:C._id),...C,"data-test":"EventRoomOld-AttendeeInCall"},C==null?void 0:C._id):null)})})]}),e(el,{"data-test":"EventRoomOld-ControllerWrapper"}),e(Ha,{isNewMessage:B,onShowChat:()=>{G(!0)},onShowRaiseHands:()=>{G(!1)},"data-test":"EventRoomOld-ControllerGroup"}),h(tl,{"data-test":"EventRoomOld-KnockNotificationWrapper",children:[t.map(C=>e(Ye,{notification:C,isSingle:t.length===1,"data-test":"EventRoomOld-KnockNotification"},C==null?void 0:C._id)),u&&e(Ye,{isSingle:t.length===1,isHostJoined:!0,"data-test":"EventRoomOld-KnockNotification"},new Date().getTime())]})]}),(!k||k&&w)&&a.socialHallMessaging&&!N?e(io,{show:!0,disabled:v,onClose:()=>G(!1),"data-test":"EventRoomOld-SocialHallChat"}):k?null:e(ma,{"data-test":"EventRoomOld-TempChatContainer"})]}),M&&e(ro,{"data-test":"EventRoomOld-ControlGroupMainEventNotification"})]})},Pr=t=>{const{flags:{socialHallVideoCall:a}}=Ee();return a?e(yr,{...t,"data-test":"EventRoom-EventRoomComponent"}):e(Tr,{...t,"data-test":"EventRoom-EventRoomOld"})},Wt=({options:t,onSelect:a,disabled:n,children:l,selectedId:s,prefixIcon:i,emptyText:r})=>{const[c,d]=o.useState(!1),m=o.useMemo(()=>`${t.length*50}px`,[t]),p=o.useMemo(()=>c?"chevron_small_up_m":"chevron_small_down_m",[c]),_=o.useMemo(()=>{var u;return(u=t.find(({value:M})=>M===s))==null?void 0:u.label},[t,s]),S=()=>d(!!t.length),v=o.useMemo(()=>t.length?"--icon-input-neutral-default":"--icon-input-neutral-disabled",[t]);return e(Re,{isOpen:c,hideIcons:!0,options:t,usePortal:!0,disabled:n,closeOnSelect:!0,minHeight:m,inputValue:s,observerMinHeight:"1px",onOpen:S,onClose:()=>d(!1),noAvailableOptionsText:r,onSelectOption:u=>a(u.key),"data-test":"MediaDropdown-Dropdown",children:({toggle:u,targetRef:M})=>h(x,{ref:M,size:"full_small",textOnly:!0,onClick:u,"data-test":"MediaDropdown-Button",children:[h(al,{"data-test":"MediaDropdown-DropdownLabelWrapper",children:[h(ol,{"data-test":"MediaDropdown-LabelIconWrapper",children:[e(I,{name:i,size:24,color:"--icon-input-neutral-default","data-test":"MediaDropdown-Icon"}),e(de,{width:8,"data-test":"MediaDropdown-Spacer"}),_?e(re,{overflow:"ellipsis",font:"body-m","data-test":"MediaDropdown-TSpan",children:_}):e(re,{colorToken:"--text-input-neutral-disabled",overflow:"ellipsis",font:"body-m","data-test":"MediaDropdown-TSpan",children:r})]}),e(de,{width:16,"data-test":"MediaDropdown-Spacer"}),e(I,{size:24,color:v,name:p,"data-test":"MediaDropdown-Icon"})]}),l]})})},Nr=({deviceId:t,setTracks:a})=>{const n=o.useRef(null);return o.useLayoutEffect(()=>{let l=null;const s=new AudioContext,i=s.createAnalyser(),r=()=>{l&&(l.mediaStream.getTracks().forEach(d=>d.stop()),l.disconnect(i),l=null)};if(n.current){const d=n.current;navigator.mediaDevices.getUserMedia({audio:{deviceId:t}}).then(M=>{l=s.createMediaStreamSource(M),l&&a(f=>[...f,...l.mediaStream.getTracks()||[]]),l.connect(i)}).catch(M=>{console.error("Failed to get microphone audio:",M)}),i.fftSize=2048;const m=i.frequencyBinCount,p=new Uint8Array(m),_=d.getContext("2d"),S=28,v="#00CA7A",u=()=>{if(!_)return;i.getByteFrequencyData(p),_==null||_.clearRect(0,0,d.width,d.height);const M=d.width*(p[0]/255)*2.5;_.fillStyle=v,_.fillRect(0,d.height/2-S/2,M,S),requestAnimationFrame(u)};u()}return()=>{r()}},[t]),e(nl,{"data-test":"Equalizer-EqualizerWrapper",children:e(sl,{ref:n,"data-test":"Equalizer-EqualizerElement"})})},Lr=({setTracks:t,isMuteAudio:a,allConnectedDevices:n,onVideoDeviceChange:l})=>{const{width:s}=ue(),i=s<le.TABLET,{setDeviceId:r,deviceId:c}=J(),d=o.useCallback(p=>{r({...c,...p})},[r,c]),m=p=>{l(p),d({camera:p})};return h(ll,{"data-test":"AvailableMediaSelection-MediaOptionsWrapper",children:[e(Nt,{"data-test":"AvailableMediaSelection-HardwareControlItem",children:e(Wt,{emptyText:O("noumena.social_hall.hardware_testing_mic_not_found"),prefixIcon:"mic_on_m",options:(n==null?void 0:n.audioDevices)??[],onSelect:p=>d({microphone:p}),selectedId:(c==null?void 0:c.microphone)??"","data-test":"AvailableMediaSelection-MediaDropdown",children:!a&&!i&&e(Nr,{setTracks:t,deviceId:(c==null?void 0:c.microphone)??"","data-test":"AvailableMediaSelection-Equalizer"})})}),e(Nt,{"data-test":"AvailableMediaSelection-HardwareControlItem",children:e(Wt,{emptyText:O("noumena.social_hall.hardware_testing_speaker_not_found"),prefixIcon:"volume_on_m",options:(n==null?void 0:n.speakerDevices)??[],onSelect:p=>d({speaker:p}),selectedId:(c==null?void 0:c.speaker)??"","data-test":"AvailableMediaSelection-MediaDropdown"})}),e(Nt,{"data-test":"AvailableMediaSelection-HardwareControlItem",children:e(Wt,{emptyText:O("noumena.social_hall.hardware_testing_camera_not_found"),prefixIcon:"webcam_on_m",options:(n==null?void 0:n.cameraDevices)??[],onSelect:m,selectedId:(c==null?void 0:c.camera)??"","data-test":"AvailableMediaSelection-MediaDropdown"})})]})},Or=({onCompleted:t,onLeave:a,showLoader:n})=>{const{refetchUserData:l}=fe(),[s,i]=o.useState(!1),[r]=il(),c=async()=>{s&&(await r({variables:{accept:s}}),l()),t()};return h(rl,{"data-test":"MediaContent-MediaMessageWrapper",children:[e(re,{colorToken:"--text-modal-header-neutral-default",font:"heading-s-bold","data-test":"MediaContent-TSpan",children:O("noumena.social_hall.hardware_testing_heading")}),e(de,{height:8,"data-test":"MediaContent-Spacer"}),e(re,{colorToken:"--text-modal-neutral-default",font:"body-l","data-test":"MediaContent-TSpan",children:O("noumena.social_hall.hardware_testing_title")}),e(de,{height:24,"data-test":"MediaContent-Spacer"}),h(dl,{"data-test":"MediaContent-ButtonContainer",children:[e(x,{tertiary:!0,intent:"negative",size:"full",loading:n,onClick:()=>a(),"data-testid":"leave-event-button","data-test":"MediaContent-Button",children:O("noumena.social_hall.hardware_testing_cancel_btn")}),e(de,{width:16,"data-test":"MediaContent-Spacer"}),e(x,{primary:!0,size:"full",loading:n,onClick:c,"data-testid":"join-event-button","data-test":"MediaContent-Button",children:O("noumena.social_hall.hardware_testing_success_btn")})]}),e(de,{height:32,"data-test":"MediaContent-Spacer"}),h(cl,{"data-test":"MediaContent-SkipHardwareTestingWrapper",children:[e(Wa,{onChange:()=>i(!s),isChecked:s,icon:e(I,{name:"tick_m",size:s?24:0,color:"--icon-checkbox-neutral-alt-default","data-test":"MediaContent-Icon"}),"data-test":"MediaContent-Checkbox"}),e(de,{width:8,"data-test":"MediaContent-Spacer"}),e(re,{colorToken:"--text-tablecell-header-neutral-default","data-test":"MediaContent-TSpan",children:O("noumena.social_hall.hardware_testing_skip_future_test")})]})]})},zr=({muteAudio:t,muteVideo:a,isLoading:n,onToggleAudio:l,onToggleVideo:s,hasAudioPermission:i,hasVideoPermission:r})=>h(ul,{"data-test":"MediaControlButton-MediaControlWrapper",children:[e(no,{isError:!i,isMuted:t,onToggle:l,"data-test":"MediaControlButton-MuteControl"}),e(de,{width:16,"data-test":"MediaControlButton-Spacer"}),e(oo,{isLoading:n&&r,isCameraEnable:!a,onToggle:s,isError:!r,"data-test":"MediaControlButton-VideoControl"})]}),Wr=()=>{var a;const{user:t}=fe();return e(pl,{"data-test":"UserProfilePicture-UserProfilePictureWrapper",children:e(Ce,{url:(a=t==null?void 0:t.profile)==null?void 0:a.profilePicture,size:"XL",width:80,height:80,"data-test":"UserProfilePicture-Avatar"})})},xr=(t="default")=>[{type:"value",value:t,key:t,label:O("noumena.social_hall.default_hardware")}],xt=t=>t.map(a=>({type:"value",value:a.deviceId,key:a.deviceId,label:Be.formatDeviceLabel(a.label)})),Ur=(t,a)=>({audioDevices:xt(t.audioDevices),cameraDevices:xt(t.cameraDevices),speakerDevices:hl()?xr(a.speaker):xt(t.speakerDevices)}),Rr="video_element",Ar=()=>{const t=Pe(),a=o.useRef(null),{user:n,onSetAcceptedSkipMediaTesting:l}=fe(),{width:s}=ue(),i=s<le.TABLET,[r,c]=o.useState(),[d,m]=o.useState([]),[p,_]=o.useState(),[S,v]=o.useState(!1),[u,M]=o.useState(!1),{showPermissionPopup:f,onBothMediaBlocked:g,onTogglePopup:H}=Co(),k=o.useRef({}),[B,b]=o.useState(),{deviceId:w,hasAudioPermission:E,hasVideoPermission:y,audioPermissionState:z,videoPermissionState:L,selectDefaultMediaInput:K,showBrowserSupportBanner:$}=J(),{microphone:P,speaker:U,camera:T}=w||{},{setIsCameraEnable:N,setCamUsers:G,onUpdateMuteState:C}=X(),F=async()=>{await Be.askForPermission();const j=await Be.getAllConnectedMedia();b(()=>Ur(j,w||{})),setTimeout(K,500)},Y=o.useCallback(j=>{k.current&&(k.current={...k.current,...j})},[]),W=o.useCallback(()=>{!r||!a.current||(u?a.current.srcObject=null:(a.current.srcObject=r,a.current.play()))},[u,r]),V=o.useCallback(async j=>{var he;if(r&&((he=a.current)==null||he.pause(),c(null)),a.current){const ne=await Be.handleCameraCheck(j);c(ne)}},[r]),A=()=>{E?v(j=>!j):H("audio")},R=()=>{y?r&&M(j=>!j):H("video")},ae=()=>{p==null||p.close(),p==null||p.stop(),Ut(r==null?void 0:r.getTracks()).forEach(j=>j==null?void 0:j.stop()),Ut(d).forEach(j=>j==null?void 0:j.stop()),m([])},Z=async()=>{Q||(ae(),N(!u),u||G([(n==null?void 0:n._id)||""]),C(S,(n==null?void 0:n._id)||""),l(!0))},oe=()=>{Q||(ae(),t(Se.HOME_NOUM))};o.useEffect(()=>{(async()=>{var he;if(P&&((he=k.current)==null?void 0:he.microphone)!==P){Y({microphone:P});const ne=await Be.handleMicrophoneCheck(P);m(ie=>[...ie,ne]),_(ne)}})()},[P,E,Y]),o.useEffect(()=>{var j;U&&((j=k.current)==null?void 0:j.speaker)!==U&&(Y({speaker:U}),Be.handleSpeakerCheck(U))},[U,Y]),o.useLayoutEffect(()=>{var j;T&&!((j=k.current)!=null&&j.camera)&&L==="granted"&&(Y({camera:T}),V(T))},[T,V,L,Y]),o.useEffect(()=>{W()},[u,r]),o.useEffect(()=>(F(),()=>{ae()}),[L,z]),So(F),o.useEffect(()=>{!E&&!y&&g()},[E,y]);const Q=o.useMemo(()=>!!(E&&!p&&y&&!r),[E,y,p,r]),Me=()=>e(zr,{isLoading:!r,muteAudio:S,muteVideo:u,hasAudioPermission:!!E,hasVideoPermission:!!y,onToggleAudio:A,onToggleVideo:R,"data-test":"InitialSettings-MediaControlResponsiveBtn-MediaControlButton"});return h(ml,{"data-test":"InitialSettings-Layout",children:[e(Xt,{"data-test":"InitialSettings-Header",children:e(Yt,{avatar:ye.getProfilePicture(n)||void 0,userName:(n==null?void 0:n.firstName)||void 0,"data-test":"InitialSettings-MainHeader"})}),h(fl,{isBannerVisible:$,"data-test":"InitialSettings-Wrapper",children:[e(gl,{"data-test":"InitialSettings-BannerWrapper",children:e(to,{"data-test":"InitialSettings-BrowserSupport"})}),h(Sl,{"data-test":"InitialSettings-MediaWrapper",children:[h(Cl,{"data-test":"InitialSettings-VideoWrapper",children:[e(Wr,{"data-test":"InitialSettings-UserProfilePicture"}),e(_l,{ref:a,id:Rr,"data-test":"InitialSettings-VideoElement"}),!i&&e(Me,{"data-test":"InitialSettings-MediaControlResponsiveBtn"})]}),i&&e(Me,{"data-test":"InitialSettings-MediaControlResponsiveBtn"}),e(Lr,{setTracks:m,isMuteAudio:S,isMuteVideo:u,onVideoDeviceChange:V,allConnectedDevices:B,"data-test":"InitialSettings-AvailableMediaSelection"})]}),e(de,{width:48,"data-test":"InitialSettings-Spacer"}),e(Or,{showLoader:Q,onCompleted:Z,onLeave:oe,"data-test":"InitialSettings-MediaContent"}),e(lo,{onTogglePopup:H,showAudioModal:f.audio,showVideoModal:f.video,"data-test":"InitialSettings-MediaPermissionNotification"})]})]})},Kr=({isCloseLoading:t,isLeaveLoading:a,isMuteLoading:n})=>{const{setShowBuzzRoom:l,activeSocialHallGroup:s}=J(),{groupName:i}=te(),{isMuted:r,onLeaveCall:c,toggleMuteCall:d}=X(),m=o.useMemo(()=>r?"mic_off_m":"mic_on_m",[r]),p=o.useMemo(()=>{var _;return(_=s==null?void 0:s.users)==null?void 0:_.map(S=>{var v;return((v=S==null?void 0:S.profile)==null?void 0:v.profilePicture)||""})},[s==null?void 0:s.users]);return h(Ml,{"data-testid":"player_wrapper","data-test":"MiniPlayer-Wrapper",children:[e(Gt,{urls:p||[],borderedImage:!0,size:"XXL","data-test":"MiniPlayer-InlineAvatar"}),e(bl,{colorToken:"--text-card-neutral-highlighted","data-test":"MiniPlayer-GroupTitleSpan",children:(s==null?void 0:s.name)||i}),h(kl,{"data-test":"MiniPlayer-IconButtonWrapper",children:[e(x,{"data-testid":"button_mute",onClick:()=>d(),size:"small",icon:e(I,{name:m,size:24,color:"--icon-button-neutral-default","data-test":"MiniPlayer-Icon"}),loading:n,"data-test":"MiniPlayer-Button"}),e(x,{"data-testid":"button_leave",onClick:c,size:"small",icon:e(I,{imageIconName:"leave_quietly",size:24,"data-test":"MiniPlayer-Icon"}),loading:a,"data-test":"MiniPlayer-Button"},new Date().getTime()),e(x,{"data-testid":"button_close",onClick:()=>{l(!0)},size:"small",icon:e(I,{name:"chevron_small_up_m",size:24,color:"--icon-button-neutral-default","data-test":"MiniPlayer-Icon"}),loading:t,"data-test":"MiniPlayer-Button"})]})]})};var dt=(t=>(t.knock="KNOCK",t.decline="DECLINE",t))(dt||{});const vt=({isOpen:t,onClose:a,modalType:n})=>{const{t:l}=pe(),[s,i]=o.useState(),[r,c]=o.useState(""),[d,m]=o.useState(ga),{setMessages:p}=X(),_=o.useCallback(v=>{i(v),c(""),v!==3&&c(d[v].description)},[d]),S=o.useCallback(()=>{p([]),a(r)},[r,a,p]);return o.useEffect(()=>{m(n==="KNOCK"?ga:vl)},[n]),h(Le,{open:t,onClose:()=>a(null),testId:"knock-message-select-modal",enableCloseButton:!0,size:Ze.L,disableBackdropClick:!0,"data-test":"KnockMessageSelectModal-Modal",children:[e(Te,{"data-test":"KnockMessageSelectModal-ModalHeader",children:l(n==="KNOCK"?"noumena.social_hall.knock_modal.title":"noumena.social_hall.decline_modal.title")}),e(Oe,{"data-test":"KnockMessageSelectModal-ModalBody",children:d.map((v,u)=>h(Bl,{isLast:d.length-1===u,onClick:()=>_(v.key),"data-test":"KnockMessageSelectModal-Description",children:[e(Za,{icon:v.key===s?e(I,{name:"radio_btn_m",size:12,color:"--icon-radiobutton-brand-primary-default","data-test":"KnockMessageSelectModal-Icon"}):void 0,isChecked:v.key===s,"data-test":"KnockMessageSelectModal-Radiobox"}),v.key===s&&v.key===3?e(Na,{label:v.description,onChange:M=>c(M.target.value),maxLength:500,hideLengthHelperText:!0,"data-test":"KnockMessageSelectModal-TextField"}):e(El,{font:"body-l",colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"KnockMessageSelectModal-DescriptionSpan",children:v.description})]},v.key))}),e(de,{height:16,"data-test":"KnockMessageSelectModal-Spacer"}),h(et,{gap:16,flexDirection:"row",marginTop:12,"data-test":"KnockMessageSelectModal-ModalFooter",children:[e(x,{tertiary:!0,size:"full",onClick:()=>a(null),"data-testid":"cancel-button","data-test":"KnockMessageSelectModal-Button",children:l(n==="KNOCK"?"noumena.cancel":"noumena.close")}),e(x,{primary:!0,size:"full",onClick:S,"data-testid":"knock-button","data-test":"KnockMessageSelectModal-Button",children:l(n==="KNOCK"?"noumena.social_hall.knock":"noumena.chamber.decline_button")})]})]})},$r=({groupId:t,showGroupPopup:a,onCloseGroupPopup:n})=>{var G,C,F,Y;const{t:l}=pe(),{socialHallAttendeesAndGroups:s,socialHallAttendee:i,userActiveGroupData:r}=J(),{onLeaveCall:c}=X(),{isEventHost:d}=te(),{knockUser:m,declineKnock:p,acceptKnock:_,knockLoading:S,declineLoading:v,acceptLoading:u}=ct(),[M,f]=o.useState(!1),[g,H]=o.useState(!1),k=o.useMemo(()=>{var V,A;const W=(A=(V=s==null?void 0:s.data)==null?void 0:V.socialHallGroups)==null?void 0:A.data;return W==null?void 0:W.filter(R=>(R==null?void 0:R._id)===t)[0]},[s,t]),{userOwnKnocks:B,userActiveKnocks:b}=Ne(),w=o.useMemo(()=>[...(B==null?void 0:B.data)??[],...(b==null?void 0:b.data)??[]],[B==null?void 0:B.data,b==null?void 0:b.data]),{knock:E,status:y}=o.useMemo(()=>{var W;return Ie.getGroupKnockDetails(w,(W=i==null?void 0:i.attendeeId)==null?void 0:W._id)},[w,i]),z=o.useMemo(()=>{var W,V;return!!((V=(W=r==null?void 0:r.data)==null?void 0:W.userActiveSocialHallGroup)!=null&&V._id)},[(C=(G=r==null?void 0:r.data)==null?void 0:G.userActiveSocialHallGroup)==null?void 0:C._id]),L=o.useCallback(()=>{z?H(!0):f(!0)},[z]),K=o.useCallback(()=>{var W;return Ie.isUserInGroupCall(((W=i==null?void 0:i.attendeeId)==null?void 0:W._id)??"",(k==null?void 0:k.users)??[])},[i,k]),$=o.useCallback(()=>{H(!1)},[]),P=o.useCallback(async()=>{await c(),H(!1),f(!0)},[c]),U=o.useCallback(W=>{W!==null&&m(null,k==null?void 0:k._id,W),f(!1)},[k,m]),T=o.useMemo(()=>y===be.Normal?e(x,{"data-testid":"join_button",primary:!0,size:"small",onClick:L,loading:S,"data-test":"GroupProfilePopup-KnockButton-Button",children:l(d?"noumena.social_hall.knock":"noumena.social_hall.join")}):y===be.IsKnocked?h(ee,{children:[e(x,{"data-testid":"close_button",size:"small",onClick:()=>p(E==null?void 0:E._id),icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"GroupProfilePopup-KnockButton-Icon"}),loading:v,"data-test":"GroupProfilePopup-KnockButton-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:()=>_(E==null?void 0:E._id),icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"GroupProfilePopup-KnockButton-Icon"}),loading:u,"data-test":"GroupProfilePopup-KnockButton-Button"})]}):y===be.IsKnocking?e(x,{size:"small",disabled:!0,"data-test":"GroupProfilePopup-KnockButton-Button",children:l("noumena.social_hall.knocking")}):null,[l,E,y,d,_,L,p,S,u,v]),N=o.useMemo(()=>(k==null?void 0:k.name)||(k==null?void 0:k.channelName),[k]);return h(ja,{"data-testid":"item_wrapper",isHidden:!a,"data-test":"GroupProfilePopup-ItemWrapper",children:[h(Xa,{"data-test":"GroupProfilePopup-ItemHeader",children:[h(Rt,{"data-test":"GroupProfilePopup-NameWrapper",children:[e(At,{colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"GroupProfilePopup-NameSpan",children:N}),e(Kt,{colorToken:"--text-tablecell-body-neutral-default","data-testid":"members_count","data-test":"GroupProfilePopup-TitleSpan",children:l("noumena.social_hall.members",{memberCount:(F=k==null?void 0:k.users)==null?void 0:F.length})})]}),!K()&&T,e(x,{size:"small",icon:e(I,{color:"--icon-button-neutral-default",name:"close_m",size:24,"data-test":"GroupProfilePopup-Icon"}),onClick:n,"data-test":"GroupProfilePopup-Button"})]}),e(wl,{"data-test":"GroupProfilePopup-UsersWrapper",children:(Y=k==null?void 0:k.users)==null?void 0:Y.map(W=>{var V;return h(yl,{onClick:()=>ye.goToUserProfile(W),"data-test":"GroupProfilePopup-UserWrapper",children:[e(Ya,{"data-test":"GroupProfilePopup-AvatarWrapper",children:e(Ce,{url:((V=W==null?void 0:W.profile)==null?void 0:V.profilePicture)||"",size:"M","data-test":"GroupProfilePopup-Avatar"})}),h(Rt,{"data-test":"GroupProfilePopup-NameWrapper",children:[e(At,{colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"GroupProfilePopup-NameSpan",children:Ue(W==null?void 0:W.firstName,W==null?void 0:W.middleName,W==null?void 0:W.lastName)}),e(Kt,{colorToken:"--text-tablecell-body-neutral-default","data-test":"GroupProfilePopup-TitleSpan",children:W==null?void 0:W.title})]}),e(x,{size:"small",icon:e(I,{name:"chevron_small_right_m",size:24,color:"--icon-tablecell-neutral-default","data-test":"GroupProfilePopup-Icon"}),"data-test":"GroupProfilePopup-Button"})]},W==null?void 0:W._id)})}),e(vt,{isOpen:M,onClose:U,modalType:dt.knock,"data-test":"GroupProfilePopup-KnockMessageSelectModal"}),e(ce,{isConfirmButtonPrimary:!0,isOpen:g,onClose:P,onConfirm:$,...bt,"data-test":"GroupProfilePopup-EventModal"})]})},Gr=({showUserPopup:t,attendeeId:a,onCloseUserPopup:n})=>{var T,N,G,C,F,Y,W,V;const{t:l}=pe(),[s,i]=o.useState(!1),[r,c]=o.useState(!1),{knockUser:d,acceptKnock:m,declineKnock:p,knockLoading:_,acceptLoading:S,declineLoading:v}=ct(),{userOwnKnocks:u,userActiveKnocks:M}=Ne(),{onLeaveCall:f}=X(),{socialHallAttendeesAndGroups:g,socialHallAttendee:H,userActiveGroupData:k}=J(),B=o.useMemo(()=>[...(u==null?void 0:u.data)??[],...(M==null?void 0:M.data)??[]],[u==null?void 0:u.data,M==null?void 0:M.data]),b=o.useMemo(()=>{var R,ae;const A=(ae=(R=g==null?void 0:g.data)==null?void 0:R.socialHallAttendee)==null?void 0:ae.data;return A==null?void 0:A.filter(Z=>{var oe;return((oe=Z==null?void 0:Z.attendeeId)==null?void 0:oe._id)===a})[0]},[g,a]),{knock:w,status:E}=o.useMemo(()=>{var A;return Ie.getKnockDetails(B,(A=b==null?void 0:b.attendeeId)==null?void 0:A._id)},[B,b]),y=o.useMemo(()=>{var A,R;return!!((R=(A=k==null?void 0:k.data)==null?void 0:A.userActiveSocialHallGroup)!=null&&R._id)},[(N=(T=k==null?void 0:k.data)==null?void 0:T.userActiveSocialHallGroup)==null?void 0:N._id]),z=o.useCallback(()=>{y?c(!0):i(!0)},[y]),L=o.useCallback(A=>{A!==null&&d(b==null?void 0:b._id,b==null?void 0:b.hallGroupId,A),i(!1)},[d,b]),K=o.useCallback(A=>((A==null?void 0:A.length)>3?A==null?void 0:A.slice(0,3):A)||[],[]),$=o.useCallback(()=>{c(!1)},[]),P=o.useCallback(async()=>{await f(),c(!1),i(!0)},[f]),U=o.useMemo(()=>E===be.Normal?e(x,{secondary:!0,size:"small",loading:_,onClick:z,"data-testid":"knock_button","data-test":"UserProfilePopup-KnockButton-Button",children:l("noumena.social_hall.knock")}):E===be.IsKnocked?h(ee,{children:[e(x,{"data-testid":"close_button",size:"small",onClick:()=>p(w==null?void 0:w._id),icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"UserProfilePopup-KnockButton-Icon"}),loading:v,"data-test":"UserProfilePopup-KnockButton-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:()=>m(w==null?void 0:w._id),icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"UserProfilePopup-KnockButton-Icon"}),loading:S,"data-test":"UserProfilePopup-KnockButton-Button"})]}):E===be.IsKnocking?e(x,{size:"small",disabled:!0,"data-test":"UserProfilePopup-KnockButton-Button",children:l("noumena.social_hall.knocking")}):e(x,{secondary:!0,size:"small","data-test":"UserProfilePopup-KnockButton-Button",children:l("noumena.social_hall.knock")}),[l,w,E,z,m,p,_,S,v]);return o.useEffect(()=>{b||n()},[b,n]),h(ja,{"data-testid":"item_wrapper",isHidden:!t,"data-test":"UserProfilePopup-ItemWrapper",children:[h(Xa,{"data-test":"UserProfilePopup-ItemHeader",children:[e(Ya,{"data-testid":"avatar_wrapper","data-test":"UserProfilePopup-AvatarWrapper",children:e(Ce,{url:ye.getProfilePicture(b==null?void 0:b.attendeeId)??"","data-test":"UserProfilePopup-Avatar"})}),h(Rt,{"data-test":"UserProfilePopup-NameWrapper",children:[e(At,{colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"UserProfilePopup-NameSpan",children:Ue((G=b==null?void 0:b.attendeeId)==null?void 0:G.firstName,(C=b==null?void 0:b.attendeeId)==null?void 0:C.middleName,(F=b==null?void 0:b.attendeeId)==null?void 0:F.lastName)}),e(Kt,{colorToken:"--text-tablecell-body-neutral-default","data-test":"UserProfilePopup-TitleSpan",children:(Y=b==null?void 0:b.attendeeId)==null?void 0:Y.title})]}),(H==null?void 0:H._id)!==(b==null?void 0:b._id)&&e(Hl,{"data-test":"UserProfilePopup-ButtonWrapper",children:U}),e(x,{size:"small",icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"UserProfilePopup-Icon"}),onClick:n,"data-test":"UserProfilePopup-Button"})]}),e(Il,{"data-test":"UserProfilePopup-TagWrapper",children:K((W=b==null?void 0:b.attendeeId)==null?void 0:W.skills).map(A=>e(Tl,{colorToken:"--text-skillbadge-neutral-default","data-test":"UserProfilePopup-TagSpan",children:A==null?void 0:A.name},A==null?void 0:A._id))}),e(Pl,{colorToken:"--text-card-neutral-default","data-test":"UserProfilePopup-BioSpan",children:(V=b==null?void 0:b.attendeeId)==null?void 0:V.bio}),e(Nl,{colorToken:"--text-card-neutral-default",onClick:()=>{var A,R;return window.open(`/noum/${(R=(A=b==null?void 0:b.attendeeId)==null?void 0:A.chamber)==null?void 0:R._id}`,"_blank")},"data-test":"UserProfilePopup-ProfileLinkSpan",children:l("noumena.social_hall.see_full_profile")}),e(vt,{isOpen:s,onClose:L,modalType:dt.knock,"data-test":"UserProfilePopup-KnockMessageSelectModal"}),e(ce,{isConfirmButtonPrimary:!0,isOpen:r,onClose:P,onConfirm:$,...bt,"data-test":"UserProfilePopup-EventModal"})]})},Vr=({initialNotifications:t,showMiniPlayerNotification:a,...n})=>{const{activeSocialHallGroup:l,showBuzzRoom:s}=J(),{hostJoined:i}=te(),r=o.useMemo(()=>!!(l!=null&&l._id)&&!s,[l,s]);return h(Ll,{"data-testid":"main_wrapper","data-test":"MiniPlayerAndNotification-Wrapper",children:[a&&h(Ol,{isVisible:(t==null?void 0:t.length)>0||!!r,isSingle:(t==null?void 0:t.length)===1&&!r,"data-test":"MiniPlayerAndNotification-MiniAndNotificationWrapper",children:[!s&&t.map(c=>e(Ye,{notification:c,isSingle:t.length===1&&!r,"data-test":"MiniPlayerAndNotification-KnockNotification"},c==null?void 0:c._id)),i&&r&&e(Ye,{isSingle:t.length===1&&!r,isHostJoined:!0,"data-test":"MiniPlayerAndNotification-KnockNotification"},new Date().getTime()),r&&e(Kr,{...n,"data-test":"MiniPlayerAndNotification-MiniPlayer"})]}),e(Gr,{...n,"data-test":"MiniPlayerAndNotification-UserProfilePopup"}),e($r,{...n,"data-test":"MiniPlayerAndNotification-GroupProfilePopup"})]})},Fr=({userInfo:t,showKnockBtn:a=!0,isUserOnCall:n})=>{var T,N,G,C,F,Y,W;const{t:l}=pe(),[s,i]=o.useState(!1),[r,c]=o.useState(!1),[d,m]=o.useState(!1),{onLeaveCall:p,setMessages:_}=X(),{knockUser:S,acceptKnock:v,declineKnock:u,knockLoading:M,acceptLoading:f,declineLoading:g}=ct(),{userOwnKnocks:H,userActiveKnocks:k}=Ne(),B=o.useMemo(()=>[...(H==null?void 0:H.data)??[],...(k==null?void 0:k.data)??[]],[H==null?void 0:H.data,k==null?void 0:k.data]),{knock:b,status:w}=o.useMemo(()=>{var V;return Ie.getKnockDetails(B,(V=t.attendeeId)==null?void 0:V._id)},[B,t]),E=o.useCallback(V=>{V!==null&&S(t._id,t.hallGroupId,V),c(!1)},[t,S]),y=o.useCallback(V=>((V==null?void 0:V.length)>3?V==null?void 0:V.slice(0,3):V)||[],[]),z=o.useCallback(()=>{n?m(!0):c(!0)},[n]),L=o.useCallback(()=>{m(!1)},[]),K=o.useCallback(async()=>{await p(),m(!1),c(!0)},[p]),$=o.useMemo(()=>w===be.Normal?e(x,{onClick:z,primary:s,secondary:!s,size:"small",loading:M,"data-test":"SideBarUserListItem-KnockButton-Button",children:l("noumena.social_hall.knock")}):w===be.IsKnocked?h(ee,{children:[e(x,{"data-testid":"close_button",size:"small",onClick:()=>u(b==null?void 0:b._id),icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"SideBarUserListItem-KnockButton-Icon"}),loading:g,"data-test":"SideBarUserListItem-KnockButton-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:()=>{v(b==null?void 0:b._id),_([])},icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"SideBarUserListItem-KnockButton-Icon"}),loading:f,"data-test":"SideBarUserListItem-KnockButton-Button"})]}):w===be.IsKnocking?e(x,{size:"small",disabled:!0,"data-test":"SideBarUserListItem-KnockButton-Button",children:l("noumena.social_hall.knocking")}):e(x,{secondary:!0,size:"small","data-test":"SideBarUserListItem-KnockButton-Button",children:l("noumena.social_hall.knock")}),[v,f,u,g,z,s,b==null?void 0:b._id,M,_,w,l]),P=o.useMemo(()=>{var V,A,R;return Ue((V=t.attendeeId)==null?void 0:V.firstName,(A=t.attendeeId)==null?void 0:A.middleName,(R=t.attendeeId)==null?void 0:R.lastName)},[t.attendeeId]),U=o.useMemo(()=>{var V;return((V=t.attendeeId)==null?void 0:V.userStatus)==="UNREGISTERED"},[(T=t.attendeeId)==null?void 0:T.userStatus]);return h(zl,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),"data-testid":"item_wrapper","data-test":"SideBarUserListItem-ItemWrapper",children:[h(Wl,{"data-test":"SideBarUserListItem-ItemHeader",children:[e(xl,{"data-testid":"avatar_wrapper","data-test":"SideBarUserListItem-AvatarWrapper",children:e(Ce,{url:((G=(N=t==null?void 0:t.attendeeId)==null?void 0:N.profile)==null?void 0:G.profilePicture)||"","data-test":"SideBarUserListItem-Avatar"})}),h(Ul,{"data-test":"SideBarUserListItem-NameWrapper",children:[h(Rl,{colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"SideBarUserListItem-NameSpan",children:[t.isHost&&e(I,{name:"star_s",size:12,color:"--icon-call-ui-neutral-default","data-test":"SideBarUserListItem-Icon"}),P]}),e(Al,{colorToken:"--text-tablecell-body-neutral-default","data-test":"SideBarUserListItem-TitleSpan",children:U?l("noumena.event.event_non_noumena_attendee"):(C=t.attendeeId)==null?void 0:C.title})]}),a&&e(Kl,{"data-test":"SideBarUserListItem-ButtonWrapper",children:$})]}),e($l,{"data-test":"SideBarUserListItem-TagWrapper",children:y((F=t==null?void 0:t.attendeeId)==null?void 0:F.skills).map(V=>e(Gl,{colorToken:"--text-skillbadge-neutral-default",isFocused:s,"data-test":"SideBarUserListItem-TagSpan",children:V==null?void 0:V.name},V==null?void 0:V._id))}),((Y=t.attendeeId)==null?void 0:Y.bio)&&e(Vl,{colorToken:"--text-card-neutral-default","data-test":"SideBarUserListItem-BioSpan",children:(W=t.attendeeId)==null?void 0:W.bio}),e(Fl,{colorToken:"--text-card-neutral-default",onClick:()=>{var V,A;return window.open(`/noum/${(A=(V=t.attendeeId)==null?void 0:V.chamber)==null?void 0:A._id}`,"_blank")},"data-test":"SideBarUserListItem-ProfileLinkSpan",children:l("noumena.social_hall.see_full_profile")}),e(vt,{isOpen:r,onClose:E,modalType:dt.knock,"data-test":"SideBarUserListItem-KnockMessageSelectModal"}),e(ce,{isConfirmButtonPrimary:!0,isOpen:d,onClose:K,onConfirm:L,...bt,"data-test":"SideBarUserListItem-EventModal"})]})},Dr=({groupInfo:t,isUserOnCall:a})=>{var U,T;const{t:n}=pe(),{knockUser:l,declineKnock:s,acceptKnock:i,joinGroupAsHost:r,knockLoading:c,declineLoading:d,acceptLoading:m,joiningGroupAsHost:p}=ct(),[_,S]=o.useState(!1),[v,u]=o.useState(!1),{isEventHost:M}=te(),{socialHallAttendee:f}=J(),{onLeaveCall:g}=X(),{userOwnKnocks:H,userActiveKnocks:k}=Ne(),B=o.useMemo(()=>[...(H==null?void 0:H.data)??[],...(k==null?void 0:k.data)??[]],[H==null?void 0:H.data,k==null?void 0:k.data]),{knock:b,status:w}=o.useMemo(()=>{var N;return Ie.getGroupKnockDetails(B,(N=f==null?void 0:f.attendeeId)==null?void 0:N._id)},[B,f]),E=o.useCallback(()=>{u(!1)},[]),y=o.useCallback(async()=>{await g,u(!1),S(!0)},[g]),z=o.useCallback(()=>{var N;return Ie.isUserInGroupCall(((N=f==null?void 0:f.attendeeId)==null?void 0:N._id)??"",t.users??[])},[f,t]),L=o.useCallback(N=>{N!==null&&l(null,t._id,N),S(!1)},[t._id,l]),K=o.useCallback(async()=>{a?u(!0):M?(await g(),await r(t._id)):S(!0)},[t._id,M,r,g,a]),$=o.useMemo(()=>w===be.Normal?e(x,{"data-testid":"join_button",onClick:K,primary:!0,size:"small",loading:c||p,"data-test":"SideBarGroupListItem-KnockButton-Button",children:n(M?"noumena.social_hall.join":"noumena.social_hall.knock")}):w===be.IsKnocked?h(ee,{children:[e(x,{"data-testid":"close_button",size:"small",onClick:()=>s(b==null?void 0:b._id),icon:e(I,{name:"close_m",size:24,color:"--icon-button-neutral-default","data-test":"SideBarGroupListItem-KnockButton-Icon"}),loading:d,"data-test":"SideBarGroupListItem-KnockButton-Button"}),e(x,{"data-testid":"accept_button",primary:!0,size:"small",onClick:()=>i(b==null?void 0:b._id),icon:e(I,{name:"tick_m",size:24,color:"--icon-button-neutral-alt-default","data-test":"SideBarGroupListItem-KnockButton-Icon"}),loading:m,"data-test":"SideBarGroupListItem-KnockButton-Button"})]}):w===be.IsKnocking?e(x,{size:"small",disabled:!0,"data-test":"SideBarGroupListItem-KnockButton-Button",children:n("noumena.social_hall.knocking")}):null,[w,K,c,p,n,M,d,m,s,b==null?void 0:b._id,i]),P=o.useMemo(()=>t.name||t.channelName,[t]);return h(Dl,{"data-testid":"item_wrapper","data-test":"SideBarGroupListItem-ItemWrapper",children:[h(ql,{"data-test":"SideBarGroupListItem-ItemHeader",children:[h(Sa,{"data-test":"SideBarGroupListItem-NameWrapper",children:[e(Ca,{colorToken:"--text-tablecell-header-neutral-highlighted",isGroup:!0,"data-test":"SideBarGroupListItem-NameSpan",children:P}),e(_a,{colorToken:"--text-tablecell-body-neutral-default","data-testid":"members_count","data-test":"SideBarGroupListItem-TitleSpan",children:n("noumena.social_hall.members",{memberCount:(U=t.users)==null?void 0:U.length})})]}),!z()&&$]}),e(Jl,{"data-test":"SideBarGroupListItem-UsersWrapper",children:(T=t.users)==null?void 0:T.map(N=>{var G,C;return h(jl,{onClick:()=>ye.goToUserProfile(N),"data-test":"SideBarGroupListItem-UserWrapper",children:[e(Xl,{"data-test":"SideBarGroupListItem-AvatarWrapper",children:e(Ce,{url:((G=N==null?void 0:N.profile)==null?void 0:G.profilePicture)||"",size:"M","data-test":"SideBarGroupListItem-Avatar"})}),h(Sa,{"data-test":"SideBarGroupListItem-NameWrapper",children:[h(Ca,{colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"SideBarGroupListItem-NameSpan",children:[((C=t.hosts)==null?void 0:C.includes(N==null?void 0:N._id))&&e(I,{color:"--icon-call-ui-neutral-default",name:"star_s",size:12,"data-test":"SideBarGroupListItem-Icon"}),Ue(N==null?void 0:N.firstName,N==null?void 0:N.middleName,N==null?void 0:N.lastName)]}),e(_a,{colorToken:"--text-tablecell-body-neutral-default","data-test":"SideBarGroupListItem-TitleSpan",children:N==null?void 0:N.title})]}),e(Yl,{"data-test":"SideBarGroupListItem-IconButton",children:e(I,{name:"chevron_small_right_m",size:24,color:"--icon-tablecell-neutral-default","data-test":"SideBarGroupListItem-Icon"})})]},N==null?void 0:N._id)})}),e(vt,{isOpen:_,onClose:L,modalType:dt.knock,"data-test":"SideBarGroupListItem-KnockMessageSelectModal"}),e(ce,{isConfirmButtonPrimary:!0,isOpen:v,onClose:y,onConfirm:E,...bt,"data-test":"SideBarGroupListItem-EventModal"})]})},gt=()=>{var S,v;const{t}=pe(),{socialHallAttendee:a,socialHallAttendeesAndGroups:n,userActiveGroupData:l}=J(),{width:s}=ue(),i=s<=le.MOBILE_L,[r,c]=o.useState("0"),d=o.useCallback(u=>{c(u)},[]),{attendees:m,groups:p}=o.useMemo(()=>{var u,M,f,g;return{attendees:(M=(u=n==null?void 0:n.data)==null?void 0:u.socialHallAttendee)==null?void 0:M.data,groups:(g=(f=n==null?void 0:n.data)==null?void 0:f.socialHallGroups)==null?void 0:g.data}},[n]),_=o.useMemo(()=>{var u,M;return!!((M=(u=l==null?void 0:l.data)==null?void 0:u.userActiveSocialHallGroup)!=null&&M._id)},[(v=(S=l==null?void 0:l.data)==null?void 0:S.userActiveSocialHallGroup)==null?void 0:v._id]);return h(Ql,{"data-testid":"side_bar_wrapper","data-test":"SideBar-SideBarWrapper",children:[e(Zl,{"data-testid":"tabs_wrapper","data-test":"SideBar-TabsWrapper",children:e(ei,{inputList:ti,onChange:u=>d(u),selectedId:r,isWithoutImage:!0,mode:"isUnderline",tabWidth:i?"":"148px",fullWidth:i,"data-test":"SideBar-BasicChipsTabsForm"})}),e(ai,{"data-testid":"list_wrapper","data-test":"SideBar-ListWrapper",children:r==="0"?m&&m.length>0?m.map(u=>e(Fr,{userInfo:u,showKnockBtn:(u==null?void 0:u._id)!==(a==null?void 0:a._id),isUserOnCall:_,"data-test":"SideBar-SideBarUserListItem"},u==null?void 0:u._id)):e(Ma,{"data-test":"SideBar-EmptyWrapper",children:e(ba,{colorToken:"--text-placeholder-neutral-default","data-test":"SideBar-EmptyMessageSpan",children:t("noumena.social_hall.empty_user")})}):p&&p.length>0?p.map(u=>e(Dr,{groupInfo:u,"data-test":"SideBar-SideBarGroupListItem"},u==null?void 0:u._id)):e(Ma,{"data-test":"SideBar-EmptyWrapper",children:e(ba,{colorToken:"--text-placeholder-neutral-default","data-test":"SideBar-EmptyMessageSpan",children:t("noumena.social_hall.empty_group")})})})]})},qr=()=>{const t=Pe(),a=()=>t(Se.HOME_NOUM);return e(oi,{"data-test":"UserInitialization-Wrapper",children:h(ni,{"data-test":"UserInitialization-Container",children:[e(si,{"data-test":"UserInitialization-Loader",children:e(tt,{"data-test":"UserInitialization-Spinner"})}),e(de,{height:32,"data-test":"UserInitialization-Spacer"}),e(re,{font:"heading-s","data-test":"UserInitialization-TSpan",children:O("noumena.social_hall.joining_the_event")}),e(de,{height:8,"data-test":"UserInitialization-Spacer"}),e(re,{font:"body-l",colorToken:"--text-modal-neutral-default","data-test":"UserInitialization-TSpan",children:O("noumena.social_hall.joining_the_event_title")}),e(de,{height:24,"data-test":"UserInitialization-Spacer"}),e(x,{tertiary:!0,intent:"negative",size:"full",onClick:()=>a(),"data-testid":"leave-event-button","data-test":"UserInitialization-Button",children:O("noumena.social_hall.hardware_testing_cancel_btn")})]})})};class Jr{constructor({data:a,cache:n,minWidth:l,minHeight:s,topPadding:i,maxCollisionCheckCount:r,increaseByPercentage:c,bottomPadding:d}){ke(this,"width");ke(this,"height");ke(this,"topPadding");ke(this,"bottomPadding");ke(this,"circleGutterSpace");ke(this,"maxCollisionCheckCount");ke(this,"data");ke(this,"cacheCoords");ke(this,"particles",[]);ke(this,"increaseByPercentage");this.data=a,this.topPadding=i||0,this.bottomPadding=d||0,this.circleGutterSpace=120,this.maxCollisionCheckCount=r||750,this.cacheCoords=n||{width:l,height:s,particles:[]},this.width=this.cacheCoords.width,this.height=this.cacheCoords.height,this.increaseByPercentage=li(c||10)}randomIntFromRange(){const a=this.circleGutterSpace+this.topPadding;return{xCoords:Math.floor(Math.random()*(this.width-this.circleGutterSpace*2+1)+this.circleGutterSpace),yCoords:Math.floor(Math.random()*(this.height-this.bottomPadding-(this.circleGutterSpace*2+1))+a)}}isCollision(a,n){const l=a.xCoords-n.xCoords,s=a.yCoords-n.yCoords,i=a.radius+n.radius+this.circleGutterSpace;return l*l+s*s<=i*i}computeRadius(a){return a.map(n=>{const l=Math.min(n.children.length,5),s=l<=2?n.radius*l:Math.sqrt(Math.PI*(n.radius*n.radius)*l/2);return{...n,radius:Math.ceil(s)+(l>1?ka:0)}})}circlePacking(a,n,l){const s=[],i=a.children.length,r=i-Math.min(i,5),c=[],d=a.radius+(i===1?1:i-1)*i+ka;for(let p=0;p<i;p++){let _=l-a.radius,S=n-a.radius;const v=2*Math.PI/Math.min(i,5)*p;i>1&&(_=Math.sin(v)*d+l-a.radius,S=Math.cos(v)*d+n-a.radius);const u=Math.round(S*1e3)/1e3,M=Math.round(_*1e3)/1e3,f=u+a.children[p].radius*Math.sin(v),g=M-a.children[p].radius*Math.cos(v),H=u-a.children[p].radius*Math.sin(v),k=M+a.children[p].radius*Math.cos(v);c.push({x:f,y:g}),c.push({x:H,y:k}),s.push({...a.children[p],xCoords:u,yCoords:M})}const m=this.calculateArcCoordinates(s.slice(0,5),n-a.radius,l-a.radius,d);return{children:s,groupCoords:c,arcCoords:m,moreChildren:r}}calculateArcCoordinates(a,n,l,s){const i=a.length;if(i===1)return[];const r=[],c=Math.PI/i;for(let d=0;d<=i*2-1;d++){const m=Math.PI/i*d;if(d%2===0)r.push({x:a[d/2].xCoords,y:a[d/2].yCoords});else{const p=Math.abs(s*Math.cos(c))*Math.cos(m),_=Math.abs(s*Math.cos(c))*Math.sin(m),S=n+p,v=l+_;r.push({x:S,y:v})}}return r}generateCoords(){let a=0;const{processed:n,unprocessed:l}=ii(this.cacheCoords.particles,this.data);return this.particles=[...n],l.length&&this.computeRadius(l).forEach(({radius:s},i)=>{let{xCoords:r,yCoords:c}=this.randomIntFromRange();for(let m=0;m<this.particles.length;m++)if(a++,a===this.maxCollisionCheckCount&&(a=0,this.width+=this.width*this.increaseByPercentage.width/100,this.height+=this.height*this.increaseByPercentage.height/100),this.isCollision({xCoords:r,yCoords:c,radius:s},{...this.particles[m]})){const _=this.randomIntFromRange();r=_.xCoords,c=_.yCoords,m=-1}a=0;const d=this.circlePacking(l[i],r+l[i].radius,c+l[i].radius);this.particles.push({...l[i],xCoords:r,yCoords:c,radius:s,children:d.children,groupCoords:d.groupCoords,arcCoords:d.arcCoords,moreChildren:d.moreChildren})}),{width:this.width,height:this.height,particles:this.particles}}}const jr=t=>{const{onMemberPressed:a,minHeight:n,minWidth:l}=t,s=ri(),i=o.useRef({width:l,height:n,particles:[]}),[r,c]=o.useState([]);return o.useEffect(()=>{const{width:d,height:m,particles:p}=new Jr({...t,cache:i.current}).generateCoords();c(p),i.current={width:d,height:m,particles:p}},[t]),e($i,{initialScale:1,minScale:1,maxScale:1,"data-test":"SocialHallViz-TransformWrapper",children:e(Gi,{wrapperStyle:{width:"100%",height:"100%",fontFamily:"Suisse Int'l",borderRadius:s===di.MOBILE?"0":"16px"},"data-test":"SocialHallViz-TransformComponent",children:e("div",{style:{background:"var(--bg-shmap-brand-secondary-default)",minHeight:`${n}px`,minWidth:`${l}px`},children:e("svg",{width:i.current.width,height:i.current.height,children:r.map(d=>e(ci,{onMemberPressed:a,particle:d,"data-test":"SocialHallViz-CirclePacking"},d.id))})})})})},Xr=()=>{const t=Pe(),a=()=>t(Se.HOME_NOUM);return e(ui,{"data-test":"WaitingForHost-Wrapper",children:h(pi,{"data-test":"WaitingForHost-Container",children:[e(hi,{"data-test":"WaitingForHost-Loader",children:e(tt,{"data-test":"WaitingForHost-Spinner"})}),e(de,{height:32,"data-test":"WaitingForHost-Spacer"}),e(re,{font:"heading-s-bold",colorToken:"--text-modal-header-neutral-default","data-test":"WaitingForHost-TSpan",children:"Waiting for the Host"}),e(de,{height:8,"data-test":"WaitingForHost-Spacer"}),e(re,{font:"body-l",colorToken:"--text-modal-neutral-default","data-test":"WaitingForHost-TSpan",children:"The event will start soon."}),e(de,{height:24,"data-test":"WaitingForHost-Spacer"}),e(x,{tertiary:!0,size:"full",onClick:()=>a(),"data-testid":"leave-event-button","data-test":"WaitingForHost-Button",children:O("noumena.social_hall.hardware_testing_cancel_btn")})]})})},Yr=(t=0)=>{const a=o.useRef(),[n,l]=o.useState(t);return o.useEffect(()=>()=>clearInterval(a.current),[]),{startTimer:(i=0)=>{clearInterval(a.current),l(i),a.current=setInterval(()=>{l(r=>r+1e3)},1e3)},elapsedTime:n,resetInterval:()=>clearInterval(a.current)}},Qr=(t=0)=>{const a=o.useRef(),[n,l]=o.useState(t);o.useEffect(()=>(a.current=setInterval(()=>{n>1e3&&l(n-1e3),n<1e3&&(l(0),clearInterval(a.current))},1e3),()=>{clearInterval(a.current)}),[n]);const s=o.useCallback(i=>{clearInterval(a.current),l(i)},[]);return{remainTime:n,startCountdown:s}},Ne=()=>{var d,m;st();const{id:t=""}=Vi(),a=mi({skip:!0,variables:{socialHallId:t}}),n=fi({skip:!0,variables:{socialHallId:t}}),l=async()=>{},s=async()=>{},i=async()=>{},r=o.useMemo(()=>{var p;return(p=a.data)==null?void 0:p.userOwnKnocks},[(d=a.data)==null?void 0:d.userOwnKnocks]),c=o.useMemo(()=>{var p;return(p=n.data)==null?void 0:p.userActiveKnocks},[(m=n.data)==null?void 0:m.userActiveKnocks]);return{refreshAllKnocks:i,refreshOwnKnocks:s,refreshActiveKnocks:l,userOwnKnocks:r,userActiveKnocks:c}},ct=()=>{const{logError:t}=st(),[a]=gi(),{refreshVisualization:n,userActiveGroupData:l,socialHallAttendeesAndGroups:s}=J(),{refreshOwnKnocks:i,refreshActiveKnocks:r}=Ne(),[c]=Si(),[d]=Ci(),[m]=_i(),[p,{loading:_}]=Mi(),[S,v]=o.useState(!1),[u,M]=o.useState(!1),[f,g]=o.useState(!1);return{knockUser:async(E,y,z)=>{if(y||E)try{v(!0),await a({variables:{hallAttendeeId:E,groupId:y,knockMessage:z}}),i()}catch(L){t(L,"")}finally{v(!1)}},cancelKnock:async E=>{try{g(!0),await d({variables:{knockId:E}}),await i()}catch(y){t(y,"")}finally{g(!1)}},acceptKnock:async E=>{try{M(!0),await c({variables:{knockId:E}}),await r(),await n()}catch(y){t(y,"")}finally{M(!1)}},declineKnock:async E=>{try{g(!0),await m({variables:{knockId:E}}),await r()}catch(y){t(y,"")}finally{g(!1)}},joinGroupAsHost:async E=>{try{await p({variables:{groupId:E},onCompleted:()=>{l==null||l.refetch(),s==null||s.refetch()}})}catch(y){t(y,"")}},knockLoading:S,acceptLoading:u,declineLoading:f,joiningGroupAsHost:_}},Zr=()=>{const[t,a]=o.useState([]),{socialHallAttendeesAndGroups:n,userActiveGroupData:l,socialHallId:s}=J(),{userOwnKnocks:i,refreshAllKnocks:r,refreshOwnKnocks:c}=Ne(),{data:d}=bi({variables:{socialHallId:s}}),m=o.useCallback(S=>{setTimeout(()=>{const v=t.filter(({_id:u})=>u===S);a(v)},ki)},[t]),p=async S=>{var M;const v=(M=i==null?void 0:i.data)==null?void 0:M.find(f=>(f==null?void 0:f._id)===S);if(!t.find(({_id:f})=>f===S)&&(await c(),v)){const f=[{...v,knockStatus:qe.Declined},...t];a(f),m(v._id)}},_=()=>{r(),l==null||l.refetch(),n==null||n.refetch()};return o.useEffect(()=>{(d==null?void 0:d.knockUpdates.event)!==void 0&&((d==null?void 0:d.knockUpdates.event)===qe.Declined?p(d==null?void 0:d.knockUpdates._id):(d==null?void 0:d.knockUpdates.event)===qe.Accepted?_():(d==null?void 0:d.knockUpdates.event)===qe.Cancelled?c():r())},[d==null?void 0:d.knockUpdates.event,d==null?void 0:d.knockUpdates._id]),{declinedKnocks:t}},ed=()=>{const{updateGroupName:t,updateRaiseHandUsersCache:a,updateNewAttendeeOnCallCache:n,removeAttendeeFromCallCache:l}=vi(),{updateEventStatus:s}=Xi(),{rtmEngine:i,rtmChannel:r,onLeaveCall:c,onHostBlocked:d,toggleMuteCall:m,onRemoteUserLeftChannel:p}=X(),_=o.useCallback((v,u)=>{console.log("===========Agora Subsctiption Start============"),console.log(v,u),console.log("===========Agora Subsctiption End =============");try{const M=v,{type:f,data:g,description:H}=JSON.parse(M.text);if(H===Bi)switch(f){case ve.RAISED_HAND:a(g,u);break;case ve.MUTE_ATTENDEE_IN_GROUP_CALL:m();break;case ve.UNMUTE_ATTENDEE_IN_GROUP_CALL:m();break;case ve.NEW_ATTENDEE_IN_GROUP_CALL:n(g);break;case ve.BLOCK_ATTENDEE_ON_GROUP_CALL:d();break;case ve.QUIT_ATTENDEE_ON_SOCIAL_HALL:setTimeout(()=>p(u),2e3),l(u);break;case ve.UPDATE_EVENT_STATUS:g===D.Cancelled&&c(),s(g);break;case ve.UPDATE_GROUP_NAME:t(g);break;default:break}}catch(M){console.log(M)}},[c,d,m,t,s,p,a,l,n]),S=o.useCallback(()=>{!i&&!r||(i==null||i.on("MessageFromPeer",_),r==null||r.on("ChannelMessage",_))},[i,r,_]);return o.useEffect(()=>(S(),()=>{i==null||i.off("MessageFromPeer",_),r==null||r.off("ChannelMessage",_)}),[S,i,r,_]),{onChannelMessageSubscriptionHandler:_}},go=({clientHeight:t,clientWidth:a,showChatPanel:n,showMembersPanel:l})=>{const{screenSharingLocalUserFeed:i,screenSharingRemoteUserFeed:r}=X(),c=o.useRef(null),{calculateLayout:d}=Ei(),[m,p]=o.useState({width:0,cols:0,height:0,rows:0});o.useLayoutEffect(()=>{c.current&&p(()=>d({clientWidth:a,clientHeight:t,maxVideoPerPage:1,videoCount:1}))},[d,t,a]),o.useEffect(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},250)},[a,i,r,n,l]);const _=o.useMemo(()=>m.rows?`${m.rows*m.height}px`:"100vh",[m]);return{elemRef:c,maxHeight:_,dimension:m}},Bt=()=>{const{remainTimeForEvent:t,eventDetails:a}=te(),{t:n}=pe(),{startCountdown:l,remainTime:s}=Qr(),{startTimer:i,elapsedTime:r}=Yr();return o.useEffect(()=>{[D.PreLive,D.PreEvent,D.PostEventEnded].includes(a==null?void 0:a.status)?l(t):i(t)},[t]),{formattedTime:o.useMemo(()=>(a==null?void 0:a.status)===D.PreLive||(a==null?void 0:a.status)===D.PreEvent?`${n("noumena.social_hall.to_the_main_event",{remainTime:Lt(s)})}`:(a==null?void 0:a.status)===D.PostEventEnded?`${n("noumena.social_hall.to_the_end_event",{remainTime:Lt(s)})}`:Lt(r),[r,s,a==null?void 0:a.status]),remainTime:s}},td=()=>{const t=o.useRef(),[a,n]=o.useState([]),{userActiveGroupData:l}=J(),{rtcEngine:s,rtmChannel:i}=X(),r=o.useCallback((m,p)=>{p===wi.SERVER_TIME_OUT&&(t.current=setTimeout(()=>{n(_=>Ie.updateUsers(!0,m.uid,_))},yi))},[n]),c=o.useCallback(m=>{clearTimeout(t.current),n(p=>Ie.updateUsers(!1,m.uid,p))},[]);s==null||s.on(De.CONNECTION_STATE_CHANGE,Qt.debounce((m,p)=>{m==="CONNECTED"&&p==="RECONNECTING"&&(l==null||l.refetch())},2e3));const d=o.useCallback(()=>{!i||!s||(s==null||s.on(De.USER_JOINED,c),s==null||s.on(De.USER_LEFT,r))},[s,i,c,r]);return o.useEffect(()=>(d(),()=>{s==null||s.off(De.USER_JOINED,c),s==null||s.off(De.USER_LEFT,r)}),[d,s,i,c,r]),[a,n]},ad=()=>{const{addToast:t}=Ra(),{onSendSubscriptionMessage:a}=X(),[n,{loading:l,error:s}]=Hi(),i=o.useCallback(c=>{t("error","none",`${O("noumena.toast_error.text")}: ${c}`)},[t]);return{handleChangeGroupName:o.useCallback(async(c,d)=>{let m;return await n({variables:{groupId:c,input:{name:d}},onError:({networkError:p=null,graphQLErrors:_=[]})=>{m=!1;const[S]=_;i((S==null?void 0:S.message)??p),Fi(new Error((S==null?void 0:S.message)??p),{tags:{section:"createMultipleEventInvitation"}})},onCompleted:()=>{m=!0,a({type:ve.UPDATE_GROUP_NAME,data:d})}}),m},[n,i,a]),isChangingGroupName:l,changeGroupNameError:s}},So=t=>{o.useEffect(()=>{if(!navigator.mediaDevices){console.warn("MediaDevices API not available");return}navigator.mediaDevices.ondevicechange=()=>t()},[t])},Co=()=>{const[t,a]=o.useState({audio:null,video:null}),n=o.useCallback(s=>{a(i=>({...i,[s]:!t[s]}))},[t]),l=o.useCallback(()=>{a({audio:!0,video:!0})},[]);return{onTogglePopup:n,onBothMediaBlocked:l,showPermissionPopup:t}},od=()=>{var r,c,d,m;const[t,a]=o.useState([]),[n,l]=o.useState([]),{socialHallAttendeesAndGroups:s}=J(),i=p=>{var _,S;return{radius:Ot,gutterSpace:Ii,title:Ba((p==null?void 0:p.firstName)??" "),subTitle:Ba((p==null?void 0:p.title)??" "),background:(_=p==null?void 0:p.profile)==null?void 0:_.profilePicture,chamberId:(S=p==null?void 0:p.chamber)==null?void 0:S._id}};return o.useEffect(()=>{var S,v,u,M,f;const p=(((v=(S=s==null?void 0:s.data)==null?void 0:S.socialHallAttendee)==null?void 0:v.data)||[]).map(g=>{var H,k,B,b;return{id:`user-${((H=g==null?void 0:g.attendeeId)==null?void 0:H._id)||`${Date.now()}`}`,radius:Ot,title:((k=g==null?void 0:g.attendeeId)==null?void 0:k.firstName)||" ",subTitle:((B=g==null?void 0:g.attendeeId)==null?void 0:B.title)||" ",children:[{id:((b=g==null?void 0:g.attendeeId)==null?void 0:b._id)||"",...i(g==null?void 0:g.attendeeId)}]}})??[],_=((f=(((M=(u=s==null?void 0:s.data)==null?void 0:u.socialHallGroups)==null?void 0:M.data)||[]).filter(va))==null?void 0:f.map(g=>{var k,B;const H=((B=(k=g==null?void 0:g.users)==null?void 0:k.filter(va))==null?void 0:B.map(b=>({id:`group-${(b==null?void 0:b._id)||""}`,...i(b)})))??[];return{id:(g==null?void 0:g._id)??"",radius:Ot,title:g.name||g.channelName||"",children:H}}))??[];a(p),l(_)},[(c=(r=s==null?void 0:s.data)==null?void 0:r.socialHallAttendee)==null?void 0:c.data,(m=(d=s==null?void 0:s.data)==null?void 0:d.socialHallGroups)==null?void 0:m.data]),{users:t,groups:n}},Et=(t,a)=>{var n,l;return o.useMemo(()=>{var r,c,d,m,p;const s=(c=(r=t==null?void 0:t.data)==null?void 0:r.socialHallGroups)==null?void 0:c.data;let i;if(s&&(a!=null&&a.hosts)){const _=(d=s[0])==null?void 0:d.users;(_==null?void 0:_.length)===1&&((m=_[0])!=null&&m._id)&&(i=a==null?void 0:a.hosts.includes((p=_[0])==null?void 0:p._id))}return i},[(l=(n=t==null?void 0:t.data)==null?void 0:n.socialHallGroups)==null?void 0:l.data,a==null?void 0:a.hosts])},_o=_e.div`
  height: 100vh;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
  #main-header {
    width: 100%;
  }
`,Mo=_e.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  z-index: 1;
  height: 100%;
`,bo=_e.div`
  display: flex;
  flex-direction: row;
  flex: 1;
  overflow-y: auto;
  position: relative;
`,ko=_e.div`
  z-index: 999;
  flex-direction: row;
  height: 100%;
  overflow-y: auto;
  background-color: white;
  width: 100%;
  position: absolute;
  display: ${({visible:t})=>t?"flex":"none"};
  @media (max-width: ${$t.MOBILE_MAX}) {
    display: none;
  }
  @media ${Xe.LAPTOP} {
    display: flex;
    width: unset;
    position: relative;
  }
`,vo=_e.div`
  flex: 1;
  background-color: ${Zt(ea("--shadow-neutral-dark"),.2)}
  display: none;
  @media (min-width: ${$t.TABLET}) and (max-width: ${$t.TABLET_L}) {
    display: block;
  }
`,Bo=_e.div`
  flex: 1;
  overflow: hidden;
  padding: 0;
  visibility: ${({visible:t})=>t?"visible":"hidden"};
  @media ${Xe.TABLET} {
    visibility: visible;
  }
  @media ${Xe.LAPTOP} {
    visibility: visible;
  }
`,Eo=_e.div`
  width: 100%;
  position: absolute;
  bottom: 0;
  left: 0;
  background: var(--bg-body-neutral-alt-default);
  box-shadow: 0px 4px 32px ${Zt(ea("--shadow-neutral-default"),.08)};
  visibility: ${({visible:t})=>t?"visible":"hidden"};
  display: flex;
  border-radius: 16px 16px 0px 0px;
  @media ${Xe.TABLET} {
    border-radius: 0;
  }
  @media ${Xe.LAPTOP} {
    display: none;
  }
`,nd=t=>{const{showBuzzRoom:a,socialHallAttendeesAndGroups:n}=J(),{isEventHost:l,eventDetails:s,isMainEvent:i}=te(),{children:r}=t,c=o.useRef(null),{user:d,isUnregistered:m}=fe(),{width:p}=ue(),{t:_}=pe(),[S,v]=o.useState(!0),[u,M]=o.useState(!1),[f,g]=xe(!1),{flags:H}=Ee(),k=p<=le.MOBILE_MAX,B=o.useMemo(()=>{var z,L,K,$,P,U;const y=(K=(L=(z=n==null?void 0:n.data)==null?void 0:z.socialHallAttendee)==null?void 0:L.data)==null?void 0:K.map(T=>{var N,G;return((G=(N=T==null?void 0:T.attendeeId)==null?void 0:N.profile)==null?void 0:G.profilePicture)??""});return(U=(P=($=n==null?void 0:n.data)==null?void 0:$.socialHallGroups)==null?void 0:P.data)==null||U.map(T=>{var N;(N=T==null?void 0:T.users)==null||N.map(G=>{var C;return y==null?void 0:y.push(((C=G==null?void 0:G.profile)==null?void 0:C.profilePicture)??"")})}),y??[]},[n]),b=()=>M(y=>!y),w=o.useCallback(()=>{var y;(y=c.current)==null||y.open((s==null?void 0:s._id)??"",!!l)},[l,s]);o.useEffect(()=>{i&&f&&g()},[i,g,f]);const E=h(ee,{children:[h(Mo,{children:[l&&(s==null?void 0:s._id)&&!a&&e(oa,{onViewAttendees:w,onInviteAttendees:b,onChangeGroupName:g,"data-test":"SocialHallLayout-mainContent-HostHeader"}),!l&&(s==null?void 0:s._id)&&!a&&e(na,{onViewAttendees:w,onChangeGroupName:g,"data-test":"SocialHallLayout-mainContent-AttendeeHeader"}),h(bo,{children:[!a&&h(ko,{visible:!S,children:[e(gt,{"data-test":"SocialHallLayout-mainContent-SideBar"}),e(vo,{onClick:()=>v(!0)})]}),e(Bo,{visible:S,children:r}),!a&&e(Eo,{visible:S,children:e(eo,{urls:B,onClickShowAll:()=>v(!1),"data-test":"SocialHallLayout-mainContent-BottomBar"})})]})]}),k&&h(Le,{open:!S,isFullScreen:!0,noPaddingNoBorder:!0,enableCloseButton:!0,closeButtonStyles:{enforceRight:!0},onClose:()=>v(!0),"data-test":"SocialHallLayout-mainContent-Modal",children:[e(de,{height:26,"data-test":"SocialHallLayout-mainContent-Spacer"}),e(Te,{isFullScreen:!0,"data-test":"SocialHallLayout-mainContent-ModalHeader",children:_("noumena.social_hall.see_event_attendees")}),e(Oe,{isFullScreen:!0,mobileFlex:!0,overflowY:"hidden","data-test":"SocialHallLayout-mainContent-ModalBody",children:e(gt,{"data-test":"SocialHallLayout-mainContent-SideBar"})})]}),e(Dt,{ref:c,"data-test":"SocialHallLayout-mainContent-EventAttendeesModal"}),e(qt,{isOpen:u,handleClose:b,"data-test":"SocialHallLayout-mainContent-InviteAttendeeModal"}),e(ta,{isOpen:f&&!i,onClose:g,"data-test":"SocialHallLayout-mainContent-ChangeGroupNameModal"})]});return H.newAppNavigation?e(wa.Layout,{mode:"focused",topNavbar:m?e(Ea,{leftNavButton:!0,"data-test":"SocialHallLayout-GuestHeader"}):e(wa.TopBar,{}),children:E}):h(_o,{children:[e(Xt,{isBorderRadius:!1,"data-test":"SocialHallLayout-Header",children:m?e(Ea,{leftNavButton:!0,"data-test":"SocialHallLayout-GuestHeader"}):e(Yt,{avatar:ye.getProfilePicture(d)||void 0,userName:(d==null?void 0:d.firstName)||void 0,"data-test":"SocialHallLayout-MainHeader"})}),E]})},sd=t=>{const{showBuzzRoom:a,socialHallAttendeesAndGroups:n}=J(),{isEventHost:l,eventDetails:s,isMainEvent:i}=te(),{children:r}=t,c=o.useRef(null),{user:d}=fe(),{width:m}=ue(),{t:p}=pe(),[_,S]=o.useState(!0),[v,u]=o.useState(!1),[M,f]=xe(!1),g=o.useMemo(()=>m<=le.MOBILE_MAX,[m]),H=o.useMemo(()=>{var E,y,z,L,K,$;const w=(z=(y=(E=n==null?void 0:n.data)==null?void 0:E.socialHallAttendee)==null?void 0:y.data)==null?void 0:z.map(P=>{var U,T;return((T=(U=P==null?void 0:P.attendeeId)==null?void 0:U.profile)==null?void 0:T.profilePicture)??""});return($=(K=(L=n==null?void 0:n.data)==null?void 0:L.socialHallGroups)==null?void 0:K.data)==null||$.map(P=>{var U;(U=P==null?void 0:P.users)==null||U.map(T=>{var N;return w==null?void 0:w.push(((N=T==null?void 0:T.profile)==null?void 0:N.profilePicture)??"")})}),w??[]},[n]),k=()=>u(w=>!w),B=()=>{S(!1)},b=o.useCallback(()=>{var w;(w=c.current)==null||w.open((s==null?void 0:s._id)??"",!!l)},[l,s]);return o.useEffect(()=>{i&&M&&f()},[i,f,M]),h(_o,{children:[e(Xt,{isBorderRadius:!1,"data-test":"SocialHallLayoutOld-Header",children:e(Yt,{avatar:ye.getProfilePicture(d)||void 0,userName:(d==null?void 0:d.firstName)||void 0,"data-test":"SocialHallLayoutOld-MainHeader"})}),h(Mo,{children:[l&&(s==null?void 0:s._id)&&e(oa,{onViewAttendees:b,onInviteAttendees:k,onChangeGroupName:f,"data-test":"SocialHallLayoutOld-HostHeader"}),!l&&(s==null?void 0:s._id)&&e(na,{onViewAttendees:b,onChangeGroupName:f,"data-test":"SocialHallLayoutOld-AttendeeHeader"}),h(bo,{children:[!a&&h(ko,{visible:!_,children:[e(gt,{"data-test":"SocialHallLayoutOld-SideBar"}),e(vo,{onClick:()=>S(!0)})]}),e(Bo,{visible:_,children:r}),!a&&e(Eo,{visible:_,children:e(eo,{urls:H,onClickShowAll:B,"data-test":"SocialHallLayoutOld-BottomBar"})})]})]}),g&&h(Le,{open:!_,isFullScreen:!0,noPaddingNoBorder:!0,enableCloseButton:!0,closeButtonStyles:{enforceRight:!0},onClose:()=>S(!0),"data-test":"SocialHallLayoutOld-Modal",children:[e(de,{height:26,"data-test":"SocialHallLayoutOld-Spacer"}),e(Te,{isFullScreen:!0,"data-test":"SocialHallLayoutOld-ModalHeader",children:p("noumena.social_hall.see_event_attendees")}),e(Oe,{isFullScreen:!0,mobileFlex:!0,overflowY:"hidden","data-test":"SocialHallLayoutOld-ModalBody",children:e(gt,{"data-test":"SocialHallLayoutOld-SideBar"})})]}),e(Dt,{ref:c,"data-test":"SocialHallLayoutOld-EventAttendeesModal"}),e(qt,{isOpen:v,handleClose:k,"data-test":"SocialHallLayoutOld-InviteAttendeeModal"}),e(ta,{isOpen:M&&!i,onClose:f,"data-test":"SocialHallLayoutOld-ChangeGroupNameModal"})]})},ld=t=>{const{flags:{socialHallVideoCall:a}}=Ee();return a?e(nd,{...t,"data-test":"SocialHallLayout"}):e(sd,{...t,"data-test":"SocialHallLayoutOld"})},id=_e.div`
  position: relative;
  width: 100%;
  height: 100%;
  background: var(--bg-shmap-brand-secondary-default);
  border-radius: 0;
  visibility: ${({showBuzzRoom:t})=>t?"hidden":"visible"};
  @media ${Xe.TABLET} {
    border-radius: 16px;
  }
`,rd=_e.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 0px;
  position: absolute;
  bottom: 44px;
  width: 100%;
  z-index: 99;
  @media (max-width: ${Ti.TABLET_MIN}) {
    bottom: 80px;
  }
`,dd=_e.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 0 16px;
  height: 64px;
  background: var(--bg-tablecell-neutral-alt-default);
  box-shadow: 0px 4px 32px ${Zt(ea("--shadow-neutral-default"),.08)};
  border-radius: 16px;
`;_e.div`
  background-color: var(--bg-card-neutral-alt-default);
  flex-direction: column;
  border-radius: 16px;
  width: 783px;
  margin: auto;
  padding: 24px;
  display: flex;
`;_e.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin-top: 16px;
  gap: 16px;
`;_e(ft)`
  background-color: var(--bg-body-neutral-alt-highlighted);
  width: 100%;
  height: 100vh;
  display: flex;
  align-items: center;
  flex: 1;
  justify-content: flex-start;
`;_e(re)`
  cursor: pointer;
`;const cd=o.memo(()=>{const{showBuzzRoom:t,socialHallAttendee:a,activeSocialHallGroup:n,isBlockNavigate:l,isWaitingForHost:s,setIsBlockNavigate:i}=J(),{startCall:r,closeAgoraConnection:c,agoraChannelUsers:d}=X(),{isKicked:m,isPreEvent:p,isMainEvent:_,isEventHost:S,isEndedEvent:v,isCancelledEvent:u,onCancelledEvent:M,setIsEndedEvent:f,onUserBlockedSuccess:g}=te();ed();const H=o.useRef(null),k=o.useRef(),{user:B}=fe(),{users:b,groups:w}=od(),{size:E}=Di(H),{width:y}=ue(),z=Pe(),L=o.useMemo(()=>y<le.LAPTOP,[y]),{userOwnKnocks:K,userActiveKnocks:$}=Ne(),{declinedKnocks:P}=Zr(),[U,T]=o.useState(!1),[N,G]=o.useState(),[C,F]=o.useState(!1),[Y,W]=o.useState();Ji(ie=>{k.current=ie,ie.location.pathname===Se.LOGIN?ie.retry():window.open(ie.location.pathname,"_blank")},l);const A=o.useMemo(()=>!w.length&&b.length===1,[w.length,b.length]),R=o.useMemo(()=>{let ie=[...(K==null?void 0:K.data)??[],...($==null?void 0:$.data)??[]];return P.length&&(ie=Ie.getUniqueDeclinedKnocks(ie,P)),ie},[K==null?void 0:K.data,$==null?void 0:$.data,P]),ae=o.useMemo(()=>d==null?void 0:d.includes((B==null?void 0:B._id)??""),[d,B==null?void 0:B._id]),Z=o.useMemo(()=>!!R.length||!!(n!=null&&n._id),[n,R]),oe=o.useCallback((ie,ge)=>{var we;L&&(((we=ge==null?void 0:ge.children)==null?void 0:we.length)>1?(W(ge.id),F(!0)):(G(ie.id),T(!0)))},[L]),Q=o.useCallback(()=>{f==null||f(!1),i(!1),setTimeout(()=>{z(Se.HOME_NOUM)},500)},[z,i,f]),Me=o.useCallback(()=>{i(!1),setTimeout(()=>{M()},500)},[M,i]),j=o.useCallback(async()=>{n!=null&&n._id&&(a!=null&&a._id)&&(await c(),await r())},[c,a,r,n]);o.useEffect(()=>{j()},[n==null?void 0:n._id,a==null?void 0:a._id]);const he=o.useMemo(()=>t||_,[t,_]),ne=o.useMemo(()=>Z||U||C,[Z,U,C]);return e(ld,{"data-testid":"social_hall_layout","data-test":"SocialHall-SocialHallLayout",children:s?e(Xr,{"data-test":"SocialHall-WaitingForHost"}):!ae&&!m?e(qr,{"data-test":"SocialHall-UserInitialization"}):h(ee,{children:[h(ee,{children:[he&&e(Pr,{initialNotifications:R,"data-test":"SocialHall-EventRoom"}),H.current&&!he&&h(id,{ref:H,showBuzzRoom:t,"data-testid":"main_container","data-test":"SocialHall-Container",children:[e(jr,{data:[...b,...w],minHeight:E.height,minWidth:E.width,topPadding:50,bottomPadding:50,onMemberPressed:oe,"data-test":"SocialHall-SocialHallViz"}),A&&e(rd,{"data-test":"SocialHall-NotifyOnlyYouWrapper",children:e(dd,{"data-test":"SocialHall-NotifyOnlyYou",children:e(re,{font:"body-l",colorToken:"--text-tablecell-header-neutral-highlighted","data-test":"SocialHall-TSpan",children:O("noumena.social_hall.attendees_only_one",{eventType:p?O("noumena.social_hall.pre_event"):O("noumena.social_hall.post_event")})})})})]}),ne&&e(Vr,{showMiniPlayerNotification:Z,initialNotifications:R,showUserPopup:U,showGroupPopup:C,attendeeId:N,groupId:Y,onCloseGroupPopup:()=>F(!1),onCloseUserPopup:()=>T(!1),"data-test":"SocialHall-MiniPlayerAndNotification"})]}),S?e(ce,{isOpen:v,onClose:Q,...Pi,"data-test":"SocialHall-EventModal"}):h(ee,{children:[e(ce,{isOpen:u,onClose:Me,...Ni,"data-test":"SocialHall-EventModal"}),e(ce,{isOpen:v,onClose:Q,...Li,"data-test":"SocialHall-EventModal"}),e(ce,{isOpen:m,onClose:g,...Oi,"data-test":"SocialHall-EventModal"})]})]})})}),ud=()=>{const{flags:{noumsSocialHall:t}}=Ee(),{isAcceptedSkipMediaTesting:a}=fe();return t?e(zi,{"data-test":"SocialHallWrapper-SocialHallProvider",children:e(Wi,{"data-test":"SocialHallWrapper-SocialHallEventProvider",children:e(xi,{"data-test":"SocialHallWrapper-SocialHallCallProvider",children:a?e(cd,{"data-test":"SocialHallWrapper-SocialHall"}):e(Ar,{"data-test":"SocialHallWrapper-InitialSettings"})})})}):e("div",{})},kd=ud;export{kd as default};
//# sourceMappingURL=SocialHall-53cdb7bd.js.map
