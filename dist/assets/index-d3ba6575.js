import{j as e,c as g,B as O,T as d,cZ as J,dJ as K,dK as Z,pB as le,u as de,D as me,ci as I,S as m,x as D,y as C,R as P,s as te,G as j,J as Y}from"./index-cd84bcc9.js";import{ar as ae,an as S,B as l,am as ce,ap as pe,aq as ue,r as b,a9 as ge,bc as he,bb as U}from"./vendor-51460554.js";import{i as Se,P as fe}from"./PhoneInput-94520e8e.js";import{d as Te}from"./storyblok-c16fb040.js";import{E as f}from"./trackingEvents-87d8ea4c.js";import{T as Ne,L as $,F as _e,a as Fe,S as Ue,b as Q,c as ee}from"./styles-5298610f.js";import{i as be}from"./email-9dc89e57.js";const Ce=()=>{const{t}=ae(),h=()=>{window==null||window.open(J.PRIVACY,"_blank")},u=()=>{window==null||window.open(J.TERMS,"_blank")};return e(Ne,{"data-test":"TermsAndPrivacy-Terms",children:g($,{align:"center",justify:"center",wrap:"wrap","data-test":"TermsAndPrivacy-LinkContainer",children:[e(_e,{font:"footnote",colorToken:"--text-body-neutral-default","data-test":"TermsAndPrivacy-FormText",children:t("noumena.signup.terms_and_conditions")}),g(Fe,{"data-test":"TermsAndPrivacy-LinksSection",children:[e(O,{secondary:!0,"data-testid":"terms",textOnly:!0,onClick:u,style:{borderRadius:0},"data-test":"TermsAndPrivacy-Button",children:e(d,{colorToken:"--text-button-brand-secondary-default",font:"link-s","data-test":"TermsAndPrivacy-TSpan",children:t("noumena.signup.terms_of_use")})}),e(O,{textOnly:!0,size:"small","data-test":"TermsAndPrivacy-Button",children:e(Ue,{"data-test":"TermsAndPrivacy-SpacerText",children:"&"})}),e(O,{secondary:!0,"data-testid":"privacy",textOnly:!0,onClick:h,style:{borderRadius:0},"data-test":"TermsAndPrivacy-Button",children:e(d,{colorToken:"--text-button-brand-secondary-default",font:"link-s","data-test":"TermsAndPrivacy-TSpan",children:t("noumena.signup.privacy_policy")})})]})]})})},ye=({userInfo:t})=>{const h={email:S().trim().email(l("noumena.signup.error.incorrect_email")).required(l("noumena.input.complete_field")).test("validateEmail",l("noumena.signup.error.incorrect_email"),o=>be(o||"")),firstName:S().trim().required(l("noumena.input.complete_field")).max(20,l("noumena.signup.first_name.too_long")).min(2,l("noumena.signup.first_name.too_short")).test("Two letter name validation",l("noumena.signup.two_digit_first_name.incorrect"),o=>o&&o.length<=2?K.test(o):!0).matches(Z,l("noumena.signup.first_name.incorrect")),lastName:S().trim().required(l("noumena.input.complete_field")).max(20,l("noumena.signup.last_name.too_long")).min(2,l("noumena.signup.last_name.too_short")).test("Two letter name validation",l("noumena.signup.two_digit_last_name.incorrect"),o=>o&&o.length<=2?K.test(o):!0).matches(Z,l("noumena.signup.last_name.incorrect")),phone:S().trim().when("phone",o=>o!=null&&o.length?S().required().test("validatePhone",l("noumena.signup.error.incorrect_phone_number"),c=>!c||c.includes("-")?!1:Se(`+${c}`)):S().notRequired()),referralCode:S().trim().when("referralCode",o=>o!=null&&o.length?S().test("validateReferralCode",l("noumena.signup.referral_code.incorrect"),c=>!!(c&&c.trim().length===c.length)).min(4,l("noumena.signup.referral_code.min_error")).max(5,l("noumena.signup.referral_code.max_error")).matches(le,l("noumena.signup.referral_code.incorrect")):S().notRequired())},u=ce().shape(h,[["referralCode","referralCode"],["phone","phone"]]).required(),{control:i,handleSubmit:w,getValues:L,reset:V,setValue:T,trigger:N,setError:y,clearErrors:v,formState:{errors:M,isValid:E}}=pe({resolver:ue(u),mode:"all",reValidateMode:"onBlur",defaultValues:{email:t==null?void 0:t.email,firstName:t==null?void 0:t.firstName,lastName:t==null?void 0:t.lastName,dob:t==null?void 0:t.dob,phone:t==null?void 0:t.phone,referralCode:t==null?void 0:t.referralCode}});return b.useEffect(()=>{t!=null&&t.referralCode?(T("referralCode",t==null?void 0:t.referralCode),N("referralCode")):(T("referralCode",""),N("referralCode"))},[T,N,t==null?void 0:t.referralCode]),{control:i,errors:M,isValid:E,getValues:L,handleSubmit:w,reset:V,setError:y,clearErrors:v}},k=parseInt(te.TABLET,10)||768,Ee=parseInt(te.MOBILE_MAX,10)||767,ve=()=>{const{t}=ae(),h=ge(),u=de(),{userInfo:i,recaptchaToken:w,timedOut:L,signUpEmail:V,setUserInfo:T,showBlockedErrorMsg:N,isSigningUpFromNextApp:y,quickSignUpNoumId:v,backUrl:M}=me(),[E,o]=b.useState(!1),c=b.useRef(!0),[p,re]=b.useState(),[ne,ie]=b.useState(!1),[q]=he(),R=(q.get("referral-code")||"").replace(/[^a-zA-Z0-9]/g,""),{control:_,errors:s,isValid:W,handleSubmit:B,setError:z,clearErrors:H}=ye({userInfo:i,onChangeUserInfo:T}),oe=b.useMemo(()=>{const r={};return q.forEach((a,n)=>{n.startsWith("utm_")&&(r[n]=a)}),r},[q]);b.useEffect(()=>{async function r(){var x;const a=await j.serviceValidateReferralCode(R),n=!!(!a.errorMessage&&a.isValid);if(ie(n),n&&(c!=null&&c.current)){T({...i,referralCode:R});try{const{data:A}=await Te(R);re((x=A==null?void 0:A.story)==null?void 0:x.content)}catch{}}a.errorStatus===102&&N()}return R&&!y&&r(),()=>{c.current=!1}},[R,T,i,N,y]);const se=async r=>{const a=await j.serviceValidateReferralCode(r);return!a.errorMessage&&(a!=null&&a.isValid)&&(a==null?void 0:a.countExceed)===!1?(H("referralCode"),!0):a.errorStatus===102?(N(),!1):(z("referralCode",{type:"focus",message:Y(a)},{shouldFocus:!0}),!1)},X=async(r,a)=>{if(!a)return!1;const n=await j.validateContact(r,a);return n&&!n.errorMessage?(H(r),!0):n.errorStatus===102?(N(),!1):(z(r,{type:"focus",message:Y(n)},{shouldFocus:!0}),!1)},G=async r=>{o(!0);let a=!r.referralCode;if(r.referralCode&&(a=await se(r.referralCode)),!a||!r.email){o(!1);return}if(!await X("email",r.email)){o(!1);return}if(r.phone&&!await X("phone",r.phone)){o(!1);return}T({...i,...r}),I(f.ONBOARDING.INITIAL_SIGNUP_SCREEN.SUBMIT,{Email:i==null?void 0:i.email,Phone:i==null?void 0:i.phone,FirstName:i==null?void 0:i.firstName,LastName:i==null?void 0:i.lastName,DateOfBirth:i==null?void 0:i.dob,ReferralCode:i==null?void 0:i.referralCode,...oe}),await V(r.email)&&(y?h(P.SIGN_UP_OTP):h(P.SIGN_UP_OTP,{replace:!0})),o(!1)},F=b.useCallback(r=>{let a="";switch(r.target.name){case"email":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.EMAIL;break;case"firstName":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.FIRST_NAME;break;case"lastName":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.LAST_NAME;break;case"dob":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.DOB;break;case"phone":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.PHONE;break;case"referralCode":a=f.ONBOARDING.INITIAL_SIGNUP_SCREEN.REFERRAL_CODE;break}I(a)},[]);return y?g(Q,{vertical:!0,"data-testid":"stepOneContainer","data-test":"SignUpForm-Screen",children:[e(d,{font:"heading-m-bold",colorToken:"--text-body-header-neutral-default",style:{whiteSpace:u.width>Ee?"nowrap":void 0,alignSelf:"center"},"data-test":"SignUpForm-TSpan",children:"Sign up, and elevate your experience."}),e(m,{height:24,"data-test":"SignUpForm-Spacer"}),e(d,{$fill:!0,colorToken:"--text-body-neutral-default",font:"body-l",style:{whiteSpace:"nowrap",alignSelf:"center"},"data-test":"SignUpForm-TSpan",children:"Create an account to dive into a world of Noums."}),e(m,{height:u.width>k?56:24,"data-test":"SignUpForm-Spacer"}),e(ee,{"data-test":"SignUpForm-StyledTabPanel",children:e("form",{onSubmit:B(G),"data-testid":"handleSubmitID",children:g(D,{vertical:!0,gap:16,"data-test":"SignUpForm-Stack",children:[e(d,{colorToken:"--text-card-header-neutral-highlighted",font:"body-m-bold","data-test":"SignUpForm-TSpan",children:"What’s your name?"}),g(D,{vertical:!0,gap:12,style:{width:"100%"},"data-test":"SignUpForm-Stack",children:[e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"firstName",value:a||"",label:t("noumena.first_name"),error:!!s.firstName,onChange:r,helperText:(n=s.firstName)==null?void 0:n.message,"data-testid":"firstNameInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"firstName","data-test":"SignUpForm-Controller"}),e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"lastName",value:a||"",label:t("noumena.last_name"),error:!!s.lastName,onChange:r,helperText:(n=s.lastName)==null?void 0:n.message,"data-testid":"lastNameInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"lastName","data-test":"SignUpForm-Controller"})]}),e(d,{colorToken:"--text-card-header-neutral-highlighted",font:"body-m-bold","data-test":"SignUpForm-TSpan",children:"What’s your email?"}),e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"email",value:a||"",label:t("noumena.email_address"),error:!!s.email,onChange:r,helperText:(n=s.email)==null?void 0:n.message,"data-testid":"emailInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"email","data-test":"SignUpForm-Controller"})]})})}),e(m,{height:16,"data-test":"SignUpForm-Spacer"}),e(O,{primary:!0,size:"full",onClick:B(G),disabled:!w||E||!W,loading:E,"data-testid":"submitBtn","data-test":"SignUpForm-Button",children:"Continue"}),e(m,{height:16,"data-test":"SignUpForm-Spacer"}),g($,{align:"center",justify:"center","data-test":"SignUpForm-LinkContainer",children:[e(d,{font:"body-l",colorToken:"--text-input-neutral-default",style:{paddingRight:"8px"},"data-test":"SignUpForm-TSpan",children:t("noumena.signup.already_have_account")}),e("div",{children:e(d,{font:"body-l",onClick:()=>{L(),I(f.ONBOARDING.INITIAL_SIGNUP_SCREEN.LOG_IN),h(v?`${P.LOGIN}?quickNoumID=${v}&backurl=${M}`:P.LOGIN)},colorToken:"--text-button-brand-secondary-default","data-testid":"goToLogInID","data-test":"SignUpForm-TSpan",children:t("noumena.session_expired.login")})})]}),e(m,{height:56,"data-test":"SignUpForm-Spacer"}),g(D,{vertical:!0,fixedHeight:115,justify:"space-between",align:"center","data-test":"SignUpForm-Stack",children:[e(d,{font:"footnote",colorToken:"--text-body-neutral-disabled",textAlign:"center","data-test":"SignUpForm-TSpan",children:"By continuing, you agree to Noumena’s Terms of Use."}),e(d,{font:"footnote",colorToken:"--text-body-neutral-disabled",textAlign:"center","data-test":"SignUpForm-TSpan",children:t("noumena.signup.foot_note")})]}),e(m,{height:u.width>k?55:100,"data-test":"SignUpForm-Spacer"})]}):g(Q,{vertical:!0,"data-testid":"stepOneContainer","data-test":"SignUpForm-Screen",children:[e(m,{height:16,"data-test":"SignUpForm-Spacer"}),e(d,{font:"heading-m-bold",$fill:!0,colorToken:"--text-body-header-neutral-default","data-test":"SignUpForm-TSpan",children:p!=null&&p.Header?p==null?void 0:p.Header:t("noumena.sign_up.step1.title")}),e(m,{height:16,"data-test":"SignUpForm-Spacer"}),e(d,{$fill:!0,colorToken:"--text-body-neutral-default",font:"body-l","data-test":"SignUpForm-TSpan",children:p!=null&&p.Subtitle?p==null?void 0:p.Subtitle:t("noumena.sign_up.step1.sub_title")}),e(m,{height:u.width>k?32:24,"data-test":"SignUpForm-Spacer"}),e(ee,{"data-test":"SignUpForm-StyledTabPanel",children:e("form",{onSubmit:B(G),"data-testid":"handleSubmitID",children:g(D,{vertical:!0,gap:16,"data-test":"SignUpForm-Stack",children:[e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"email",value:a||"",label:t("noumena.email_address"),error:!!s.email,onChange:r,helperText:s.email?(n=s.email)==null?void 0:n.message:t("noumena.email_professional"),"data-testid":"emailInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"email","data-test":"SignUpForm-Controller"}),e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"firstName",value:a||"",label:t("noumena.first_name"),error:!!s.firstName,onChange:r,helperText:(n=s.firstName)==null?void 0:n.message,"data-testid":"firstNameInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"firstName","data-test":"SignUpForm-Controller"}),e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"lastName",value:a||"",label:t("noumena.last_name"),error:!!s.lastName,onChange:r,helperText:(n=s.lastName)==null?void 0:n.message,"data-testid":"lastNameInput",onFocus:F,"data-test":"SignUpForm-TextField"})},name:"lastName","data-test":"SignUpForm-Controller"}),e(U,{control:_,render:({field:{onChange:r,value:a,name:n}})=>{var x;return e(fe,{name:n,onPhoneChange:r,value:a||"",label:t("noumena.phone_number.optional"),error:!!s.phone,helperText:(x=s.phone)==null?void 0:x.message,onFocus:F,"data-test":"SignUpForm-PhoneInput"})},name:"phone","data-test":"SignUpForm-Controller"}),e(U,{control:_,render:({field:{onChange:r,value:a}})=>{var n;return e(C,{name:"referralCode",value:a||"",label:t("noumena.referral_code.optional"),error:!!s.referralCode,onChange:r,helperText:s.referralCode?(n=s.referralCode)==null?void 0:n.message:t("noumena.referral_code.helper"),"data-testid":"referralCodeInput",disabled:ne,onFocus:F,style:{color:"gray"},"data-test":"SignUpForm-TextField"})},name:"referralCode","data-test":"SignUpForm-Controller"})]})})}),e(m,{height:32,"data-test":"SignUpForm-Spacer"}),e(Ce,{"data-test":"SignUpForm-TermsAndPrivacy"}),e(m,{height:u.width>k?32:24,"data-test":"SignUpForm-Spacer"}),e(O,{primary:!0,size:"full",onClick:B(G),disabled:!w||E||!W,loading:E,"data-testid":"submitBtn","data-test":"SignUpForm-Button",children:t("noumena.sign_up.title")}),e(m,{height:u.width>k?32:24,"data-test":"SignUpForm-Spacer"}),g($,{align:"center",justify:"center","data-test":"SignUpForm-LinkContainer",children:[e(d,{font:"body-l",colorToken:"--text-input-neutral-default",style:{paddingRight:"8px"},"data-test":"SignUpForm-TSpan",children:t("noumena.signup.already_have_account")}),e("div",{children:e(d,{font:"body-l",onClick:()=>{L(),I(f.ONBOARDING.INITIAL_SIGNUP_SCREEN.LOG_IN),h(P.LOGIN)},colorToken:"--text-button-brand-secondary-default","data-testid":"goToLogInID","data-test":"SignUpForm-TSpan",children:t("noumena.session_expired.login")})})]}),e(m,{height:32,"data-test":"SignUpForm-Spacer"}),e(d,{font:"footnote",colorToken:"--text-body-neutral-disabled",textAlign:"center","data-test":"SignUpForm-TSpan",children:t("noumena.signup.foot_note")}),e(m,{height:u.width>k?55:100,"data-test":"SignUpForm-Spacer"})]})};export{ve as S};
//# sourceMappingURL=index-d3ba6575.js.map
