{"version":3,"file":"RecentShowAll-4ba4356f.js","sources":["../../src/features/discovery/hooks/useDiscoveryRecentNoums.tsx","../../src/screens/Discovery/RecentShowAll.tsx"],"sourcesContent":["import { useCallback, useMemo, useState, useEffect } from 'react';\nimport {\n  type SpaceOutputFragment,\n  useRecentNoumsQuery,\n} from '@/apollo/graphql';\nimport {\n  type Maybe,\n  SpaceStatusEnum,\n  SpaceTypeEnum,\n} from '@/apollo/generated/types';\n\nexport const useDiscoveryRecentNoums = (isInfinite?: boolean, pageSize = 0) => {\n  const [infiniteState, setInfiniteState] = useState<\n    'loading' | 'hasNextPage' | 'end' | 'end-with-force'\n  >('hasNextPage');\n  const [currentNoums, setCurrentNoums] = useState<\n    Maybe<SpaceOutputFragment>[]\n  >([]);\n  const { data, loading, error, fetchMore, refetch } = useRecentNoumsQuery({\n    variables: {\n      limit: isInfinite ? pageSize : 12,\n      offset: 0,\n    },\n  });\n\n  useEffect(() => {\n    setCurrentNoums(data?.recentNoums?.data || []);\n  }, [data]);\n\n  const filteredNoums = useMemo(\n    () =>\n      currentNoums?.filter(\n        (space) =>\n          (space?.type !== SpaceTypeEnum.Home &&\n            space?.status === SpaceStatusEnum.Published) ||\n          (space?.type === SpaceTypeEnum.Home &&\n            space?.uid?.userStatus !== 'PENDING'),\n      ),\n    [currentNoums],\n  );\n\n  const fetchMoreNoums = useCallback(async () => {\n    const result = await fetchMore({\n      variables: {\n        limit: pageSize,\n        offset: currentNoums?.length || 0,\n      },\n    });\n    const currentFetchedNoums = result?.data?.recentNoums?.data || [];\n    const udpatedNoums = [...currentNoums, ...currentFetchedNoums];\n    setCurrentNoums(udpatedNoums);\n    if ((result.data.recentNoums?.data?.length || 0) < pageSize)\n      setInfiniteState('end');\n  }, [fetchMore, currentNoums, pageSize]);\n\n  useEffect(() => {\n    setInfiniteState(\n      currentNoums && currentNoums?.length < pageSize ? 'end' : 'hasNextPage',\n    );\n  }, [currentNoums, pageSize]);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  return {\n    noums: filteredNoums,\n    loading,\n    error,\n    infiniteState,\n    fetchMoreNoums,\n    refetchRecentNoums: refetch,\n  };\n};\n","import { DiscoveryCategoryEnum } from '@/components/ChamberBox/types';\nimport { useDiscoveryRecentNoums } from '@/features/discovery/hooks';\nimport ShowAll from '@/screens/Discovery/ShowAll';\n\nconst NOUMS_PER_PAGE = 20;\n\nconst FavouritesShowAll = (): JSX.Element => {\n  const { noums, loading, infiniteState, fetchMoreNoums } =\n    useDiscoveryRecentNoums(true, NOUMS_PER_PAGE);\n\n  return (\n    <ShowAll\n      noums={noums}\n      loading={loading}\n      infiniteState={infiniteState}\n      fetchMoreNoums={fetchMoreNoums}\n      category={DiscoveryCategoryEnum.Spotlight}\n    />\n  );\n};\n\nexport default FavouritesShowAll;\n"],"names":["useDiscoveryRecentNoums","isInfinite","pageSize","infiniteState","setInfiniteState","useState","currentNoums","setCurrentNoums","data","loading","error","fetchMore","refetch","useRecentNoumsQuery","variables","limit","offset","useEffect","recentNoums","filteredNoums","useMemo","filter","space","type","SpaceTypeEnum","Home","status","SpaceStatusEnum","Published","uid","userStatus","fetchMoreNoums","useCallback","result","length","currentFetchedNoums","udpatedNoums","noums","refetchRecentNoums","NOUMS_PER_PAGE","FavouritesShowAll","jsx","ShowAll","DiscoveryCategoryEnum","Spotlight"],"mappings":"quBAWO,MAAMA,EAA0BA,CAACC,EAAsBC,EAAW,IAAM,CAC7E,KAAM,CAACC,EAAeC,CAAgB,EAAIC,WAExC,aAAa,EACT,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAEtC,CAAE,CAAA,EACE,CAAEG,KAAAA,EAAMC,QAAAA,EAASC,MAAAA,EAAOC,UAAAA,EAAWC,QAAAA,GAAYC,EAAoB,CACvEC,UAAW,CACTC,MAAOd,EAAaC,EAAW,GAC/Bc,OAAQ,CACV,CAAA,CACD,EAEDC,EAAAA,UAAU,IAAM,OACdV,IAAgBC,EAAAA,GAAAA,YAAAA,EAAMU,cAANV,YAAAA,EAAmBA,OAAQ,CAAE,CAAA,CAAA,EAC5C,CAACA,CAAI,CAAC,EAEHW,MAAAA,EAAgBC,EAAAA,QACpB,IACEd,GAAAA,YAAAA,EAAce,UAETC,OAAAA,OAAAA,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,OAC7BH,GAAAA,YAAAA,EAAOI,UAAWC,EAAgBC,YACnCN,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,QAC7BH,EAAAA,GAAAA,YAAAA,EAAOO,MAAPP,YAAAA,EAAYQ,cAAe,YAEnC,CAACxB,CAAY,CAAC,EAGVyB,EAAiBC,EAAAA,YAAY,SAAY,aACvCC,MAAAA,EAAS,MAAMtB,EAAU,CAC7BG,UAAW,CACTC,MAAOb,EACPc,QAAQV,GAAAA,YAAAA,EAAc4B,SAAU,CAClC,CAAA,CACD,EACKC,IAAsBF,GAAAA,EAAAA,GAAAA,YAAAA,EAAQzB,OAARyB,YAAAA,EAAcf,cAAde,YAAAA,EAA2BzB,OAAQ,CAAA,EACzD4B,EAAe,CAAC,GAAG9B,EAAc,GAAG6B,CAAmB,EAC7D5B,EAAgB6B,CAAY,KACvBH,GAAAA,EAAAA,EAAOzB,KAAKU,cAAZe,YAAAA,EAAyBzB,OAAzByB,YAAAA,EAA+BC,SAAU,GAAKhC,GACjDE,EAAiB,KAAK,CACvB,EAAA,CAACO,EAAWL,EAAcJ,CAAQ,CAAC,EAEtCe,OAAAA,EAAAA,UAAU,IAAM,CACdb,EACEE,IAAgBA,GAAAA,YAAAA,EAAc4B,QAAShC,EAAW,MAAQ,aAAa,CAAA,EAExE,CAACI,EAAcJ,CAAQ,CAAC,EAE3Be,EAAAA,UAAU,IAAM,CACLL,GAAA,EACR,CAACA,CAAO,CAAC,EAEL,CACLyB,MAAOlB,EACPV,QAAAA,EACAC,MAAAA,EACAP,cAAAA,EACA4B,eAAAA,EACAO,mBAAoB1B,CAAAA,CAExB,ECrEM2B,EAAiB,GAEjBC,EAAoBA,IAAmB,CACrC,KAAA,CAAEH,MAAAA,EAAO5B,QAAAA,EAASN,cAAAA,EAAe4B,eAAAA,CAAAA,EACrC/B,EAAwB,GAAMuC,CAAc,EAG5C,OAAAE,EAACC,EACC,CAAA,MAAAL,EACA,QAAA5B,EACA,cAAAN,EACA,eAAA4B,EACA,SAAUY,EAAsBC,UAChC,YAAA,2BAAA,CAAA,CAEN"}