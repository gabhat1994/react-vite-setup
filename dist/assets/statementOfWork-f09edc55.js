import{eR as S,W as c,et as O,eS as R,eT as _,eU as v,eV as I,ez as F}from"./index-cd84bcc9.js";import{A as p}from"./payloadParser-f4cc4e4f.js";function L(t){var u,r;switch(t.fees.feeCategory){case c.Inadvance:return[{amount:t.fees.inAdvance.amount,dueDate:S(t.fees.inAdvance.dueDate).toISOString()}];case c.Installments:return(u=t.fees.instalments)==null?void 0:u.map(n=>({amount:n.amount,dueDate:S(n.dueDate).toISOString()}));case c.Milestones:return(r=t.fees.milestones)==null?void 0:r.map((n,o)=>{var a;return{description:(a=t.milestones)==null?void 0:a[o].name,amount:n.amount,dueDate:S(n.dueDate).toISOString()}});case c.Lumpsum:return[{amount:t.fees.lumpSum.amount,dueDate:S(t.fees.lumpSum.dueDate).toISOString()}];default:return}}function T(t){return{title:t.title,linkedNoum:t.noumId}}function G(t){var u,r,n,o;return{title:t.title,linkedNoum:t.noumId,scopeOfWork:t.scopeOfWork,effectiveDate:t.effectiveDate?S(t.effectiveDate).toISOString():null,linkedContract:t.contractId||null,deliverables:(u=t.deliverables)==null?void 0:u.map(a=>({title:a.name,description:a.description,dueDate:a.dueDate?S(a.dueDate).toISOString():null})),milestones:(r=t.milestones)==null?void 0:r.map(a=>({title:a.name,description:a.description,dueDate:S(a.dueDate).toISOString()})),commission:(n=t.bonusCommission)==null?void 0:n.map(a=>({description:a.name,amount:a.amount})),expenseReimbursement:(o=t.expenseReimbursement)==null?void 0:o.map(a=>({description:a.name,amount:a.amount})),fees:{type:t.fees.feeCategory,feesData:L(t)??null}}}function Q(t){var u,r,n,o,a,g,y,f,l,i,D,d,s,N,C,m,w,h,M,U,k,P;if(!t.linkedNoum._id)throw new Error("Invalid linkedNoum for provided statement of work.");return{...E({noumId:t.linkedNoum._id}),noumId:t.linkedNoum._id,title:t.title??"",contractId:((u=t.linkedContract)==null?void 0:u._id)??void 0,scopeOfWork:t.scopeOfWork??void 0,effectiveDate:p.parseDateString(t.effectiveDate),deliverables:((r=t.deliverables)==null?void 0:r.map(e=>({name:(e==null?void 0:e.title)??"",description:(e==null?void 0:e.description)??"",dueDate:p.parseDateString(e==null?void 0:e.dueDate)})))??void 0,milestones:((n=t.milestones)==null?void 0:n.map(e=>({name:(e==null?void 0:e.title)??"",description:(e==null?void 0:e.description)??"",dueDate:p.parseDateString(e==null?void 0:e.dueDate)})))??void 0,bonusCommission:(o=t.commission)==null?void 0:o.map(e=>({name:(e==null?void 0:e.description)??void 0,amount:(e==null?void 0:e.amount)??void 0})),expenseReimbursement:(a=t.expenseReimbursement)==null?void 0:a.map(e=>({name:(e==null?void 0:e.description)??void 0,amount:(e==null?void 0:e.amount)??void 0})),fees:{feeCategory:((g=t.fees)==null?void 0:g.type)??void 0,inAdvance:((y=t.fees)==null?void 0:y.type)===c.Inadvance?{amount:((l=(f=t.fees.feesData)==null?void 0:f[0])==null?void 0:l.amount)??void 0,dueDate:p.parseDateString((D=(i=t.fees.feesData)==null?void 0:i[0])==null?void 0:D.dueDate)}:void 0,milestones:((d=t.fees)==null?void 0:d.type)===c.Milestones?(N=(s=t.fees)==null?void 0:s.feesData)==null?void 0:N.map(e=>({amount:(e==null?void 0:e.amount)??void 0,dueDate:p.parseDateString(e==null?void 0:e.dueDate)})):void 0,instalments:((C=t.fees)==null?void 0:C.type)===c.Installments?(w=(m=t.fees)==null?void 0:m.feesData)==null?void 0:w.map(e=>({amount:(e==null?void 0:e.amount)??void 0,dueDate:p.parseDateString(e==null?void 0:e.dueDate)})):void 0,lumpSum:((h=t.fees)==null?void 0:h.type)===c.Lumpsum?{amount:((U=(M=t.fees.feesData)==null?void 0:M[0])==null?void 0:U.amount)??0,dueDate:p.parseDateString((P=(k=t.fees.feesData)==null?void 0:k[0])==null?void 0:P.dueDate)}:void 0},logo:t.logo??void 0}}function E({noumId:t}){return{title:"Statement of Work",noumId:t??"",scopeOfWork:"",payments:{currency:O.Usd}}}const A={toCreateNewSowInput:T,toUpdateSowInput:G,fromStatementOfWork:Q,getDefaultValues:E};function q(t){const[u]=R(),[r]=_(),[n]=v(),{data:o,loading:a}=I({variables:{id:t},fetchPolicy:"cache-and-network",skip:!t}),g=(o==null?void 0:o.getSingleSOW)??null;async function y(i){var s;const d=(s=(await u({variables:{input:A.toCreateNewSowInput(i)},update:(N,C)=>{var w;const m=(w=C.data)==null?void 0:w.createNewSOW;m&&N.writeQuery({query:F,variables:{id:m._id},data:{getSingleSOW:m}})}})).data)==null?void 0:s.createNewSOW;if(!d)throw new Error("Unable to create a statement of work. Please try again later.");return d}async function f(i){var s;if(!t)return null;const d=(s=(await r({variables:{id:t,input:A.toUpdateSowInput(i)}})).data)==null?void 0:s.updateSOW;if(!d)throw new Error("Unable to update the statement of work. Please try again later.");return d}async function l(i=t){if(!i)return;if(!await n({variables:{id:i}}))throw new Error("Unable to delete the SOW. Please try again later.")}return{statementOfWork:g,isLoading:a,createStatementOfWork:y,updateStatementOfWork:f,deleteStatementOfWork:l}}export{A as S,q as u};
//# sourceMappingURL=statementOfWork-f09edc55.js.map
