import{b6 as t,eo as n,bb as y,f as m,j as g,q as C,ep as I,eq as h,a$ as w}from"./index-cd84bcc9.js";import{r as p}from"./vendor-51460554.js";import{I as O}from"./invoice-e39dbdbc.js";function T(e){return e.status&&s[e.status].canEdit}function v(e){return e.status&&s[e.status].canDelete}function b(e){return e.status&&s[e.status].canSend}function E(e){return e.status&&s[e.status].canDownload}function R(e){return e.status&&s[e.status].canPay&&e.currency===y.Usd&&e.type==="Received"}function W(e,c){return c&&e&&s[e].canChangeTo.includes(c)}function B(e){return e.status&&s[e.status].canChangeTo.length>0}function U(e){return e.status&&s[e.status].canSendReminder}function F(e){return e.status&&s[e.status].canDuplicate}const s={[t.Draft]:{canEdit:!0,canDelete:!0,canSend:!0,canDownload:!1,canChangeTo:[n.Cancelled],canSendReminder:!1,canDuplicate:!0},[t.Cancelled]:{canEdit:!1,canDelete:!1,canSend:!1,canDownload:!1,canChangeTo:[],canSendReminder:!1},[t.Issued]:{canEdit:!0,canDelete:!1,canSend:!1,canDownload:!0,canPay:!0,canSendReminder:!1,canDuplicate:!0,canChangeTo:[n.Overdue,n.Paid,n.PartiallyPaid,n.Cancelled]},[t.Overdue]:{canEdit:!1,canDelete:!1,canSend:!1,canDownload:!0,canPay:!0,canSendReminder:!0,canDuplicate:!0,canChangeTo:[n.Paid,n.PartiallyPaid]},[t.Paid]:{canEdit:!1,canDelete:!1,canSend:!1,canDownload:!0,canDuplicate:!0,canSendReminder:!1,canChangeTo:[n.Overdue]},[t.PartiallyPaid]:{canEdit:!1,canDelete:!1,canSend:!1,canDownload:!0,canPay:!0,canDuplicate:!0,canSendReminder:!0,canChangeTo:[n.Overdue,n.Paid,n.PartiallyPaid]},[t.WriteOff]:{canEdit:!1,canDelete:!1,canSend:!1,canDownload:!0,canChangeTo:[],canSendReminder:!1}},S={[n.Cancelled]:{title:"Cancelled",description:"This invoice was accidentally finalized or contains a mistake."},[n.Overdue]:{title:"Overdue",description:"This invoice is not paid and is past due"},[n.Paid]:{title:"Paid",description:"Payment was collected in full outside of Noumena."},[n.PartiallyPaid]:{title:"Partially Paid",description:"Part of payment was collected outside of Noumena."},[n.WriteOff]:{title:"Open",description:"The invoice is ready for the customer"}},M=e=>S[e].title,N=e=>S[e].description,j=Object.values(n),k=e=>r.invoiceStatusToInvoiceStatusInputMap[e],x={[t.Cancelled]:n.Cancelled,[t.Overdue]:n.Overdue,[t.Paid]:n.Paid,[t.PartiallyPaid]:n.PartiallyPaid,[t.WriteOff]:n.WriteOff,[t.Draft]:void 0,[t.Issued]:void 0},r={canEdit:T,canDelete:v,canSend:b,canChangeTo:W,canChangeStatus:B,invoiceStatusesPermissions:s,allStatuses:j,getStatusDescription:N,getStatusTitle:M,invoiceStatusToInvoiceStatusInputMap:x,mapStatusToStatusInput:k,canDownload:E,canPay:R,canSendReminder:U,canDuplicate:F};function Q(){const{user:e}=m();function c(a){var P;return((P=a.createdBy)==null?void 0:P._id)===(e==null?void 0:e._id)}return{...r,canEdit:a=>r.canEdit(a)&&c(a),canDelete:a=>r.canDelete(a)&&c(a),canSend:a=>r.canSend(a)&&c(a),canPay:a=>r.canPay(a)&&!c(a),canChangeStatus:a=>r.canChangeStatus(a)&&c(a),canSendReminder:a=>r.canSendReminder(a)&&c(a),canDuplicate:a=>a&&r.canDuplicate(a)&&c(a),isNoumOwner:c}}const _=({status:e})=>{const c=p.useMemo(()=>{switch(e){case t.Draft:return{label:"Draft",tertiary:!0};case t.Cancelled:return{label:"Cancelled",tertiary:!0};case t.Issued:return{label:"Open",secondary:!0};case t.Paid:return{label:"Paid",success:!0};case t.Overdue:return{label:"Overdue",danger:!0};case t.PartiallyPaid:return{label:"Partially Paid",warning:!0};case t.WriteOff:return{label:"Write Off",tertiary:!0};default:return{}}},[e]),{label:l,...u}=c;return l?g(C,{...u,"data-test":"InvoiceStatusBadge-Tag",children:l}):null};function L(){const[e,{loading:c}]=I(),l=p.useCallback(async(u,f)=>{var o;const d=(o=(await e({variables:{id:u},fetchPolicy:"network-only"})).data)==null?void 0:o.invoicePDFPreviewByID.base64,i=d?w(d,"application/pdf"):null;i&&h(i,"application/pdf",O.getInvoiceFileName(f))},[e]);return{loading:c,download:l}}export{_ as I,Q as a,r as b,L as u};
//# sourceMappingURL=useInvoicePdfDownload-84ddf906.js.map
