{"version":3,"file":"contractPermissions-cf3fd14b.js","sources":["../../src/features/contracts/hooks/contractPermissions.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { type Maybe } from '@/apollo/generated/types';\nimport { useAuth } from '@/features/auth/contexts';\nimport { type ContractBasic } from '../types';\nimport { ContractUtils } from '../utils/contract';\n\ntype MaybeContract = Maybe<ContractBasic> | undefined;\n\nexport function useContractPermissions() {\n  const { user } = useAuth();\n\n  const currentUserId = user?._id;\n\n  const permissionUtils = useMemo(() => {\n    function isOwner(\n      contract: MaybeContract,\n      userId: string | undefined = currentUserId,\n    ) {\n      return userId && contract?.createdBy?._id === userId;\n    }\n    function isSignedByOwner(contract: MaybeContract) {\n      // TODO: Change logic when BE adds required fields.\n      return ContractUtils.isIssued(contract);\n    }\n    function isSignedByCounterparty(contract: MaybeContract) {\n      // TODO: Change logic when BE adds required fields.\n      return (\n        ContractUtils.isSigned(contract) || ContractUtils.isAmended(contract)\n      );\n    }\n    function canEdit(contract: MaybeContract) {\n      return ContractUtils.isDraft(contract) && isOwner(contract);\n    }\n    function canDelete(contract: MaybeContract) {\n      return (\n        (ContractUtils.isDraft(contract) || ContractUtils.isIssued(contract)) &&\n        isOwner(contract)\n      );\n    }\n    function canAmend(contract: MaybeContract) {\n      // TODO: Enable it back when we add support for it in BE.\n      const isAmendingEnabled = false;\n      return (\n        isAmendingEnabled &&\n        ContractUtils.isSigned(contract) &&\n        isOwner(contract)\n      );\n    }\n\n    function canSendForSigning(contract: MaybeContract) {\n      return ContractUtils.isDraft(contract) && isOwner(contract);\n    }\n    function canSignAsCounterparty(contract: MaybeContract) {\n      return ContractUtils.isIssued(contract) && !isOwner(contract);\n    }\n    function canSign(contract: MaybeContract) {\n      return canSendForSigning(contract) || canSignAsCounterparty(contract);\n    }\n    function canDecline(contract: MaybeContract) {\n      return canSignAsCounterparty(contract);\n    }\n\n    function canSaveDraft(contract: MaybeContract) {\n      return ContractUtils.isDraft(contract) && isOwner(contract);\n    }\n\n    function canDuplicate(contract: MaybeContract) {\n      // TODO: Enable it back when we add support for it in BE.\n      const isDuplicationEnabled = false;\n      return isOwner(contract) && isDuplicationEnabled;\n    }\n\n    function canDownloadPdf(contract: MaybeContract) {\n      return !!contract;\n    }\n\n    function canResend(contract: MaybeContract) {\n      return (\n        isOwner(contract) &&\n        (ContractUtils.isIssued(contract) || ContractUtils.isSigned(contract))\n      );\n    }\n\n    function canSeeSummary(contract: MaybeContract) {\n      return (\n        !ContractUtils.isDraft(contract) || ContractUtils.isComplete(contract)\n      );\n    }\n\n    return {\n      isOwner,\n      isSignedByOwner,\n      isSignedByCounterparty,\n      canEdit,\n      canDelete,\n      canAmend,\n      canSendForSigning,\n      canSign,\n      canDecline,\n      canSaveDraft,\n      canDuplicate,\n      canDownloadPdf,\n      canResend,\n      canSeeSummary,\n    };\n  }, [currentUserId]);\n\n  return permissionUtils;\n}\n"],"names":["useContractPermissions","user","useAuth","currentUserId","_id","permissionUtils","useMemo","isOwner","contract","userId","createdBy","isSignedByOwner","ContractUtils","isIssued","isSignedByCounterparty","isSigned","isAmended","canEdit","isDraft","canDelete","canAmend","isAmendingEnabled","canSendForSigning","canSignAsCounterparty","canSign","canDecline","canSaveDraft","canDuplicate","isDuplicationEnabled","canDownloadPdf","canResend","canSeeSummary","isComplete"],"mappings":"4HAQO,SAASA,GAAyB,CACjC,KAAA,CAAEC,KAAAA,GAASC,EAAS,EAEpBC,EAAgBF,GAAAA,YAAAA,EAAMG,IAgGrBC,OA9FiBC,EAAAA,QAAQ,IAAM,CAC3BC,SAAAA,EACPC,EACAC,EAA6BN,EAC7B,OACOM,OAAAA,KAAUD,EAAAA,GAAAA,YAAAA,EAAUE,YAAVF,YAAAA,EAAqBJ,OAAQK,CAChD,CACA,SAASE,EAAgBH,EAAyB,CAEzCI,OAAAA,EAAcC,SAASL,CAAQ,CACxC,CACA,SAASM,EAAuBN,EAAyB,CAEvD,OACEI,EAAcG,SAASP,CAAQ,GAAKI,EAAcI,UAAUR,CAAQ,CAExE,CACA,SAASS,EAAQT,EAAyB,CACxC,OAAOI,EAAcM,QAAQV,CAAQ,GAAKD,EAAQC,CAAQ,CAC5D,CACA,SAASW,EAAUX,EAAyB,CAEvCI,OAAAA,EAAcM,QAAQV,CAAQ,GAAKI,EAAcC,SAASL,CAAQ,IACnED,EAAQC,CAAQ,CAEpB,CACA,SAASY,EAASZ,EAAyB,CAGzC,MACEa,EAIJ,CAEA,SAASC,EAAkBd,EAAyB,CAClD,OAAOI,EAAcM,QAAQV,CAAQ,GAAKD,EAAQC,CAAQ,CAC5D,CACA,SAASe,EAAsBf,EAAyB,CACtD,OAAOI,EAAcC,SAASL,CAAQ,GAAK,CAACD,EAAQC,CAAQ,CAC9D,CACA,SAASgB,EAAQhB,EAAyB,CACxC,OAAOc,EAAkBd,CAAQ,GAAKe,EAAsBf,CAAQ,CACtE,CACA,SAASiB,EAAWjB,EAAyB,CAC3C,OAAOe,EAAsBf,CAAQ,CACvC,CAEA,SAASkB,EAAalB,EAAyB,CAC7C,OAAOI,EAAcM,QAAQV,CAAQ,GAAKD,EAAQC,CAAQ,CAC5D,CAEA,SAASmB,EAAanB,EAAyB,CAGtCD,OAAAA,EAAQC,CAAQ,GAAKoB,EAC9B,CAEA,SAASC,EAAerB,EAAyB,CAC/C,MAAO,CAAC,CAACA,CACX,CAEA,SAASsB,EAAUtB,EAAyB,CAExCD,OAAAA,EAAQC,CAAQ,IACfI,EAAcC,SAASL,CAAQ,GAAKI,EAAcG,SAASP,CAAQ,EAExE,CAEA,SAASuB,EAAcvB,EAAyB,CAC9C,MACE,CAACI,EAAcM,QAAQV,CAAQ,GAAKI,EAAcoB,WAAWxB,CAAQ,CAEzE,CAEO,MAAA,CACLD,QAAAA,EACAI,gBAAAA,EACAG,uBAAAA,EACAG,QAAAA,EACAE,UAAAA,EACAC,SAAAA,EACAE,kBAAAA,EACAE,QAAAA,EACAC,WAAAA,EACAC,aAAAA,EACAC,aAAAA,EACAE,eAAAA,EACAC,UAAAA,EACAC,cAAAA,CAAAA,CACF,EACC,CAAC5B,CAAa,CAAC,CAGpB"}