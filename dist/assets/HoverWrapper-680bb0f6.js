import{v as Z,i7 as J,bJ as K,bK as z,bO as X,dP as oo,j as e,I as f,c as W,M as eo,t as to,h as ao,i as ro,x as lo,T as no,S as so,k as io,B as co,bY as H,b$ as x,bP as $,bt as uo,F as N}from"./index-cd84bcc9.js";import{r as v,l as F,B as b,f as q,ay as bo}from"./vendor-51460554.js";import{X as C,Y as y,Z as S,D as mo,p as po,_ as vo,$ as ho,a0 as go,a1 as _o,a2 as fo,s as O,a3 as V,I as Y,a4 as Co,a5 as U}from"./Element-9cea61d7.js";import"./helper-53a5becb.js";import{N as yo}from"./ChamberCompleteness-c76bd15d.js";function wo(){const{addToast:t}=Z(),[o,{loading:a}]=J(),i=v.useCallback(async(r,s)=>{let l;try{await o({variables:{ID:r},update:(n,{data:d})=>{var D;if(!d||!d.removeSectionFromNoumLayout)return;const m={id:s,editorV2Enabled:!0,status:K.Unpublished},g=n.readQuery({query:z,variables:m});if(!g)return;const{getSpaceById:_}=g;if(!_)return;const u=F.cloneDeep(_);if(!(u!=null&&u.layout))return;const h=(D=u.layout.sections.find(c=>c._id===r))==null?void 0:D.position;u.layout.status=X.Unsaved,u.layout.sections=F.remove(u==null?void 0:u.layout.sections,c=>(c==null?void 0:c._id)!==r),h&&(u.layout.sections=u.layout.sections.map(c=>c.position>h?{...c,position:c.position-1}:c),n.writeQuery({query:z,variables:m,data:{getSpaceById:u}}))}}),t("success","none",b("noumena.container.section_delete.success")),l=!0}catch(n){let d="Unknown";n instanceof Error&&(d=n.message),t("error","none",d),q(new Error(d),{tags:{section:"removeSectionMutation"}}),l=!1}return l},[t,o]);return{loading:a,removeSectionHelper:i}}function Wo(){const{addToast:t}=Z(),o=v.useCallback(r=>{t("error","none",`${b("noumena.toast_error.text")}: ${r}`)},[t]),[a]=oo();return{subWalletDeleteHelper:v.useCallback(async(r,s,l)=>{r&&await a({variables:{chamberId:r},onError:n=>{n instanceof Error&&(o(n==null?void 0:n.message),q(new Error(n==null?void 0:n.message),{tags:{section:"gqlGetSubWalletBalance"}}))},onCompleted:n=>{var d,m,g,_;(m=(d=n==null?void 0:n.getSubWalletBalance)==null?void 0:d.amount)!=null&&m.value&&((_=(g=n==null?void 0:n.getSubWalletBalance)==null?void 0:g.amount)==null?void 0:_.value)>0?l():s()}})},[a,o])}}const R=(t=!1,o)=>t?{bgColor:"var(--bg-tool-toolbox-brand-primary-default)",hoverColor:"var( --bg-tool-toolbox-brand-primary-hover)"}:{bgColor:"var(--bg-section-toolbox-default)",hoverColor:o?"var(--bg-section-toolbox-default)":"var(--bg-section-toolbox-hover)"},Do=({onDownClick:t,provided:o,currentIndex:a,totalIndex:i,isTool:r})=>{const s=v.useMemo(()=>a===i,[a,i]),l=()=>{s||t==null||t()},{bgColor:n,hoverColor:d}=R(r,s);return e(C,{cursorAllowed:!0,onClick:m=>{m.stopPropagation(),l()},"data-title":b("noumena.noum_editor.hover_controls_arrow_down"),bgColor:n,hoverColor:d,"data-test":"ArrowDown-ControlPanelIcon",children:e(y,{"aria-label":"arrow_down_button",ref:o==null?void 0:o.innerRef,disabled:s,...o==null?void 0:o.dragHandleProps,"data-test":"ArrowDown-WrapperIcon",children:e(f,{size:16,name:"arrow_down_m",color:"--icon-button-neutral-alt-default","data-test":"ArrowDown-Icon"})})})},Po=({onUpClick:t,provided:o,currentIndex:a,isTool:i})=>{const r=v.useMemo(()=>a===0,[a]),s=()=>{r||t==null||t()},{bgColor:l,hoverColor:n}=R(i,r);return e(C,{cursorAllowed:!0,onClick:d=>{d.stopPropagation(),s()},"data-title":b("noumena.noum_editor.hover_controls_arrow_up"),isEdge:S.topLeft,bgColor:l,hoverColor:n,"data-test":"ArrowUp-ControlPanelIcon",children:e(y,{"aria-label":"arrow_up_button",ref:o==null?void 0:o.innerRef,disabled:r,...o==null?void 0:o.dragHandleProps,"data-test":"ArrowUp-WrapperIcon",children:e(f,{size:16,name:"arrow_up_m",color:"--icon-button-neutral-alt-default","data-test":"ArrowUp-Icon"})})})},Mo=({isOpen:t,onClose:o,nonRemovableToolList:a})=>W(eo,{open:t,size:to.S,onClose:o,testId:"nonremovable-tools-modal",disableBackdropClick:!0,"data-test":"NonRemovableDeleteModal-Modal",children:[e(ao,{"data-test":"NonRemovableDeleteModal-ModalHeader",children:b("noumena.noum_editor.no_delete_Section_title")}),e(ro,{style:{alignItems:"center"},"data-test":"NonRemovableDeleteModal-ModalBody",children:e(lo,{vertical:!0,gap:15,"data-test":"NonRemovableDeleteModal-Stack",children:e(mo,{"data-test":"NonRemovableDeleteModal-DeleteDescriptionContainer",children:e(po,{"data-test":"NonRemovableDeleteModal-DeleteDescription",children:e(bo,{"data-test":"NonRemovableDeleteModal-Trans",children:W(no,{font:"body-l",colorToken:"--text-modal-neutral-default","data-test":"NonRemovableDeleteModal-TSpan",children:[b("noumena.noum_editor.no_delete_section_description"),e(vo,{"data-test":"NonRemovableDeleteModal-SectionToolsList",children:a.map(i=>e("li",{children:ho[i.elementType]}))})]})})})})})}),e(so,{height:16,"data-test":"NonRemovableDeleteModal-Spacer"}),e(io,{isFullScreen:!1,marginTop:12,"data-test":"NonRemovableDeleteModal-ModalFooter",children:e(co,{tertiary:!0,intent:"negative",size:"full",onClick:o,"data-testid":"cancel-button","data-test":"NonRemovableDeleteModal-Button",children:b("noumena.cancel")})})]}),So=({isTool:t,section:o,id:a,isDisabled:i,tool:r})=>{const{handleDeleteModal:s,space:l,setNoumSidePanelId:n,setActiveEditingTool:d}=H(),[m,g]=v.useState(!1),[_,u]=v.useState(!1),{removeSectionHelper:h}=wo(),{subWalletDeleteHelper:D}=Wo(),c=v.useCallback(()=>{a&&(d==null||d(r),s==null||s(t?x.TOOL_TYPE:x.SECTION_TYPE,a))},[s,a,t,d,r]),w=v.useCallback(()=>{g(!m)},[m]),P=v.useCallback(()=>$.nonRemovableTools((o==null?void 0:o.columns)||[]),[o==null?void 0:o.columns]),k=v.useCallback(async T=>{if(T.stopPropagation(),i)return;if(P().length>0&&!t){u(!0);return}if(o==null?void 0:o.columns.find(E=>E.tools.length>0))(r==null?void 0:r.elementType)!==uo.Wallet?c():D(l==null?void 0:l._id,c,w);else{if(!(l!=null&&l._id))return;await h(a,l._id)&&(n==null||n(void 0))}},[w,a,i,P,t,c,h,o==null?void 0:o.columns,n,l==null?void 0:l._id,D,r==null?void 0:r.elementType]);return W(N,{children:[e(C,{cursorAllowed:!i,onClick:T=>k(T),"data-title":i?b("noumena.noum_editor.hover_controls_not_delete"):b("noumena.noum_editor.hover_controls_delete"),isEdge:S.topRight,bgColor:t?"var(--bg-tool-toolbox-brand-primary-default)":"var(--bg-section-toolbox-default)",hoverColor:t?"var( --bg-tool-toolbox-brand-primary-hover)":"var(--bg-section-toolbox-hover)","data-test":"Delete-ControlPanelIcon",children:e(y,{isEdge:"right","aria-label":"delete_button","data-test":"Delete-WrapperIcon",children:e(f,{size:16,name:"delete_m",color:"--icon-button-neutral-alt-default","data-test":"Delete-Icon"})})}),e(yo,{isOpen:m,handleClose:w,"data-test":"Delete-NonZeroWalletModal"}),e(Mo,{isOpen:_,onClose:()=>u(!1),nonRemovableToolList:P(),"data-test":"Delete-NonRemovableDeleteModal"})]})},To=({isTool:t,id:o,isDisabled:a,isSectionBackground:i})=>{const{duplicateHandler:r}=H(),s=v.useCallback(async l=>{l.stopPropagation(),!(a||!o)&&await(r==null?void 0:r(o,t))},[r,o,a,t]);return e(C,{isSectionBackground:i,cursorAllowed:!a,onClick:l=>s(l),"data-title":a?b("noumena.noum_editor.hover_controls_not_duplicate"):b("noumena.noum_editor.hover_controls_duplicate"),bgColor:t?"var(--bg-tool-toolbox-brand-primary-default)":"var(--bg-section-toolbox-default)",hoverColor:t?"var( --bg-tool-toolbox-brand-primary-hover)":"var(--bg-section-toolbox-hover)","data-test":"Duplicate-ControlPanelIcon",children:e(y,{"aria-label":"duplicate_button","data-test":"Duplicate-WrapperIcon",children:e(f,{size:16,name:"copy_m",color:"--icon-button-neutral-alt-default","data-test":"Duplicate-Icon"})})})},Eo=({isTool:t,id:o,tool:a,isDisabled:i})=>{const{handleEditModal:r,noumSidePanelId:s,setNoumSidePanelId:l}=H(),n=()=>{s&&o===s?l==null||l(void 0):r==null||r(t?x.TOOL_TYPE:x.SECTION_TYPE,o,a)};return e(C,{cursorAllowed:!i,onClick:d=>{d.stopPropagation(),!i&&n()},"data-title":b("noumena.noum_editor.hover_controls_edit"),bgColor:t?"var(--bg-tool-toolbox-brand-primary-default)":"var(--bg-section-toolbox-default)",hoverColor:t?"var( --bg-tool-toolbox-brand-primary-hover)":"var(--bg-section-toolbox-hover)","data-test":"Edit-ControlPanelIcon",children:e(y,{"aria-label":"edit_button","data-test":"Edit-WrapperIcon",children:e(f,{size:16,name:"edit_m",color:"--icon-button-neutral-alt-default","data-test":"Edit-Icon"})})})},xo=({isTool:t,provided:o,setOnDragInitiateId:a,id:i,setCurrentElementHeight:r,elementRef:s})=>e(C,{cursorAllowed:!0,onClick:l=>l.stopPropagation(),onMouseDown:()=>{var l;a==null||a(i),r==null||r((l=s==null?void 0:s.current)==null?void 0:l.offsetHeight)},"data-title":b("noumena.noum_editor.hover_controls_move"),isEdge:S.topLeft,bgColor:t?"var(--bg-tool-toolbox-brand-primary-default)":"var(--bg-section-toolbox-default)",hoverColor:t?"var( --bg-tool-toolbox-brand-primary-hover)":"var(--bg-section-toolbox-hover)",...o==null?void 0:o.dragHandleProps,"data-test":"Move-ControlPanelIcon",children:e(y,{"aria-label":"move_button","data-test":"Move-WrapperIcon",children:e(f,{size:16,name:"move_m",color:"--icon-button-neutral-alt-default","data-test":"Move-Icon"})})}),No=({onClick:t})=>e(C,{cursorAllowed:!0,onClick:o=>{o.stopPropagation(),t()},"data-title":b("noumena.noum_editor.hover_controls_add_tool_below"),isEdge:S.bothBottom,bgColor:"var(--bg-tool-toolbox-brand-primary-default)",hoverColor:"var( --bg-tool-toolbox-brand-primary-hover)","data-test":"PlusBottom-ControlPanelIcon",children:e(y,{"aria-label":"plus_bottom_button","data-test":"PlusBottom-WrapperIcon",children:e(f,{size:16,name:"plus_m",color:"--icon-button-neutral-alt-default","data-test":"PlusBottom-Icon"})})}),Ho=({onClick:t})=>e(C,{cursorAllowed:!0,onClick:o=>{o.stopPropagation(),t()},"data-title":b("noumena.noum_editor.hover_controls_add_tool_above"),isEdge:S.bothTop,bgColor:"var(--bg-tool-toolbox-brand-primary-default)",hoverColor:"var( --bg-tool-toolbox-brand-primary-hover)","data-test":"PlusTop-ControlPanelIcon",children:e(y,{"aria-label":"plus_top_button","data-test":"PlusTop-WrapperIcon",children:e(f,{size:16,name:"plus_m",color:"--icon-button-neutral-alt-default","data-test":"PlusTop-Icon"})})}),ko=({isDisabled:t,tool:o})=>{const{bgColor:a,hoverColor:i}=R(!0),r=!!o&&$.isCustomPreviewVisible(o);return e(C,{cursorAllowed:!t,isEdge:S.topRight,bgColor:a,hoverColor:i,"data-test":"Visibility-ControlPanelIcon",children:e(y,{isEdge:"right","aria-label":"visibility_button","data-test":"Visibility-WrapperIcon",children:e(f,{size:16,name:r?"eye_on_solid_m":"eye_off_solid_m",color:"--icon-button-neutral-alt-default","data-test":"Visibility-Icon"})})})},zo=t=>{const{children:o,className:a,type:i,isActive:r,id:s,provided:l,currentIndex:n,totalIndex:d,isDragging:m,isElementDragging:g,onDownClick:_,onUpClick:u,onInsert:h,section:D,disable:c,isSectionBackground:w,isColumnBackground:P,setOnDragInitiateId:k,isTool:T,setCurrentElementHeight:A,elementType:E,elementRef:G,isCustomPreview:B=!1,isEditing:j=!0}=t,{noumSidePanelId:Q,hoverId:L,setHoverId:M}=H(),p=i===x.TOOL_TYPE,I=v.useMemo(()=>m&&p,[m,p]);return j?W(go,{onMouseEnter:()=>M==null?void 0:M(s),onMouseLeave:()=>M==null?void 0:M(void 0),isHoverNotActive:!!L&&L!==Q,"data-testid":"hoverWrapper-container",isChild:a==="child",isActive:r,isDragging:I,isElementDragging:g,isMoveTool:T,"data-test":"HoverWrapper-HoverWrapperContainer",children:[e(_o,{className:a,isTool:p,"data-test":"HoverWrapper-ToolContainer",children:e(fo,{"aria-label":`${p?O[E]:"section"}`,font:"footnote-bold",colorToken:"--text-button-neutral-alt-default","data-test":"HoverWrapper-ToolNameContainer",children:p?O[E]:`${b("noumena.noum_editor.hover_controls_section_title")}`})}),p&&!m&&!B&&W(N,{children:[e(V,{className:a,"data-test":"HoverWrapper-PlusWrapper",children:e(Ho,{onClick:()=>h==null?void 0:h(Y.Above),"data-test":"HoverWrapper-PlusTop"})}),e(V,{className:a,isBottom:!0,"data-test":"HoverWrapper-PlusWrapper",children:e(No,{onClick:()=>h==null?void 0:h(Y.Below),"data-test":"HoverWrapper-PlusBottom"})})]}),W(Co,{className:a,isTool:p,"data-test":"HoverWrapper-StackElements",children:[p&&!B?e(xo,{isTool:p,provided:l,setOnDragInitiateId:k,id:s,setCurrentElementHeight:A,elementRef:G,"data-test":"HoverWrapper-Move"}):W(N,{children:[e(Po,{isTool:p,onUpClick:u,provided:l,currentIndex:n,"data-test":"HoverWrapper-ArrowUp"}),e(Do,{isTool:p,onDownClick:_,provided:l,currentIndex:n,totalIndex:d,"data-test":"HoverWrapper-ArrowDown"})]}),B?e(ko,{tool:t.tool,"data-test":"HoverWrapper-Visibility"}):W(N,{children:[e(Eo,{isDisabled:c==null?void 0:c.edit,isTool:p,id:s,tool:t==null?void 0:t.tool,"data-test":"HoverWrapper-Edit"}),e(To,{isTool:p,id:s,isDisabled:c==null?void 0:c.duplicate,isSectionBackground:w,"data-test":"HoverWrapper-Duplicate"}),e(So,{isTool:p,section:D,id:s,isDisabled:c==null?void 0:c.delete,isSectionBackground:w,tool:t==null?void 0:t.tool,"data-test":"HoverWrapper-Delete"})]})]}),e(U,{className:a==="child"?"child-wrapper":"parent-wrapper",isDragging:I,isSectionBackground:w,isColumnBackground:P,"data-test":"HoverWrapper-ChildWrapper",children:o})]}):e(U,{className:a==="child"?"child-wrapper":"parent-wrapper",isDragging:I,isSectionBackground:w,isColumnBackground:P,"data-test":"HoverWrapper-ChildWrapper",children:o})};export{zo as H,Mo as N,Wo as a,wo as u};
//# sourceMappingURL=HoverWrapper-680bb0f6.js.map
