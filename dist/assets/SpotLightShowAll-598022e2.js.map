{"version":3,"file":"SpotLightShowAll-598022e2.js","sources":["../../src/features/discovery/hooks/useDiscoverySpotLightChambers.tsx","../../src/screens/Discovery/SpotLightShowAll.tsx"],"sourcesContent":["import { useCallback, useMemo, useState, useEffect } from 'react';\nimport {\n  type SpaceOutputFragment,\n  useGetSpotLightChambersQuery,\n} from '@/apollo/graphql';\nimport {\n  type Maybe,\n  SpaceStatusEnum,\n  SpaceTypeEnum,\n  type SpotlightChamberFilters,\n} from '@/apollo/generated/types';\n\nexport const useDiscoverySpotLightChambers = (\n  filter?: SpotlightChamberFilters,\n  isInfinite?: boolean,\n  pageSize = 0,\n) => {\n  const [infiniteState, setInfiniteState] = useState<\n    'loading' | 'hasNextPage' | 'end' | 'end-with-force'\n  >('hasNextPage');\n  const { data, loading, error, fetchMore, refetch } =\n    useGetSpotLightChambersQuery({\n      variables: {\n        filter,\n        limit: isInfinite ? pageSize : 12,\n        offset: 0,\n      },\n    });\n\n  const currentNoums = useMemo(\n    () => data?.getSpotLightChambers?.data as Maybe<SpaceOutputFragment>[],\n    [data],\n  );\n\n  const filteredNoums = useMemo(\n    () =>\n      (\n        data?.getSpotLightChambers?.data as Maybe<SpaceOutputFragment>[]\n      )?.filter(\n        (space) =>\n          (space?.type !== SpaceTypeEnum.Home &&\n            space?.status === SpaceStatusEnum.Published) ||\n          (space?.type === SpaceTypeEnum.Home &&\n            space?.uid?.userStatus !== 'PENDING'),\n      ),\n    [data],\n  );\n\n  const fetchMoreNoums = useCallback(async () => {\n    const result = await fetchMore({\n      variables: {\n        limit: pageSize,\n        offset: currentNoums?.length || 0,\n      },\n    });\n    if ((result.data.getSpotLightChambers?.data?.length || 0) < pageSize)\n      setInfiniteState('end');\n  }, [fetchMore, currentNoums, pageSize]);\n\n  useEffect(() => {\n    setInfiniteState(\n      currentNoums && currentNoums?.length < pageSize ? 'end' : 'hasNextPage',\n    );\n  }, [currentNoums, pageSize]);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  return {\n    noums: filteredNoums,\n    loading,\n    error,\n    infiniteState,\n    fetchMoreNoums,\n    refetchRecommendedNoums: refetch,\n  };\n};\n\nexport default useDiscoverySpotLightChambers;\n","import { DiscoveryCategoryEnum } from '@/components/ChamberBox/types';\nimport { useDiscoverySpotLightChambers } from '@/features/discovery/hooks';\nimport ShowAll from '@/screens/Discovery/ShowAll';\n\nconst NOUMS_PER_PAGE = 20;\n\nconst SpotLightShowAll = (): JSX.Element => {\n  const { noums, loading, infiniteState, fetchMoreNoums } =\n    useDiscoverySpotLightChambers({}, true, NOUMS_PER_PAGE);\n\n  return (\n    <ShowAll\n      noums={noums}\n      loading={loading}\n      infiniteState={infiniteState}\n      fetchMoreNoums={fetchMoreNoums}\n      category={DiscoveryCategoryEnum.Spotlight}\n    />\n  );\n};\n\nexport default SpotLightShowAll;\n"],"names":["useDiscoverySpotLightChambers","filter","isInfinite","pageSize","infiniteState","setInfiniteState","useState","data","loading","error","fetchMore","refetch","useGetSpotLightChambersQuery","variables","limit","offset","currentNoums","useMemo","getSpotLightChambers","filteredNoums","space","type","SpaceTypeEnum","Home","status","SpaceStatusEnum","Published","uid","userStatus","fetchMoreNoums","useCallback","result","length","useEffect","noums","refetchRecommendedNoums","NOUMS_PER_PAGE","SpotLightShowAll","jsx","ShowAll","DiscoveryCategoryEnum","Spotlight"],"mappings":"0uBAYO,MAAMA,EAAgCA,CAC3CC,EACAC,EACAC,EAAW,IACR,CACH,KAAM,CAACC,EAAeC,CAAgB,EAAIC,WAExC,aAAa,EACT,CAAEC,KAAAA,EAAMC,QAAAA,EAASC,MAAAA,EAAOC,UAAAA,EAAWC,QAAAA,GACvCC,EAA6B,CAC3BC,UAAW,CACTZ,OAAAA,EACAa,MAAOZ,EAAaC,EAAW,GAC/BY,OAAQ,CACV,CAAA,CACD,EAEGC,EAAeC,UACnB,WAAMV,OAAAA,EAAAA,GAAAA,YAAAA,EAAMW,uBAANX,YAAAA,EAA4BA,MAClC,CAACA,CAAI,CAAC,EAGFY,EAAgBF,EACpB,QAAA,aAEIV,OAAAA,GAAAA,EAAAA,GAAAA,YAAAA,EAAMW,uBAANX,YAAAA,EAA4BA,OAA5BA,YAAAA,EACCN,OAEEmB,GAAAA,OAAAA,OAAAA,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,OAC7BH,GAAAA,YAAAA,EAAOI,UAAWC,EAAgBC,YACnCN,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,QAC7BH,EAAAA,GAAAA,YAAAA,EAAOO,MAAPP,YAAAA,EAAYQ,cAAe,aAEnC,CAACrB,CAAI,CAAC,EAGFsB,EAAiBC,EAAAA,YAAY,SAAY,YAOxCC,GAAAA,GANU,MAAMrB,EAAU,CAC7BG,UAAW,CACTC,MAAOX,EACPY,QAAQC,GAAAA,YAAAA,EAAcgB,SAAU,CAClC,CAAA,CACD,GACWzB,KAAKW,uBAAZa,YAAAA,EAAkCxB,OAAlCwB,YAAAA,EAAwCC,SAAU,GAAK7B,GAC1DE,EAAiB,KAAK,CACvB,EAAA,CAACK,EAAWM,EAAcb,CAAQ,CAAC,EAEtC8B,OAAAA,EAAAA,UAAU,IAAM,CACd5B,EACEW,IAAgBA,GAAAA,YAAAA,EAAcgB,QAAS7B,EAAW,MAAQ,aAAa,CAAA,EAExE,CAACa,EAAcb,CAAQ,CAAC,EAE3B8B,EAAAA,UAAU,IAAM,CACLtB,GAAA,EACR,CAACA,CAAO,CAAC,EAEL,CACLuB,MAAOf,EACPX,QAAAA,EACAC,MAAAA,EACAL,cAAAA,EACAyB,eAAAA,EACAM,wBAAyBxB,CAAAA,CAE7B,ECzEMyB,EAAiB,GAEjBC,EAAmBA,IAAmB,CACpC,KAAA,CAAEH,MAAAA,EAAO1B,QAAAA,EAASJ,cAAAA,EAAeyB,eAAAA,CACrC7B,EAAAA,EAA8B,CAAA,EAAI,GAAMoC,CAAc,EAGtD,OAAAE,EAACC,EACC,CAAA,MAAAL,EACA,QAAA1B,EACA,cAAAJ,EACA,eAAAyB,EACA,SAAUW,EAAsBC,UAChC,YAAA,0BAAA,CAAA,CAEN"}