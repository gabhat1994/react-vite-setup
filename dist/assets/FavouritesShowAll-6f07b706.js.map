{"version":3,"file":"FavouritesShowAll-6f07b706.js","sources":["../../src/features/discovery/hooks/useDiscoveryFavouritesNoums.tsx","../../src/screens/Discovery/FavouritesShowAll.tsx"],"sourcesContent":["import { useCallback, useMemo, useState, useEffect } from 'react';\nimport {\n  type SpaceOutputFragment,\n  useUserFavouritesQuery,\n} from '@/apollo/graphql';\nimport {\n  type Maybe,\n  SpaceStatusEnum,\n  SpaceTypeEnum,\n} from '@/apollo/generated/types';\n\nexport const useDiscoveryFavouritesNoums = (\n  isInfinite?: boolean,\n  pageSize = 0,\n) => {\n  const [infiniteState, setInfiniteState] = useState<\n    'loading' | 'hasNextPage' | 'end' | 'end-with-force'\n  >('hasNextPage');\n  const [currentNoums, setCurrentNoums] = useState<\n    Maybe<SpaceOutputFragment>[]\n  >([]);\n  const { data, loading, error, fetchMore, refetch } = useUserFavouritesQuery({\n    variables: {\n      limit: isInfinite ? pageSize : 12,\n      offset: 0,\n    },\n  });\n\n  useEffect(() => {\n    setCurrentNoums(\n      (data?.userFavourites?.data.map(\n        ({ noum }) => noum,\n      ) as Maybe<SpaceOutputFragment>[]) || [],\n    );\n  }, [data]);\n\n  const filteredNoums = useMemo(\n    () =>\n      (currentNoums as Maybe<SpaceOutputFragment>[])?.filter(\n        (space) =>\n          (space?.type !== SpaceTypeEnum.Home &&\n            space?.status === SpaceStatusEnum.Published) ||\n          (space?.type === SpaceTypeEnum.Home &&\n            space?.uid?.userStatus !== 'PENDING'),\n      ),\n    [currentNoums],\n  );\n\n  const fetchMoreNoums = useCallback(async () => {\n    const result = await fetchMore({\n      variables: {\n        limit: pageSize,\n        offset: currentNoums?.length || 0,\n      },\n    });\n    const currentFetchedNoums = result?.data?.userFavourites?.data || [];\n    const udpatedNoums = [\n      ...currentNoums,\n      ...((currentFetchedNoums.map(\n        ({ noum }) => noum,\n      ) as Maybe<SpaceOutputFragment>[]) || []),\n    ];\n    setCurrentNoums(udpatedNoums);\n    if ((result.data.userFavourites?.data?.length || 0) < pageSize)\n      setInfiniteState('end');\n  }, [fetchMore, currentNoums, pageSize]);\n\n  useEffect(() => {\n    setInfiniteState(\n      currentNoums && currentNoums?.length < pageSize ? 'end' : 'hasNextPage',\n    );\n  }, [currentNoums, pageSize]);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  return {\n    noums: filteredNoums,\n    loading,\n    error,\n    infiniteState,\n    fetchMoreNoums,\n    refetchFavouriteNoums: refetch,\n  };\n};\n","import { DiscoveryCategoryEnum } from '@/components/ChamberBox/types';\nimport ShowAll from '@/screens/Discovery/ShowAll';\nimport { useDiscoveryFavouritesNoums } from '@/features/discovery/hooks';\n\nconst NOUMS_PER_PAGE = 20;\n\nconst FavouritesShowAll = (): JSX.Element => {\n  const { noums, loading, infiniteState, fetchMoreNoums } =\n    useDiscoveryFavouritesNoums(true, NOUMS_PER_PAGE);\n\n  return (\n    <ShowAll\n      noums={noums}\n      loading={loading}\n      infiniteState={infiniteState}\n      fetchMoreNoums={fetchMoreNoums}\n      category={DiscoveryCategoryEnum.Spotlight}\n    />\n  );\n};\n\nexport default FavouritesShowAll;\n"],"names":["useDiscoveryFavouritesNoums","isInfinite","pageSize","infiniteState","setInfiniteState","useState","currentNoums","setCurrentNoums","data","loading","error","fetchMore","refetch","useUserFavouritesQuery","variables","limit","offset","useEffect","userFavourites","map","noum","filteredNoums","useMemo","filter","space","type","SpaceTypeEnum","Home","status","SpaceStatusEnum","Published","uid","userStatus","fetchMoreNoums","useCallback","result","length","currentFetchedNoums","udpatedNoums","noums","refetchFavouriteNoums","NOUMS_PER_PAGE","FavouritesShowAll","jsx","ShowAll","DiscoveryCategoryEnum","Spotlight"],"mappings":"0uBAWO,MAAMA,EAA8BA,CACzCC,EACAC,EAAW,IACR,CACH,KAAM,CAACC,EAAeC,CAAgB,EAAIC,WAExC,aAAa,EACT,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAEtC,CAAE,CAAA,EACE,CAAEG,KAAAA,EAAMC,QAAAA,EAASC,MAAAA,EAAOC,UAAAA,EAAWC,QAAAA,GAAYC,EAAuB,CAC1EC,UAAW,CACTC,MAAOd,EAAaC,EAAW,GAC/Bc,OAAQ,CACV,CAAA,CACD,EAEDC,EAAAA,UAAU,IAAM,OACdV,IACGC,EAAAA,GAAAA,YAAAA,EAAMU,iBAANV,YAAAA,EAAsBA,KAAKW,IAC1B,CAAC,CAAEC,KAAAA,CAAAA,IAAWA,KACsB,CAAA,CAAE,CAAA,EAEzC,CAACZ,CAAI,CAAC,EAEHa,MAAAA,EAAgBC,EAAAA,QACpB,IACGhB,GAAAA,YAAAA,EAA+CiB,UAE3CC,OAAAA,OAAAA,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,OAC7BH,GAAAA,YAAAA,EAAOI,UAAWC,EAAgBC,YACnCN,GAAAA,YAAAA,EAAOC,QAASC,EAAcC,QAC7BH,EAAAA,GAAAA,YAAAA,EAAOO,MAAPP,YAAAA,EAAYQ,cAAe,YAEnC,CAAC1B,CAAY,CAAC,EAGV2B,EAAiBC,EAAAA,YAAY,SAAY,aACvCC,MAAAA,EAAS,MAAMxB,EAAU,CAC7BG,UAAW,CACTC,MAAOb,EACPc,QAAQV,GAAAA,YAAAA,EAAc8B,SAAU,CAClC,CAAA,CACD,EACKC,IAAsBF,GAAAA,EAAAA,GAAAA,YAAAA,EAAQ3B,OAAR2B,YAAAA,EAAcjB,iBAAdiB,YAAAA,EAA8B3B,OAAQ,CAAA,EAC5D8B,EAAe,CACnB,GAAGhC,EACH,GAAK+B,EAAoBlB,IACvB,CAAC,CAAEC,KAAAA,CAAAA,IAAWA,CAAI,GACkB,CAAA,CAAG,EAE3Cb,EAAgB+B,CAAY,KACvBH,GAAAA,EAAAA,EAAO3B,KAAKU,iBAAZiB,YAAAA,EAA4B3B,OAA5B2B,YAAAA,EAAkCC,SAAU,GAAKlC,GACpDE,EAAiB,KAAK,CACvB,EAAA,CAACO,EAAWL,EAAcJ,CAAQ,CAAC,EAEtCe,OAAAA,EAAAA,UAAU,IAAM,CACdb,EACEE,IAAgBA,GAAAA,YAAAA,EAAc8B,QAASlC,EAAW,MAAQ,aAAa,CAAA,EAExE,CAACI,EAAcJ,CAAQ,CAAC,EAE3Be,EAAAA,UAAU,IAAM,CACLL,GAAA,EACR,CAACA,CAAO,CAAC,EAEL,CACL2B,MAAOlB,EACPZ,QAAAA,EACAC,MAAAA,EACAP,cAAAA,EACA8B,eAAAA,EACAO,sBAAuB5B,CAAAA,CAE3B,ECjFM6B,EAAiB,GAEjBC,EAAoBA,IAAmB,CACrC,KAAA,CAAEH,MAAAA,EAAO9B,QAAAA,EAASN,cAAAA,EAAe8B,eAAAA,CAAAA,EACrCjC,EAA4B,GAAMyC,CAAc,EAGhD,OAAAE,EAACC,EACC,CAAA,MAAAL,EACA,QAAA9B,EACA,cAAAN,EACA,eAAA8B,EACA,SAAUY,EAAsBC,UAChC,YAAA,2BAAA,CAAA,CAEN"}