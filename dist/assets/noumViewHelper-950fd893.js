import{b2 as le,c as S,F as k,j as a,S as F,T as D,w as ee,gw as me,aC as ue,g as ce,f as he,ga as fe,bu as te,R as O,ci as Se,p as oe,b7 as j,aF as z,C as W,a1 as G,d9 as Q,d7 as ge,u as Ce,e as ye,ae as be,aH as Ne,az as pe,O as He,aj as L,ax as we,o as ve,bt as p,bP as V,dQ as Ae}from"./index-cd84bcc9.js";import{C as ae,B as $,r as m,a6 as Te,a9 as ke}from"./vendor-51460554.js";import{R as Le}from"./index-401975c0.js";import{K as xe,L as Re,M as Ee,O as K,Q as X,R as Me,U as q,V as Pe,W as Ie}from"./Element-9cea61d7.js";import{E as _e}from"./trackingEvents-87d8ea4c.js";import{A as T}from"./index-4963229a.js";import{g as Ue}from"./getTimeStampForDisplaying-22d5ca9d.js";import{S as J}from"./SkeletonChamberBox-5e97f066.js";const Be=ae.span`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  @media ${le.TABLET_L} {
    padding: 72px 189.5px;
  }
`,Y=()=>S(k,{children:[a(F,{height:24,"data-test":"NoAccessCard-Spacer"}),a(Le,{"data-test":"NoAccessCard-Root",children:a(xe,{"data-test":"NoAccessCard-StyledCard",children:S(Be,{"data-test":"NoAccessCard-ErrorCardTextWrapper",children:[a(D,{textAlign:"center",font:"heading-xs-bold",colorToken:"--text-card-neutral-highlighted","data-test":"NoAccessCard-TSpan",children:$("noumena.no_access_card_error")}),a(F,{height:8,"data-test":"NoAccessCard-Spacer"}),a(D,{textAlign:"center",font:"body-m",colorToken:"--text-card-neutral-default","data-test":"NoAccessCard-TSpan",children:$("noumena.no_access_card_message")})]})})})]});function Fe(o){return Re.includes(o)?o:null}function De(o){if(!(o!=null&&o.name))return null;const e=Fe(o.name);return e?{name:e,isDefault:!0}:{name:o.name,isDefault:!1}}function Z({children:o,noumId:e}){var s;const{flags:d}=ee(),{data:t}=me({variables:{noumId:e},skip:!d.elementPermission||!e}),r=(s=t==null?void 0:t.getSpaceById)==null?void 0:s.assignedRole,n=m.useMemo(()=>De(r),[r]),i=m.useMemo(()=>ue(r==null?void 0:r.groupedPermissions),[r==null?void 0:r.groupedPermissions]),c=m.useMemo(()=>({role:n,permissions:i}),[i,n]);return a(Ee.Provider,{value:c,children:o})}const Oe=ae.div`
  font-family: var(--font-family);
  background: var(--bg-body-neutral-alt-highlighted) fixed;
  min-height: 100vh;
  ${({applyMinHeight:o})=>o&&Te`
      overflow: auto;
      min-height: 100vh;
    `}
  overflow: unset;
`,Je=({id:o,children:e,isCustomPreview:d})=>{var P,I,_;const{space:t,user:r,loading:n,loadingSpace:i,mainSpaceId:c,connectedMembers:s,connectedMembersCount:l,existingConnection:h,onRefetchConnectedMembers:g,onRefetchConnections:C,spaceConfigData:u,noumValidity:y,onRefetchSpaceById:f,onRefetchSpaceByConfig:b}=ce(o),H=ke(),{isUnregistered:A}=he(),{flags:{noumEditor2:re,newAppNavigation:ne}}=ee(),{onForegroundMessage:x}=fe(),w=((P=t==null?void 0:t.category)==null?void 0:P.name)==="Rise",R=te.isRiseApplicatonCategory(t),E=m.useRef(new Date().getTime());m.useEffect(()=>x(N=>{var U,B;if(((U=N.data)==null?void 0:U.chamberId)===o)switch((B=N.data)==null?void 0:B.pnId){case"connectionInviteAccepted":case"connectionInviteDeclined":f();break}}),[o,x,f]),m.useEffect(()=>{o&&!i&&!t&&H(O.NOUMS)},[o,t,i,H]),m.useEffect(()=>(E.current=new Date().getTime(),()=>{w&&Se(_e.RISE.NOUM_VISITED,{UUID:r==null?void 0:r._id,stay:new Date().getTime()-E.current,description:"Time in ms that the user stayed on this page."})}),[w,r]);const ie=(t==null?void 0:t.status)===oe.Archived,de=((I=t==null?void 0:t.uid)==null?void 0:I._id)===(r==null?void 0:r._id),se=j.isInactive(t==null?void 0:t.uid),M=(ie||se)&&!de,v=(n||i)&&!t;if(m.useEffect(()=>{R&&window.location.href.indexOf("type=rise_application")===-1&&window.history.replaceState({},"",`${window.location.href}?type=rise_application`),w&&window.location.href.indexOf("type=rise")===-1&&window.history.replaceState({},"",`${window.location.href}?type=rise`)},[R,w]),ne){const N=a(z,{isLoading:v,"data-test":"Chamber-mainContent-SkeletonLoaderProvider",children:a(k,{children:!v&&M?a(Y,{"data-test":"Chamber-mainContent-NoAccessCard"}):a(Z,{noumId:t==null?void 0:t._id,"data-test":"Chamber-mainContent-NoumAuthorizationProvider",children:a(W,{connectedMembersCount:l,connectedMembers:s,loading:n&&!t,loadingSpace:i&&!t,space:t||void 0,mainSpaceId:c,existingConnection:h,refetchConnectedMembers:g,refetchConnections:C,onRefetchSpaceByConfig:b,onRefetchSpaceById:f,spaceConfig:(u==null?void 0:u.getSpaceConfig)||[],noumValidity:y,"data-test":"Chamber-mainContent-ChamberProvider",children:e})})})});return d?N:a(T.Layout,{onGoBack:A?()=>H(O.GUEST_HOME):()=>H(-1),topNavbar:!d&&A?a(G,{isBorderRadius:!1,"data-test":"Chamber-Header",children:a(Q,{leftNavButton:!0,"data-test":"Chamber-GuestHeader"})}):a(T.TopBar,{}),sideNav:a(T.SideNavigation,{}),children:N})}return a(Oe,{"data-testid":"CHAMBER",className:"App",applyMinHeight:(t==null?void 0:t.elements)&&((_=t==null?void 0:t.elements)==null?void 0:_.length)<3||!1,"data-test":"Chamber-AppStyled",children:S(z,{isLoading:v,"data-test":"Chamber-SkeletonLoaderProvider",children:[!d&&a(G,{isBorderRadius:!1,"data-test":"Chamber-Header",children:A?a(Q,{leftNavButton:!0,"data-test":"Chamber-GuestHeader"}):a(ge,{avatar:j.getProfilePicture(r)||void 0,userName:(r==null?void 0:r.firstName)||void 0,isNoumEditor:re,"data-test":"Chamber-MainHeader"})}),a(k,{children:!v&&M?a(Y,{"data-test":"Chamber-NoAccessCard"}):a(Z,{noumId:t==null?void 0:t._id,"data-test":"Chamber-NoumAuthorizationProvider",children:a(W,{connectedMembersCount:l,connectedMembers:s,loading:n&&!t,loadingSpace:i&&!t,space:t||void 0,mainSpaceId:c,existingConnection:h,refetchConnectedMembers:g,refetchConnections:C,onRefetchSpaceByConfig:b,onRefetchSpaceById:f,spaceConfig:(u==null?void 0:u.getSpaceConfig)||[],noumValidity:y,"data-test":"Chamber-ChamberProvider",children:e})})})]})})},je=()=>{const{width:o}=Ce(),e=m.useMemo(()=>o<=ye.MOBILE_MAX,[o]),d=m.useMemo(()=>e?"87%":void 0,[e]);return a(be,{"data-test":"SkeletonLoaderHoumHeader-Card",children:S(K,{gap:24,justify:"baseline",align:"flex-start","data-test":"SkeletonLoaderHoumHeader-StyledFlexColumn",children:[S(X,{gap:8,justify:"flex-start",align:"flex-start","data-test":"SkeletonLoaderHoumHeader-StyledFlexRow",children:[a(Me,{"data-test":"SkeletonLoaderHoumHeader-SkeletonLoaderAvatar"}),S(K,{align:"flex-start",gap:8,"data-test":"SkeletonLoaderHoumHeader-StyledFlexColumn",children:[S(X,{gap:8,"data-test":"SkeletonLoaderHoumHeader-StyledFlexRow",children:[a(J,{w:64,h:30,r:8,"data-test":"SkeletonLoaderHoumHeader-StyledSkeleton"}),a(J,{w:110,h:30,r:8,"data-test":"SkeletonLoaderHoumHeader-StyledSkeleton"})]}),a(q,{w:240,h:33,r:8,maxWidth:d,"data-test":"SkeletonLoaderHoumHeader-SizedSkeleton"}),a(q,{w:110,h:20,r:8,"data-test":"SkeletonLoaderHoumHeader-SizedSkeleton"})]})]}),a(Pe,{"data-test":"SkeletonLoaderHoumHeader-SkeletonLoaderParagraph"})]})})},Ye=({isCustomPreview:o})=>{var l,h,g,C,u,y,f,b;const{space:e,spaceName:d,loadingSpace:t,isArchived:r,followersCount:n,refetchFollowersCount:i,followersDataLoading:c,noumValidity:s}=Ne();return m.useEffect(()=>{i&&!n&&(e!=null&&e._id)&&i()},[n,i,e==null?void 0:e._id]),t||c?a(je,{"data-test":"ChamberHeader-SkeletonLoaderHoumHeader"}):a(Ie,{disabled:r,name:d||"",location:((l=e==null?void 0:e.uid)==null?void 0:l.location)||"",bio:(e==null?void 0:e.description)||"",followers:n,imageURL:(e==null?void 0:e.profileImage)||pe,ownerImageURL:((g=(h=e==null?void 0:e.uid)==null?void 0:h.profile)==null?void 0:g.profilePicture)||He,lastUpdated:Ue(te.getLastUpdatedAt(e)),title:((C=e==null?void 0:e.category)==null?void 0:C.name)||"Title",loading:t,isMasterNoum:(e==null?void 0:e.type)===L.Home,isSecretNoum:(e==null?void 0:e.projectType)===we.Secret,ownerTitle:(u=e==null?void 0:e.uid)!=null&&u.title?String((y=e==null?void 0:e.uid)==null?void 0:y.title):void 0,ownerBio:(f=e==null?void 0:e.uid)!=null&&f.bio?String((b=e==null?void 0:e.uid)==null?void 0:b.bio):void 0,noumValidity:s,isPublished:(e==null?void 0:e.status)===oe.Published,coverURL:(e==null?void 0:e.headerBackgroundUrl)||"",ownerName:e!=null&&e.uid?ve(e.uid.firstName,e.uid.middleName,e.uid.lastName):"",isCustomPreview:o,"data-test":"ChamberHeader-ProfileSummary"})},Ze=(o,e,d,t,r,n)=>{const i=()=>{var l;return((o==null?void 0:o.type)!==L.Home&&((l=o==null?void 0:o.uid)==null?void 0:l._id)!==(t==null?void 0:t._id)&&!(e||r)&&n.customNoums?V.filterAndSortCPPublished(d,Ae.Preview):V.filterAndSortPublished(d,(o==null?void 0:o.type)===L.Home)).filter(h=>h.elementType===p.ContractManager?!!n.contractTool:!0)};return{renderableTools:()=>{let s=i();return n.posts===!1&&(s=s.filter(l=>l.elementType!==p.Userposts)),(o==null?void 0:o.type)==="HOME"&&n.homeNoumMessages===!1&&(s=s.filter(l=>l.elementType!==p.Message)),s}}},et=(o,e,d,t,r)=>{var n,i;return o.columns.length===1&&o.columns[0].tools.length===1&&((n=o.columns[0].tools[0])==null?void 0:n.elementType)===p.Calendar?!(e>0):((i=o.columns[0].tools[0])==null?void 0:i.elementType)===p.QuickQuestions?!(d>0)&&(t||r):!1},tt=(o=[])=>o.filter(e=>e.columns.some(d=>d.tools.length>0));export{Je as C,Ye as a,tt as c,et as f,Ze as t};
//# sourceMappingURL=noumViewHelper-950fd893.js.map
