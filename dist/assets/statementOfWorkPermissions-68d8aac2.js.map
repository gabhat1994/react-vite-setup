{"version":3,"file":"statementOfWorkPermissions-68d8aac2.js","sources":["../../src/features/contracts/hooks/statementOfWorkPermissions.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { type Maybe } from '@/apollo/generated/types';\nimport { useAuth } from '@/features/auth/contexts';\nimport { type StatementOfWorkBasic } from '../types';\nimport { StatementOfWorkUtils } from '../utils/statementOfWork';\n\ntype MaybeStatementOfWork = Maybe<StatementOfWorkBasic> | undefined;\n\nexport function useStatementOfWorkPermissions() {\n  const { user } = useAuth();\n\n  const currentUserId = user?._id;\n\n  const permissionUtils = useMemo(() => {\n    function isOwner(statementOfWork: MaybeStatementOfWork) {\n      return currentUserId && statementOfWork?.createdBy?._id === currentUserId;\n    }\n    function isSignedByOwner(statementOfWork: MaybeStatementOfWork) {\n      // TODO: Change logic when BE adds required fields.\n      return StatementOfWorkUtils.isIssued(statementOfWork);\n    }\n    function isSignedByCounterparty(statementOfWork: MaybeStatementOfWork) {\n      // TODO: Change logic when BE adds required fields.\n      return (\n        StatementOfWorkUtils.isSigned(statementOfWork) ||\n        StatementOfWorkUtils.isAmended(statementOfWork)\n      );\n    }\n    function canEdit(statementOfWork: MaybeStatementOfWork) {\n      return (\n        StatementOfWorkUtils.isDraft(statementOfWork) &&\n        isOwner(statementOfWork)\n      );\n    }\n    function canDelete(statementOfWork: MaybeStatementOfWork) {\n      return (\n        (StatementOfWorkUtils.isDraft(statementOfWork) ||\n          StatementOfWorkUtils.isIssued(statementOfWork)) &&\n        isOwner(statementOfWork)\n      );\n    }\n    function canAmend(statementOfWork: MaybeStatementOfWork) {\n      // TODO: Enable it back when we add support for it in BE.\n      const isAmendingEnabled = false;\n      return (\n        isAmendingEnabled &&\n        StatementOfWorkUtils.isSigned(statementOfWork) &&\n        isOwner(statementOfWork)\n      );\n    }\n\n    function canSendForSigning(statementOfWork: MaybeStatementOfWork) {\n      return (\n        StatementOfWorkUtils.isDraft(statementOfWork) &&\n        isOwner(statementOfWork)\n      );\n    }\n    function canSignAsCounterparty(statementOfWork: MaybeStatementOfWork) {\n      return (\n        StatementOfWorkUtils.isIssued(statementOfWork) &&\n        !isOwner(statementOfWork)\n      );\n    }\n    function canSign(statementOfWork: MaybeStatementOfWork) {\n      return (\n        canSendForSigning(statementOfWork) ||\n        canSignAsCounterparty(statementOfWork)\n      );\n    }\n    function canDecline(statementOfWork: MaybeStatementOfWork) {\n      return canSignAsCounterparty(statementOfWork);\n    }\n\n    function canSaveDraft(statementOfWork: MaybeStatementOfWork) {\n      return (\n        StatementOfWorkUtils.isDraft(statementOfWork) &&\n        isOwner(statementOfWork)\n      );\n    }\n\n    function canDuplicate(statementOfWork: MaybeStatementOfWork) {\n      // TODO: Enable it back when we add support for it in BE.\n      const isDuplicationEnabled = false;\n      return isDuplicationEnabled && isOwner(statementOfWork);\n    }\n\n    function canDownloadPdf(statementOfWork: MaybeStatementOfWork) {\n      return !!statementOfWork;\n    }\n\n    function canResend(statementOfWork: MaybeStatementOfWork) {\n      return (\n        isOwner(statementOfWork) &&\n        (StatementOfWorkUtils.isIssued(statementOfWork) ||\n          StatementOfWorkUtils.isSigned(statementOfWork))\n      );\n    }\n\n    function canSeeSummary(statementOfWork: MaybeStatementOfWork) {\n      return (\n        !StatementOfWorkUtils.isDraft(statementOfWork) ||\n        StatementOfWorkUtils.isComplete(statementOfWork)\n      );\n    }\n\n    return {\n      isOwner,\n      isSignedByOwner,\n      isSignedByCounterparty,\n      canEdit,\n      canDelete,\n      canAmend,\n      canSendForSigning,\n      canSign,\n      canDecline,\n      canSaveDraft,\n      canDuplicate,\n      canDownloadPdf,\n      canResend,\n      canSeeSummary,\n    };\n  }, [currentUserId]);\n\n  return permissionUtils;\n}\n"],"names":["useStatementOfWorkPermissions","user","useAuth","currentUserId","_id","permissionUtils","useMemo","isOwner","statementOfWork","createdBy","isSignedByOwner","StatementOfWorkUtils","isIssued","isSignedByCounterparty","isSigned","isAmended","canEdit","isDraft","canDelete","canAmend","isAmendingEnabled","canSendForSigning","canSignAsCounterparty","canSign","canDecline","canSaveDraft","canDuplicate","isDuplicationEnabled","canDownloadPdf","canResend","canSeeSummary","isComplete"],"mappings":"mIAQO,SAASA,GAAgC,CACxC,KAAA,CAAEC,KAAAA,GAASC,EAAS,EAEpBC,EAAgBF,GAAAA,YAAAA,EAAMG,IAgHrBC,OA9GiBC,EAAAA,QAAQ,IAAM,CACpC,SAASC,EAAQC,EAAuC,OAC/CL,OAAAA,KAAiBK,EAAAA,GAAAA,YAAAA,EAAiBC,YAAjBD,YAAAA,EAA4BJ,OAAQD,CAC9D,CACA,SAASO,EAAgBF,EAAuC,CAEvDG,OAAAA,EAAqBC,SAASJ,CAAe,CACtD,CACA,SAASK,EAAuBL,EAAuC,CAErE,OACEG,EAAqBG,SAASN,CAAe,GAC7CG,EAAqBI,UAAUP,CAAe,CAElD,CACA,SAASQ,EAAQR,EAAuC,CACtD,OACEG,EAAqBM,QAAQT,CAAe,GAC5CD,EAAQC,CAAe,CAE3B,CACA,SAASU,EAAUV,EAAuC,CAErDG,OAAAA,EAAqBM,QAAQT,CAAe,GAC3CG,EAAqBC,SAASJ,CAAe,IAC/CD,EAAQC,CAAe,CAE3B,CACA,SAASW,EAASX,EAAuC,CAGvD,MACEY,EAIJ,CAEA,SAASC,EAAkBb,EAAuC,CAChE,OACEG,EAAqBM,QAAQT,CAAe,GAC5CD,EAAQC,CAAe,CAE3B,CACA,SAASc,EAAsBd,EAAuC,CACpE,OACEG,EAAqBC,SAASJ,CAAe,GAC7C,CAACD,EAAQC,CAAe,CAE5B,CACA,SAASe,EAAQf,EAAuC,CACtD,OACEa,EAAkBb,CAAe,GACjCc,EAAsBd,CAAe,CAEzC,CACA,SAASgB,EAAWhB,EAAuC,CACzD,OAAOc,EAAsBd,CAAe,CAC9C,CAEA,SAASiB,EAAajB,EAAuC,CAC3D,OACEG,EAAqBM,QAAQT,CAAe,GAC5CD,EAAQC,CAAe,CAE3B,CAEA,SAASkB,EAAalB,EAAuC,CAGpDmB,MAAAA,EACT,CAEA,SAASC,EAAepB,EAAuC,CAC7D,MAAO,CAAC,CAACA,CACX,CAEA,SAASqB,EAAUrB,EAAuC,CAEtDD,OAAAA,EAAQC,CAAe,IACtBG,EAAqBC,SAASJ,CAAe,GAC5CG,EAAqBG,SAASN,CAAe,EAEnD,CAEA,SAASsB,EAActB,EAAuC,CAC5D,MACE,CAACG,EAAqBM,QAAQT,CAAe,GAC7CG,EAAqBoB,WAAWvB,CAAe,CAEnD,CAEO,MAAA,CACLD,QAAAA,EACAG,gBAAAA,EACAG,uBAAAA,EACAG,QAAAA,EACAE,UAAAA,EACAC,SAAAA,EACAE,kBAAAA,EACAE,QAAAA,EACAC,WAAAA,EACAC,aAAAA,EACAC,aAAAA,EACAE,eAAAA,EACAC,UAAAA,EACAC,cAAAA,CAAAA,CACF,EACC,CAAC3B,CAAa,CAAC,CAGpB"}