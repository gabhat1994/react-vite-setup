import{u as K,aM as G,j as s,O as q,o as J,p as Q,aN as X,f as b,af as x,F as ee,aO as te,c as A,I as P,T as z,S as se,e as V,aF as ie,w as ae,R}from"./index-cd84bcc9.js";import{r as u,ar as E,aT as U,a9 as de,l as oe}from"./vendor-51460554.js";import{L as le}from"./index-c8a663c0.js";import{u as re}from"./useDiscoveryFeaturedNoums-17c3594a.js";import{u as ne}from"./useDiscoveryMyCircleNoums-329af58e.js";import{u as ce}from"./useDiscoveryPopularNoums-cdda93b8.js";import{S as Se,C as pe,a as ue,b as Ce,R as ge,c as W,d as j,e as fe,u as $,f as ye,g as ve,h as we,i as Ne,j as _e,D as Le,O as ke,k as De,M as Me,l as Te,m as Ae}from"./constants-ab41c274.js";import{D as N,C as Z,a as m}from"./ChamberBox-e4d36ac9.js";import{S as Ee,a as Be}from"./swiper-slide-dfb916a5.js";import{c as Fe}from"./skeletonLoaderHelpers-6eaa92ec.js";import{C as H}from"./styles-ec98f338.js";import"./sideNavItems-22800105.js";import"./index-2d186805.js";import"./useResizeObserver-0deb9469.js";import"./storyblok-c16fb040.js";import"./index-4963229a.js";import"./Modal-5a254f40.js";import"./styles-3ceda759.js";import"./capitalizeFirstLetter-92ef0abb.js";import"./SkeletonChamberBox-5e97f066.js";import"./consts-be860660.js";import"./useTimeIndicator-3b8ca7e8.js";const Oe=({items:i,category:a})=>{const[d,n]=u.useState(!1),[c,l]=u.useState(!1),[r,S]=u.useState(),{t:C}=E(),{width:o}=K(),p=o/252,{featured:f,source:t}=X,[g]=G();r==null||r.on("progress",e=>{l((e==null?void 0:e.progress)>0)});const y=u.useCallback(async e=>{await g({variables:{spaceId:e},onCompleted:()=>{}})},[g]),_=u.useCallback(e=>{a===N.Featured&&y(e??"")},[a,y]),v=e=>e?a===N.Featured?`/noum/${e}?${t}=${f}`:`/noum/${e}`:void 0;return s(Se,{isSwiping:c,isEnd:d,"data-test":"MobileSlider-SwiperContainer",children:s(Ee,{slidesPerView:p,spaceBetween:16,freeMode:!0,className:"discoverySwiper",onInit:e=>S(e),onReachEnd:()=>{l(!1),n(!0)},width:o-32,"data-test":"MobileSlider-Swiper",children:i==null?void 0:i.map(e=>{var L,D,M,k,T,B,F,w,O,h;return s(Be,{"data-test":"MobileSlider-SwiperSlide",children:s(pe,{onClick:()=>_(e==null?void 0:e._id),"data-testid":`noum-${e==null?void 0:e._id}`,"data-test":"MobileSlider-ChamberItem",children:s(Z,{id:e==null?void 0:e._id,chamberUrl:v(e==null?void 0:e._id),url:(e==null?void 0:e.profileImage)??void 0,ownerImageURL:((D=(L=e==null?void 0:e.uid)==null?void 0:L.profile)==null?void 0:D.profilePicture)||q,title:((M=e==null?void 0:e.uid)==null?void 0:M.title)||"",chamberTitle:(e==null?void 0:e.name)||"",name:((T=(k=e==null?void 0:e.category)==null?void 0:k.name)==null?void 0:T.toLowerCase())||m.member,ownedby:(e==null?void 0:e._id)===((B=e==null?void 0:e.uid)==null?void 0:B._id)?C("noumena.you"):J((F=e==null?void 0:e.uid)==null?void 0:F.firstName,(w=e==null?void 0:e.uid)==null?void 0:w.middleName,(O=e==null?void 0:e.uid)==null?void 0:O.lastName)??void 0,archived:(e==null?void 0:e.status)===Q.Archived,followers:(e==null?void 0:e.followersCount)||0,location:((h=e==null?void 0:e.uid)==null?void 0:h.location)??void 0,category:a,startDate:e==null?void 0:e.broadcastedAt,isFavouriteNoum:(e==null?void 0:e.isFavourited)||!1,"data-test":"MobileSlider-ChamberBox"})},e==null?void 0:e._id)},e==null?void 0:e._id)})})})},{featured:Re,source:He}=X,Ie=({items:i,countPerPage:a,category:d})=>{var f;const{t:n}=E(),{user:c}=b(),[l]=G(),{isLoading:r}=x(),S=u.useMemo(()=>(c==null?void 0:c._id)??"",[c]),C=u.useCallback(async t=>{await l({variables:{spaceId:t},onCompleted:()=>{}})},[l]),o=u.useCallback(t=>{d===N.Featured&&C(t??"")},[d,C]),p=t=>t?d===N.Featured?`/noum/${t}?${He}=${Re}`:`/noum/${t}`:void 0;return s(ee,{children:(f=r?Fe(a):i)==null?void 0:f.map(t=>{var g,y,_,v,e,L,D,M,k,T;return s(ue,{"data-testid":`carouselItem-${t==null?void 0:t._id}`,countPerPage:a,onClick:()=>o(t==null?void 0:t._id),isNotFilledItems:!!a&&((i==null?void 0:i.length)||0)%a!==0,children:s(Z,{id:t==null?void 0:t._id,chamberUrl:p(t==null?void 0:t._id),url:(t==null?void 0:t.profileImage)??void 0,ownerImageURL:((y=(g=t==null?void 0:t.uid)==null?void 0:g.profile)==null?void 0:y.profilePicture)||q,title:((_=t==null?void 0:t.uid)==null?void 0:_.title)||"",name:((e=(v=t==null?void 0:t.category)==null?void 0:v.name)==null?void 0:e.toLowerCase())||m.member,ownedby:S===((L=t==null?void 0:t.uid)==null?void 0:L._id)?n("noumena.you"):J((D=t==null?void 0:t.uid)==null?void 0:D.firstName,(M=t==null?void 0:t.uid)==null?void 0:M.middleName,(k=t==null?void 0:t.uid)==null?void 0:k.lastName)??void 0,chamberTitle:(t==null?void 0:t.name)||"",archived:(t==null?void 0:t.status)===Q.Archived,followers:(t==null?void 0:t.followersCount)||0,location:((T=t==null?void 0:t.uid)==null?void 0:T.location)??void 0,category:d,startDate:t==null?void 0:t.broadcastedAt,isFavouriteNoum:(t==null?void 0:t.isFavourited)||!1,"data-test":"CarouselSlide-ChamberBox"})},t==null?void 0:t._id)})})},Ue=({isMobile:i,carouselItems:a,countPerPage:d,category:n,updateCurrentSlide:c,page:l,pageArray:r,pageItems:S})=>{var o;const{isLoading:C}=x();return i?s(Ce,{"data-testid":"sliderBody",flexStart:a&&(a==null?void 0:a.length)<d,children:s(Oe,{items:a||[],category:n,"data-test":"SliderBody-MobileSlider"})}):s(ge,{"data-testid":"sliderBody",children:s(te.Carousel,{showArrows:!1,selectedItem:l,onChange:c,showIndicators:!1,showThumbs:!1,showStatus:!1,swipeable:!1,"data-test":"SliderBody-Carousel",children:(o=C?[...Array(d).keys()]:r)==null?void 0:o.map(p=>s(Ie,{items:S?S[p]:[{},{},{}],countPerPage:d,category:n,"data-test":`SliderBody-CarouselSlide-${p}`},p))})})},xe=({showControls:i=!1,disablePrev:a,goPrevious:d,disableNext:n,goNext:c,hideShowAllButton:l,handleShowAllClick:r})=>{const{isLoading:S}=x(),{t:C}=E();return i?S?s(W,{"data-testid":"slidercontrols",children:s(U,{width:96,height:24,"data-test":"SliderHeaderControls-Skeleton"})}):A(W,{"data-testid":"slidercontrols",children:[s(j,{marginRight:8,disabled:a,onClick:d,"data-testid":"previous",children:s(P,{name:"chevron_small_left_m",size:24,color:a?"--icon-button-neutral-disabled":"--icon-button-neutral-default","data-test":"SliderHeaderControls-Icon"})}),s(j,{marginRight:24,disabled:n,onClick:c,"data-testid":"next",children:s(P,{name:"chevron_small_right_m",size:24,color:n?"--icon-button-neutral-disabled":"--icon-button-neutral-default","data-test":"SliderHeaderControls-Icon"})}),!l&&s(fe,{textOnly:!0,intent:"negative",size:"small",onClick:r,rightIcon:s(P,{name:"chevron_small_right_m",size:24,"data-testid":"showallbtn",color:"--icon-button-brand-primary-default","data-test":"SliderHeaderControls-Icon"}),children:C("noumena.slider.show_all")})]}):null},Pe=({title:i,description:a,showControls:d,hideShowAllButton:n,disableNext:c,disablePrev:l,showTabs:r,goNext:S,goPrevious:C,handleShowAllClick:o})=>{const{isLoading:p}=x(),{isTabLoading:f}=$(),t=p&&!f;return A(ye,{"data-testid":"sliderheader",direction:r?"column":"row",children:[A(ve,{showTabs:r,children:[t?s(U,{"data-test":"SliderHeader-Skeleton"}):s(z,{font:"heading-xs-bold",colorToken:"--text-body-header-neutral-default","data-test":"SliderHeader-TSpan",children:i}),s(se,{height:4,"data-test":"SliderHeader-Spacer"}),t?s(U,{"data-test":"SliderHeader-Skeleton"}):s(z,{font:"body-l",colorToken:"--text-body-neutral-default","data-test":"SliderHeader-TSpan",children:a})]}),A(we,{full:r,"data-test":"SliderHeader-RecommendedSectionHeader",children:[r&&(t?s(U,{"data-test":"SliderHeader-Skeleton"}):s(Ne,{"data-test":"SliderHeader-RecommendedNoumsTabs"})),s(xe,{showControls:d,hideShowAllButton:n,disableNext:c,disablePrev:l,goNext:S,goPrevious:C,handleShowAllClick:o,"data-test":"SliderHeader-SliderHeaderControls"})]})]})},Y=(i,a,d)=>{const n=Array.from(i);if(n.length===0||a===0||d===0)return{items:[],totalPages:0};const c=Math.ceil(n.length/d),l=new Array(c).fill("").map((r,S)=>n.slice(S*d,(S+1)*d));return{items:l[a-1]||[],totalPages:l.length}},I=({title:i,description:a,cardItems:d=[],loading:n,route:c,category:l,hideShowAllButton:r})=>{const S=de(),{t:C}=E(),[o,p]=u.useState(0),f=K(),t=f.width<V.TABLET,g=f.width>_e?Le:t?d.length:ke,y=u.useMemo(()=>{const{items:w}=Y([...d],o+1,g);return w},[d,g,o]),_=oe.chunk(d,g),v=u.useMemo(()=>{const{totalPages:w}=Y([...d],o+1,g);return w},[d,g,o]),e=Array.from({length:v},(w,O)=>O),L=f.width<V.TABLET&&((y==null?void 0:y.length)||0)>1,{recommendedTab:D}=$(),M=f.width>=V.TABLET&&v>1,k=u.useCallback(()=>{S(c,{replace:!0,state:{title:i,description:a}})},[i,a,S,c]),T=u.useCallback(()=>{o<v&&p(o+1)},[o,v]),B=u.useCallback(()=>{o>0&&p(o-1)},[o]),F=u.useCallback(w=>{o!==w&&p(w)},[o]);return u.useEffect(()=>{p(0)},[D]),s(ie,{isLoading:!y.length&&n,"data-test":"NOUMSlider-SkeletonLoaderProvider",children:A(De,{"data-testid":"slider",children:[s(Pe,{title:i,description:a,showControls:M,disableNext:o===v-1,disablePrev:o===0,goNext:T,goPrevious:B,handleShowAllClick:k,hideShowAllButton:r,showTabs:l===N.Recommended,"data-test":"NOUMSlider-SliderHeader"}),s(Ue,{isMobile:t,pageItems:_,page:o,pageArray:e,category:l,carouselItems:y,countPerPage:g,updateCurrentSlide:F,"data-test":"NOUMSlider-SliderBody"}),L&&s(Me,{"data-testid":"mobile_show_all",size:"large",onClick:k,children:C("noumena.slider.show_all")})]})})},Ve=()=>{const{t:i}=E(),{recommendedTab:a,setIsTabLoading:d}=$(),{noums:n,loading:c,tabLoading:l}=Ae({tabId:a}),{noums:r,loading:S}=re(),{noums:C,loading:o}=ne(),{noums:p,loading:f}=ce();u.useEffect(()=>{d(l)},[d,l]);const t=S||!!r.length,g=o||!!C.length,y=f||!!p.length,{flags:_}=ae(),{discoveryNewNoums:v}=_;return A(le,{type:"Discovery","data-test":"Discovery-ListLayout",children:[v&&s(H,{"data-test":"Discovery-Container",children:s(I,{title:i("noumena.discovery.recommended.title"),category:N.Recommended,route:R.DISCOVERY_RECOMMENDED_SHOW_ALL,cardItems:n,loading:c,description:i("noumena.discovery.recommended.description"),"data-test":"Discovery-NOUMSlider"})}),t&&s(H,{"data-test":"Discovery-Container",children:s(I,{title:i("noumena.discovery.featured.title"),category:N.Featured,route:R.DISCOVERY_FEATURED_SHOW_ALL,cardItems:r,loading:S,description:i("noumena.discovery.featured.description"),"data-test":"Discovery-NOUMSlider"})}),g&&s(H,{"data-test":"Discovery-Container",children:s(I,{title:i("noumena.discovery.mycircle.title"),category:N.MyCircle,route:R.DISCOVERY_MYCIRCLE_SHOW_ALL,cardItems:C,loading:o,description:i("noumena.discovery.mycircle.description"),"data-test":"Discovery-NOUMSlider"})}),y&&s(H,{"data-test":"Discovery-Container",children:s(I,{title:i("noumena.discovery.popular.title"),category:N.Popular,route:R.DISCOVERY_POPULAR_SHOW_ALL,cardItems:p,loading:f,description:i("noumena.discovery.popular.description"),"data-test":"Discovery-NOUMSlider"})})]})},lt=()=>s(Te,{"data-test":"DiscoveryTabProvider",children:s(Ve,{"data-test":"Discovery"})});export{lt as default};
//# sourceMappingURL=Discover-f8f310c8.js.map
